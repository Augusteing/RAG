# 基于自适应多小波网络预测模型的飞控系统故障诊断仿真研究

黄宜军1,2，邬长安1(1. 信阳师范学院计算机系，河南信阳464000；2. 空军第一航空学院，河南信阳464000)

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/c9aefddcb28641aaa7f1d526676c3367993eb6938bfd66f3591771f912e03ea7.jpg)

摘要：提出了一个基于自适应多小波网络预测模型的飞机机械故障诊断新方法，给出了自适应多小波网络的构建方法和训练算法。以某型飞机作动器为例的计算机仿真结果表明，该方法故障诊断的能力及实时性都得以提高。

关键词：自适应多小波网络；预测；飞控系统；故障诊断中图分类号：TP301 文献标识码：A 文章编号：1004- 731X(2008)05- 1270- 04

# Mechanic Fault Diagnosis Based on Adaptive Multi-wavelet Networks Prediction Model for Fighter

HUANG Yi- jun1,2, WU Chang- an

(1. Dept. of Computer Science and Technology, Xinyang Normal University, Xinyang 464000, China; 2. The Aeronautical College of Air Force, Xinyang 464000, China)

Abstract: It's very important to diagnose the mechanic faults of a fighter accurately in time. A novel diagnosis method based on adaptive multi- wavelet networks prediction model was proposed. The structure and training algorithm of this adaptive multi- wavelet networks were introduced. The simulation results of a type of fighter actuator show that the method is more efficient and exact in application to three kinds of common faults diagnosis of flight control system. Key words: adaptive multi- wavelet network; prediction; flight control system; fault diagnosis

# 引言

飞机由于机械故障导致发生飞行事故的情况时有发生，准确及时地诊断飞机的机械故障对于保障飞行安全有着十分重要的意义。而机械故障中飞行控制系统的故障尤为典型，目前某型飞机的飞控系统故障诊断主要是利用等价空间法产生残差来进行故障检测与故障隔离的。该方法在故障检测方面较为有效，但在故障隔离方面性能较差。

人工神经网络（ANN）在故障隔离方面表现出较为优秀的性能，利用ANN进行故障诊断已取得了许多成果。ANN具有很强的非线性映射能力，通过学习，在理论上，ANN可以以任意精度逼近学习的对象，这对于故障隔离是十分有效的。但是ANN的过拟合与泛化性之间的矛盾不易调和，很多时候其学习训练收敛的速度较慢（快了容易发散），而且还容易收敛到网络的局部最优点，这些缺点对实用化和工程化而言十分不利。近年来，小波分析以其特有的时频分析能力在故障诊断领域受到了广泛的重视。小波分析在时域和频域同时具有良好的局部化性质，小波变换可以对高频成分采用逐渐精细的时域或空间域取代步长，从而可以聚焦到对象的任意细节。将小波分析与ANN相结合而形成的小波网

络（WINN）成为故障诊断技术中的一个更为有效的工具。

小波网络对于复杂的系统建模问题，只能在一定准则下找到尽可能逼近系统的近似模型，虽然当隐含层的小波元和样本点无限多时，可以任意地逼近真实系统，但实际中样本点和系统资源是有限的，所以只能抓住系统的某些主要特征。不同的小波元对不同的函数往往表现出不同的逼近特性[2]，例如：对跳变信号，Haar小波比较合适；对由分段多项式结构组成的信号，Daubechies小波比较合适；如果信号含正弦分量，则局部三角形的小波基比较合适。而复杂的系统往往表现多种特性，没有一种小波基能够是一致最好的，所以单靠一种小波基难以在有限的数据集合上达到理想的效果，而把具有不同分辨率的小波网络组合起来形成多少波网络（MWN）可发挥各自的优点[3]。

本文构造了一个自适应多小波网络对文献[1]中提到的故障诊断系统进行了改善，使系统对作动器的故障隔离能力有了很大的提高。

# 1 基于自适应多小波网络预测模型的故障诊断原理

对于复杂的飞控系统，通过建立自适应多小波网络预测模型监测系统的运行情况。自适应多小波网络故障诊断原理如图1所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/80b3d8a0b25d46d3f65d4e79d66bab9faa5fd6331e38e6d84dbecf7eb4a747a0.jpg)  
图1基于自适应多小波网络预测模型的故障诊断原理

自适应多小波网络的输入可分为2个部分：时间序列的历史数据及影响时间序列取值的主要变量的当前取值。其中时间序列的历史数据通过时延环节进入网络，作为网络的第1部分输入。时间序列的历史数据进入网络后通过相应的学习算法来调整网络参数，使得预测值逼近实际值。

# 2 自适应多小波网络的构造和算法

# 2.1自适应多小波网络的构造

设有  $L^2 (\mathbb{R})$  中的闭子空间序列  $\{V_j\}$  满足  $V_{j + I}\subset V_{j}$ $\mathrm{j}\in \mathbb{Z}$  ，其中

$$
V_{j} = \text{span}\{\phi_{m,n}^{j}(t) = 2^{\frac{m}{2}}\phi^{j}(2^{m}t - n)|m,n\in \mathbb{Z};l = 1,2,\dots ,r\} \tag{1}
$$

$\phi^l (t),\phi^2 (t),\dots ,\phi^r (t)$  是一组尺度函数，令  $W_{j}$  是  $V_{j}$  在  $V_{j + I}$  中的直交补空间，即：  $V_{j + 1} = V_{j}\oplus W_{j}$  其中，

$$
W_{j} = \text{span}\{\psi_{m,n}^{l}(t) = 2^{\frac{m}{2}}\psi^{l}(2^{m}t - n)|m,n\in \mathbb{Z};l = 1,2,\dots ,r\} \tag{2}
$$

则称  $\psi^l (t),\psi^2 (t),\dots ,\psi^r (t)$  是一组小波函数。可以把空间  $L^2 (\mathbb{R})$  中的函数  $f(t)$  进行分解：

$$
f(t) = \sum_{l = 1}^{r}\sum_{m,n}\left\langle f,\psi_{m,n}^{l}\right\rangle \psi_{m,n}^{l}(t) \tag{3}
$$

在小波变换的实际计算中，式（3）中多项式的有限项之和就可以对函数  $f\in L^2 (\mathbb{R})$  进行有效的逼近[4]。即：

$$
\widehat{f} = \sum_{l = 1}^{r}\sum_{m,n}^{N}w_{m,n}^{l}\psi_{m,n}^{l}(t) = \sum_{l = 1}^{r}\sum_{m,n}^{N}w_{m,n}^{l}2^{-\frac{m}{2}}\psi^{l}(2^{-m}t - n) \tag{4}
$$

上式可直接映射为一个单隐层的前馈小波网络，如图2所示（图例中是  $r = 2$  的情况），其中输入层到隐层的权值为  $w_{ik}^{l}$ $w_{ik}^{2}$  隐层各个神经元的传递函数由小波函数  $\psi_{m,n}^{l}(t)$  构成，利用  $w_{ok}^{l}$ $w_{ok}^{2}$  连接到输出。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/a19c9ee5d0ec6c599790ddc9919104ab7aeebbce8ae82a7eefcbdaa5230cce17.jpg)  
图2多小波（  $r = 2$  ）神经网络结构

以上多小波网络是没有预先考虑被处理信号的特性就

进行设计的，具有较广的适应性，但也存在一个明显的不足，那就是由于是对信号不加区分地进行处理，在遇到不太适合的处理信号时，例如单小波网络的基波为MexicanHat小波而待处理的信号是跳变较多的奇异信号，那么在训练小波网络的时候就不可避免的要浪费很大的计算资源。若能先对信号的特性（例如信号的奇异性）加以辨识，然后再将信号送入多小波网络中的某一个或几个子网络中进行处理，这样有助于提高网络的运行效率。基于这样的思路并且考虑到本文研究的应用对象飞行控制系统的信号特点，本文设计一个如图3所示的自适应多小波网络。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/1c559492e048dcb82fd54c220c322b0860d3fccca28c77c1f61dac4d238e88cc.jpg)  
图3自适应多小波神经网络结构

其中  $FI$  模块为信号特征识别模块。信号与  $FI$  模块送出的权值  $w$  相乘后送入WNM子网络进行处理。考虑到本文研究的应用对象是飞行控制系统，所以根据飞控系统的信号特点选用DOG小波和Haar小波为基波来组成  $r = 2$  的多小波网络。

# 2.2自适应多小波网络的训练算法

很显然，从结构上看，这种多小波网络与一般的单小波网络是完全相似的，他们之间的差别只是在隐含层上，前两种单小波网络的隐层作用函数都是单一的小波函数，而后者为改善网络性能提高网络的适应性采用了多个小波函数作为隐含层的作用函数，实际上这种情况可看作多小波网络是由多个单小波网络有机组合在一起构成的，具体训练多小波网络时可以先单独训练每个单小波网络，把训练好的单小波网络并入多小波网络中并训练合并后的网络，重复这样的训练过程直到整个多小波网络满足要求为止。本文采用动量误差梯度下降法来训练网络。下面以DOG小波子网络的训练为例说明该算法，Haar小波子网络的训练是相似的。

DOG小波是两个尺度相差一倍的高斯函数之差：

$$
\psi (t) = e^{\frac{-t^2}{2}} - \frac{1}{2} e^{\frac{-t}{8}} \tag{5}
$$

以DOG小波为基波的子网络采用基于小波框架的构造方式。不失一般性，设输入层神经元个数为  $I$  ，隐层神经元个数为  $J$  ，输出层神经元个数为  $K$  ，有  $N$  个学习样本  $(X, \hat{Y})$  ，  $X$  是输入向量  $(x_{1}, x_{2}, \ldots , x_{l})$  ，  $\hat{Y}$  是期望输出向量  $(\hat{y}_{1}, \hat{y}_{2}, \dots , \hat{y}_{K})$  ，隐层第  $j$  个神经元的输入为：

$$
s_{j} = \sum_{i = 1}^{J}w_{1j}x_{i} \qquad j = 1,2,\dots J) \tag{6}
$$

其中，  $w_{1j}$  是隐层第  $j$  个神经元到输入层第  $i$  个神经元的连接权值。通过小波框架的作用而得到隐层第  $j$  个神经元的输出为：

$$
h_j = \psi_{a_j,b_j}(s_j) = \frac{1}{a_j}\frac{(\epsilon_{x_j - b_j})^2}{2a_j^2} -\frac{1}{2} e^{\frac{(\epsilon_{x_j - b_j})^2}{8a_j^2}}; \qquad (j = 1,2,\dots ,J) \tag{7}
$$

输出层为小波框架的线性组合，其第  $k$  个神经元的输出为：

$$
y_{k} = \sum_{j = 1}^{J}w2_{kj}\bullet h_{j}\qquad (k = 1,2,\dots ,K) \tag{8}
$$

其中，  $w2_{\mathrm{kj}}$  是输出层第  $k$  个神经元到隐层第  $j$  个神经元的连接权值。定义网络误差函数为：

$$
E = \frac{1}{2}\sum_{k = 1}^{K}\left(\hat{y}_k - y_k\right)^2 \tag{9}
$$

可以计算得到各参数的瞬时梯度向量为：

$$
\delta a_{j} = \frac{\partial E}{\partial a_{j}} = \sum_{k = 1}^{K}\left(\hat{y}_{k} - y_{k}\right)\bullet w2_{kj}\bullet \frac{\partial h_{j}}{\partial a_{j}}\qquad (j = 1,2,\dots ,J) \tag{10}
$$

$$
\delta b_{j} = \frac{\partial E}{\partial b_{j}} = \sum_{k = 1}^{K}\left(\hat{y}_{k} - y_{k}\right)\bullet w2_{kj}\bullet \frac{\partial h_{j}}{\partial b_{j}}\qquad (j = 1,2,\dots ,J) \tag{11}
$$

$$
\delta w1_{ji} = \frac{\partial E}{\partial w1_{ji}} = \sum_{k = 1}^{K}\left(\hat{y}_k - y_k\right)\bullet w2_{kj}\bullet \frac{\partial h_j}{\partial s_j}\bullet \frac{\partial s_j}{\partial w1_{ji}} \tag{12}
$$

$$
\begin{array}{c}\delta w2_{kj} = \frac{\partial E}{\partial w2_{kj}} = (\widehat{y}_k - y_k)\bullet h_j\\ (k = 1,2,\dots ,K;j = 1,2,\dots ,J) \end{array} \tag{13}
$$

其中：

$$
\begin{array}{l}\frac{\partial h_j}{\partial a_j} = \frac{(s_j - b_j)^2 - a_j^2}{a_j^4} e^{\frac{-(s_j - b_j)^2}{2a_j^2}} + \frac{4a_j^2 - (s_j - b_j)^2}{8a_j^4} e^{\frac{-(s_j - b_j)^2}{8a_j^2}};\\ \displaystyle \frac{\partial h_j}{\partial b_j} = \frac{s_j - b_j}{a_j^3} e^{\frac{-(s_j - b_j)^2}{2a_j^2}} - \frac{s_j - b_j}{8a_j^3} e^{\frac{-s_j - b_j}{8a_j^2}};\\ \displaystyle \frac{\partial h_j}{\partial s_j} = -\frac{\partial h_j}{\partial b_j};\quad \frac{\partial s_j}{\partial w1_{ji}} = x_i \end{array}
$$

为了加速收敛和防止网络振荡，引入动量因子  $\alpha (0< \alpha < 1)$ ，使各参数按下式进行修正：

$$
\nu (t + 1) = \nu (t) - \xi \bullet \delta \nu +\alpha [\nu (t) - \nu (t - 1)] \tag{14}
$$

式中：  $\xi$  为学习率；  $\nu$  代表  $w1_{\mathrm{ji}}$ ，  $w2_{\mathrm{ji}}$ ，  $a_{\mathrm{j}}$ ，  $b_{\mathrm{j}}$  这些参数。

以下是网络的学习步骤：

(1）网络初始化：给定误差目标、学习次数、初始学习率、学习率调整因子、动量因子等，初始化各层连接权向量，伸缩平移参数向量。

(2）对所有样本，根据初始化得到的权值和伸缩平移参数计算网络实际输出和网络误差。

(3）如果网络误差小于误差目标，则训练成功，保存各参数向量，退出学习，否则根据（10~13）式计算各参数的瞬时梯度向量，并根据（14）式计算各参数的修正向量。

(4）对各参数进行调整，得到新参数。

(5）根据新参数计算网络输出和网络误差。

(6）根据前后误差的变化情况，对学习率进行调整并在振荡的情况下对动量因子进行限制。

if 新网络输出误差  $\gimel$  原网络输出误差  $\ast 1.03$  （新误差增大，此时网络出现振荡）

降低学习率

强制动量因子为零

转到步骤（7）

else

if 新网络输出误差  $\leq$  原网络输出误差 （新误差减小） 增大学习率

end

将各新参数向量赋回旧参数向量，包括新误差到步骤（7）

end

(7）如果学习次数小于设定的学习次数，返回步骤(3)继续学习，否则退出学习过程。

学习过程采用了变学习率法。当后一次误差较前一次误差增大到一定程度时，说明参数调整幅度过大，使网络产生了振荡，于是将这一次的参数修正结果放弃，并降低学习率，而且强制动量因子为零，完全限制动量项的作用，再返回到前一次参数的基础上重新进行修正，直到网络误差脱离振荡，回到下降状态。而当后一次误差较前一次误差减小时，则保留此次的参数修正结果，并增大学习率，以便在进行下一次学习时加大各参数的调整幅度。

# 3 仿真验证

# 3.1某型飞机作动器的典型故障及其仿真模型

作动器由舵机与助力器组成，输入信号由控制律提供，输出信号由助力器末端的线位移传感器获得。实际作动器系统是高阶非线性环节，其数学模型可简化为由二阶环节的作动器，速率限制和位置限制环节组成。二阶环节的作动器（不含助力器）传递函数为：

$$
G(s) = \frac{k\cdot a_{ij}^{2}}{s^{2} + 2\cdot\zeta\cdot a_{ij}^{2}\cdot s + \omega_{i}^{2}} = \frac{\delta_{t}(s)}{U(s)}
$$

其计算机仿真可用以下系统完成。见图4。仿真中考虑了舵面偏转角的饱和限制，也考虑了舵面偏转角速率的饱和限制。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/085b7a2dff317e0ab7df1211ae0b4d9eb36b2412e7cce8c3b8a0fb4d19120070.jpg)  
图4某型作动器仿真框图

该作动器的典型故障是舵卡死、增益故障和恒定偏差。这三类故障都可以从输出信号反应出来。因此，我们通过改变作动器模型中的参数来构建这三种故障模型。有了以上正常的模型和各种故障模型，我们就可以利用计算机来仿真正常状况和故障状况了。

# 3.2MWN的训练及仿真结果

通过对作动器故障仿真获取关于作动器三个子故障模式的样本数据，用于训练及验证的故障数据结构如表1所示。

表1故障数据结构  

<table><tr><td rowspan="2">样本编号</td><td colspan="4">去噪故障数据向量P</td><td colspan="4">故障模式向量T</td></tr><tr><td>1</td><td>2</td><td>……</td><td>8</td><td>故障1</td><td>故障2</td><td>故障3</td><td></td></tr><tr><td>1</td><td>P1,1</td><td>P1,2</td><td>……</td><td>P1,8</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>2</td><td>P2,1</td><td>P2,2</td><td>……</td><td>P2,8</td><td>1</td><td>0</td><td>0</td><td></td></tr><tr><td>……</td><td>……</td><td>……</td><td>……</td><td>……</td><td>……</td><td>……</td><td>……</td><td></td></tr></table>

在学习训练之前，将所获得的数据集分成训练集、验证集和测试集三个部分。验证集和测试集均取为原样本集大小的1/4。

图5给出了训练误差、验证误差和测试误差的变化曲线，由曲线可以看出，验证误差和测试误差的变化是一致的，这说明样本集的划分是合理的。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/98111871-a7d1-4e0f-948c-e73e3ac9b644/5ef656aba16dbddf6ea322104f3e59b0b548315836b11ffeee60943d55dccb58.jpg)  
图5训练误差、验证误差和测试误差的变化曲线

对训练好的网络仿真的输出结果和目标结果进行线性回归分析，分析结果表明网络对三种故障的检测结果输出都很好，它们与目标输出的相关系数分别达到了0.965、1和0.976。

为检测网络的诊断能力，我们重新采集了三组故障数据让网络进行诊断，对三个故障新数据的诊断结果见表2。

表2MWN对三种故障的诊断结果  

<table><tr><td rowspan="2">样本号</td><td rowspan="2">所属故障</td><td colspan="3">诊 断 结 果</td></tr><tr><td>故障1</td><td>故障2</td><td>故障3</td></tr><tr><td>1</td><td>故障1</td><td>0.9716</td><td>-3.29e-006</td><td>-0.02836</td></tr><tr><td>2</td><td>故障2</td><td>-0.0455</td><td>1.0093</td><td>0.0362</td></tr><tr><td>3</td><td>故障3</td><td>0.0041</td><td>0.0141</td><td>0.9858</td></tr></table>

从表中可以看到，MWN对三种故障都可以准确识别出来。

# 3.3与WN及BP神经网络的比较

构造一个基于改进的BP算法的神经网络（内部回归神经网络[5]），在相同的输入、相同的精度要求和相近的网络规模的条件下比较两个网络的各项性能指标。仿真结果表明：多小波网络全面优于BP神经网络，要达到相同的训练精度，多小波网络循环83步而BP网络则需要150步；多小波网络对三种故障均能准确辩识，而BP网络对故障3的泛化诊断能力较差。另一方面，虽然WN和MWN一样也可准确辩识三种故障，但WN耗时较多，要达到相同的训练精度，WN需循环100步[6]。

# 4结论

小波分析在时域和频域同时具有良好的局部化性质，二进小波对信号的分析具有变焦距的作用，由小波神经元构成的神经网络不会陷入在常规BP网络那样的局部极小点。而由多个小波网络组成的多小波网络不仅继承了小波网络的优点而且具有一种整合优势，它既能拥有各个小波网络原有的优点，又互相弥补了各自的缺陷。仿真结果表明：用自适应多小波网络进行故障诊断具有泛化性强、收敛较快、诊断较准确等优点

# 参考文献：

[1] 罗昌行：自修复飞控系统故障检测与强度实时软件开发与测试[D].西安：西北工业大学，2000. [2] I Daubechies. Ten lectures on wavelets [M]. Philadelphia: Society for Industrial and Applied Mathematics, 1992. [3] Licheng Jiao, Jin Pan, Yangwang Feng. Multi- wavelet Neural Network and Its Approximation Properties [J]. IEEE transaction on neural networks (S00- 8- 9464), 2001, 12(5): 1060- 1066. [4] Zhang J, Walter G G, Miao Y B, et al. Wavelet Neural Networks for Function Learning [J]. IEEE Trans on Signal Processing (S1035- 587X), 1995, 43(6): 1485- 1497. [5] 闻新，周露，等.Mailab神经网络仿真与应用[M].北京：科学出版社，2003. [6] 黄宜军，章卫国，刘小雄.基于Morlet小波的飞控系统故障诊断方法研究[J].计算机应用，2005,25(9):2007- 2009.

# （上接第1242页）

[6] George H Burgin, W H Wniams, L B Sidor. The Adaptive Maneuvering Logic Program in Support of the Pilot's Associate Program: Heuristic Approach to Missile Evasion [R]. USA: AIAA 86- 0423, 1986. [7] Chappell Alan R. Knowledge- based Reasoning in the Paladin Tactical Decision Generation System [R]. USA; NASA- CR- 4507, 1993. [8] John W McManus, Alan R Chappell, P Douglas Arbuckle. Situation Assessment in the Paladin Tactical Decision Generation System [R].

USA:AGARD Conference Proceedings,Air Vehicle Mission Control and Management,1992:1- 10. [9] Alan R Chappell, John W McManus, Kenneth H Goodrich. Trial Maneuver Generation and Selection in the PALADIN Tactical Decision Generation System [R].USA:AIAA- 1992- 4541,1992. [10] C Edward Lan, Jyh- Jang Chan, Jyh- Yeuan Ho. Development of an Air Combat Evaluation System [R].USA; AIAA- 2000- 3912, 2000. [11] 柳嘉润.综合控制系统与自主近距格斗技术研究[D].北京：北京航空航天大学博士学位论文，2006