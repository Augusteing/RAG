# 基于回声状态网络的飞机混沌时间序列预测模型

郭阳明，蔡小斌 $^{1,2}$ ，付琳娟 $^{1}$ ，马捷中 $^{1}$

（1. 西北工业大学计算机学院，陕西西安 710072；2. 中航工业科技委，北京 100012）

摘要：准确检测飞机即将发生的故障或预测其状态的变化趋势，对于实现飞行安全具有重要意义。文章针对传统基于回声状态网络在故障预测中的不足，构建了基于小波降噪的回声状态网络预测模型。该模型保留了非线性时间序列回声状态网络预测的优势，并采取小波变换对混沌时间序列进行降噪预处理，有效提高了含噪混沌时间序列的预测精度。论文通过对某飞机发动机滑油散热器温度时间序列数据序列进行预测分析，表明文中模型具有较好的预测精度，验证了模型的有效性。

关键词：小波变换；回声状态网络；非线性混沌时间序列；故障预测

中图分类号：  $\mathrm{TP206}^{+}$  .3TP391 文献标识码：A 文章编号：1000- 2758（2012）04- 0607- 05

飞机对其可靠性和安全性有着很高的要求，提前检测其即将发生的故障或寿命变化趋势具有重要的实际意义和应用价值。但是，传统的利用动力学或数据序列主观模型的预测方法并不能很好地适用飞机及其子系统或组成部件等复杂非线性系统。

研究表明，反映飞机及其子系统或组成部件工作状态的关键参数的时间序列是典型的非线性混沌时间序列。近年来，混沌科学的发展为混沌时间序列预测提供了新的解决途径。但是，由于实际应用中混沌时间序列中的噪声信号严重影响了其相空间重构，使得混沌时间序列的预测效果不尽如人意。

本文基于混沌时间序列相空间重构的思想，提出小波降噪和回声状态网络（Echo State Networks，ESN）相结合的预测模型，并结合实际试验数据进行了预测分析，验证了该方法的有效性。

# 1 相关知识

# 1.1 非线性混沌时间序列的相空间重构

相空间重构是混沌时间序列分析的基础，Takens等人提出了用延迟坐标法对混沌时间序列 $\{x_{1},x_{2},x_{3},\dots ,x_{N}\}$  进行重构

$$
\pmb{\beta}_{n} = (x_{n - (m - 1)},x_{n - (m - 2)},\dots ,x_{n}) \tag{1}
$$

$\beta_{n}$  称为延时矢量，  $m$  称为嵌入维数，  $\tau$  称为延迟时间。

Takens嵌入定理提供了时间序列无限长且无噪声情况下嵌入维的选取依据，但实际测得的时序是有限长，而且不可避免受到噪声的污染，因此相空间重构的延迟时间  $\tau$  和嵌入维数  $m$  的选取方法是关键。近年来，研究人员基于嵌入延迟窗  $\overline{\tau}_{w} = (m - 1)\tau$  的  $\tau$  和  $m$  联合求解方法，提出了改进的C- C方法，有效提高了参数的选择精度和计算速度。

# 1.2 小波降噪原理

小波降噪通过对信号的多分辨率分解，在多个层次上分析和考察信号的特性。

设含有噪声的信号为  $f(t)$  ，复原信号为  $x(t)$  噪声信号为  $e(t),f(t) = x(t) + e(t)$  。对  $f(t)$  用基小波  $\phi (t)$  作离散小波变换，得到系数为

$$
\begin{array}{l}{W_{j}(j,k) = 2^{-\frac{j}{2}}\int_{R}f(t)\overline{\phi}_{j,k}(t)\mathrm{d}t}\\ {= 2^{-\frac{j}{2}}\int_{R}x(t) + e(t)\overline{\phi}_{j,k}(t)\mathrm{d}t}\\ {= 2^{-\frac{j}{2}}\int_{R}x(t)\overline{\phi}_{j,k}(t)\mathrm{d}t + }\\ {2^{-\frac{j}{2}}\int_{R}e(t)\overline{\phi}_{j,k}(t)\mathrm{d}t = X(j,k) + E(j,k)} \end{array} \tag{2}
$$

式中，  $j$  为尺度，表示小波的周期尺度；  $k$  为时间因子，反映小波在时间上的平移；  $\phi (t)$  是  $\phi (t)$  的复共轭函数；  $X(j,k)$  是复原信号经过小波变换后的系数，  $E(j,k)$  是噪声信号经过小波变换后的系数。  $f(t)$  的奇异性与Lipschitz指数  $\alpha$  之间在二进小波变换下的关系为[6]

$$
\mid W_{j}(j,k)\mid \leqslant A2^{j\alpha} \tag{3}
$$

式中，  $A$  为常数。

通常情况下，有用信号的  $\alpha >0$  ，其小波变换的模极大值随尺度的增大而增大。而噪声信号的  $\alpha \leq 0$  ，小波变换的模极大值随尺度的增大而减小。因此，可以在各个尺度上选取不同的阈值，小于该阈值的模极大值点认为是由噪声的小波变换引起的，将其置为0；大于该阈值的模极大值点认为是由信号的小波变换引起的，予以保留。在此基础上通过小波逆变换重构信号，从而达到去除噪声的目的。

# 1.3 回声状态网络的预测原理

回声状态网络是一种新型的递归神经网络，在非线性时间序列的预测中得到了难以置信的良好结果。ESN来源于液体状态机（Liquid State Machine，LSM），与传统的循环神经网络相比，ESN隐层的神经元个数达到上百至上千个，形成一个巨大的储备池（Dynamic Reservoir，DB），如图1所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/8c8def9caca3808ec2f9ff20ff88db32a4c685e3bae977a5c047116f46b09502.jpg)  
图1 ESN网络结构示意图

假设一个ESN，有  $K$  个输入层单元，  $N$  个隐层单元，  $L$  个输出层单元。在时刻  $n$  ，输入单元的序列为  $\pmb {u}(n) = [\underline{u}_1(n),u_2(n),\dots ,u_K(n)]$  ，隐层的状态序列为  $\pmb {x}(n) = [\pmb{x}_1(n),\pmb{x}_2(n),\dots ,\pmb{x}_N(n)]$  ，输出单元的序列为  $\begin{array}{rlr}{\pmb {y}(n)} & = & {\left[\gamma_1(n),y_2(n),\dots ,y_L(n)\right]} \end{array}$  。用 $\mathbf{W}_{N\times K}^{\mathrm{in}}$  表示输入层的连接权值矩阵；  $\mathbf{W}_{N\times N}$  表示储备池内部的连接权值矩阵，它通常保持  $1\% \sim 5\%$  的稀疏连接，并且谱半径一般小于1，这使得储备池具有动态记忆能力和一定的稳定性；  $\mathbf{W}_{L\times (K + N + L)}^{\mathrm{out}}$  表示输出层

的连接权值矩阵；  $\mathbf{W}_{N\times L}^{\mathrm{back}}$  表示输出层到隐层的反馈权值矩阵。其中，  $\mathbf{W}^{\mathrm{in}}$  、  $\mathbf{W}$  和  $\mathbf{W}^{\mathrm{back}}$  是在网络建立前随机生成的，并且一经构成就不再改变，只有  $\mathbf{W}^{\mathrm{out}}$  是通过训练计算得到的，而ESN的训练目的就是要确定输出权值  $\mathbf{W}^{\mathrm{out}}$  。ESN的基本方程为

$$
\pmb {x}(n + 1) = f(\pmb{W}^{\mathrm{in}}\pmb {u}(n) + \pmb {W}\pmb {x}(n) + \pmb{W}^{\mathrm{back}}\pmb {y}(n))
$$

$$
\begin{array}{rl}{\pmb {y}(n + 1)} & {= f_{\mathrm{out}}(\pmb{W}^{\mathrm{out}}(\pmb {u}(n + 1))} \end{array}
$$

$$
\pmb {x}(n + 1),\pmb {y}(n)) + \pmb{W}_{\mathrm{bias}}^{\mathrm{out}} \tag{4}
$$

式中  $\mathbf{W}_{\mathrm{bias}}^{\mathrm{out}}$  表示输出的偏置项或者可以代表噪声，通常设定为  $0:f = [f_{1},f_{2},\dots ,f_{N}]$  表示内部神经元激活函数，通常情况下，  $f_{i}(i = 1,2,\dots ,N)$  取做双曲正切函数；  $\pmb{f}_{\mathrm{out}} = [f_{\mathrm{out}}^{\mathrm{i}},f_{\mathrm{out}}^{\mathrm{2}},\dots ,f_{\mathrm{out}}^{\mathrm{i}}]$  表示输出函数.典型情况下，  $\pmb{f}_{\mathrm{out}}(i = 1,2,\dots ,L)$  取恒等函数。

ESN的基本算法是通过输入信号激励储备池，从而产生储备池中连续的状态变量信号，最后通过储备池状态变量与目标输出信号的线性回归算法确定ESN网络输出权值。它的训练过程如下：

1）初始化  $\mathbf{W}^{\mathrm{in}}$  、  $\mathbf{W}$  和  $\mathbf{W}^{\mathrm{back}}$  
2）利用样本和公式（4）求出隐层状态序列  $\pmb {x}(n)$  
3）根据状态序列  $\pmb {x}(n)$  、输出样本  $\pmb {y}(n)$  ，利用公式（4）和线性回归法求出输出权值矩阵  $\mathbf{W}^{\mathrm{out}}$

# 2 基于小波降噪的回声状态网络预测

# 2.1 预测模型

ESN有效地解决了传统神经网络训练过程复杂、易陷入局部极小点等问题，能够极好地逼近非线性系统。但是，当非线性混沌时间序列受噪声污染严重时，ESN的预测性能将会受到一定影响。因此本文提出了如图2所示的预测模型结构，其预测步骤如下：

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/6de2a5564fe0f7ca606d3834dc876d7b36b6b365ccc59f1b72c5357e38a53761.jpg)  
图2基于小波降噪的ESN预测模型

根据图2所示的预测模型，本文利用ESN进行

非线性时间序列预测的步骤如下：

1）小波分析降噪。获得时间序列数据，并利用小波分析对实测数据进行降噪处理。

2）重构相空间。利用去噪后的时间序列，选择适当的嵌入维数  $m$  和延迟时间  $\tau$  ，进行相空间重构，得到相空间矩阵  $X$  。

3）设计并训练ESN网络，确定ESN网络的结构，初始化ESN的权值矩阵  $W$  、  $W^{\mathrm{min}}$  和  $W^{\mathrm{back}}$  ，并利用构建的训练样本对ESN网络进行训练，得到最终用于预测的模型。

4）预测分析。利用训练好的预测模型进行非线性时间序列预测。

# 2.2 预测模型精度检验

本文利用标准均方根误差  $E_{\mathrm{NRMSE}}$  来衡量模型的预测精度。

$$
E_{\mathrm{NRMSE}} = \sqrt{\frac{\frac{1}{l}\sum_{n = 1}^{l}\left(\hat{y}(n) - y(n)\right)^{2}}{\frac{1}{l}\sum_{n = 1}^{l}\left(y(n) - \bar{y}\right)^{2}}} \tag{5}
$$

式中，  $y(n)$  为变量的样本输出序列，  $\bar{y}$  为变量样本输出序列的均值，  $\bar{y} (n)$  为变量的预测输出序列。

# 3 仿真分析

# 3.1 实例描述

利用本文的预测模型和传统ESN预测方法对采集的某飞机发动机滑油散热器温度时间序列数据进行单步和5步预测对比分析。通过试验采集的滑油散热器温度时间序列数据如图3所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/b0887254133fa1769c645cacedd2e61bee339de2d2333f9b052e025596e464bf.jpg)  
图3 实测的滑油散热器温度数据

# 3.2 ESN预测分析

利用改进的C- C法选择重构相空间的延迟时间  $\tau = 29$  ，嵌入维数  $m = 7$  ，对滑油散热器温度时间序列进行相空间重构。根据求得的参数重构出滑油散热器温度时间序列延迟向量为

$$
X(t) = (x(t),x(t - 29),\dots
$$

$$
x(t - (7 - 1)\times 29))
$$

重构相空间后，利用样本数据中的前  $50\%$  作为模型的训练样本对ESN网络进行训练，并利用训练好的ESN预测模型对实测数据中的后  $50\%$  的测试样本进行预测分析。

根据延迟向量维数选择输入层节点数  $K = m = 7$  ，取隐层神经元个数  $N = 300$  ，隐层内部连接矩阵  $W$  为  $3\%$  的稀疏连接矩阵，谱半径  $\rho = 0.5$  ，输出层神经元个数  $L = 1$  。利用该模型对滑油散热器温度进行单步预测的效果及预测误差如图4所示，5步预测的效果及预测误差曲线如图5所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/ce90d02ef46e6c8184c093956bb26141fcc5bc0206a0e163a1b1bbe4f29c5798.jpg)  
图4 ESN预测模型对滑油散热器温度的单步预测曲线

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/75a9679022bae5ee73814762bac34cefcf2e04aba214b71fe9451f28ad23f5f0.jpg)  
图5 ESN预测模型对滑油散热器温度的5步预测曲线

利用ESN预测模型对滑油散热器温度时间序列进行预测的预测误差和预测时间列于表1中。

从图4、图5和表1可以看出，ESN预测模型对滑油散热器温度也能够做出较为准确的预测。

表1ESN预测模型的误差和预测时间  

<table><tr><td>预测步长</td><td>网络训练时间/s</td><td>预测时间/s</td><td>对训练样本的拟合E NRMSE</td><td>对测试样本的预测E NRMSE</td></tr><tr><td>单步预测</td><td>4.891</td><td>4.812</td><td>0.100 910</td><td>0.190 510</td></tr><tr><td>5步预测</td><td>4.953</td><td>5.625</td><td>0.136 130</td><td>0.288 140</td></tr></table>

# 3.3 基于小波降噪的ESN预测分析

首先利用小波分析方法对测得的滑油散热器温度数据进行降噪，降噪后的时间序列数据如图6所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/a2cc8d7319cbadd15c7debbd15d2a1fe74e6ae95b342faeb4741044c22647085.jpg)  
图6降噪后的滑油散热器温度数据

降噪后同样采用改进的C- C法对滑油散热器温度时间序列进行相空间重构。选择重构相空间的延迟时间  $\tau = 20$  ，嵌入维数  $m = 10$  。因此，重构出的滑油散热器温度时间序列的延迟向量为

$$
X(t) = (x(t),x(t - 20),\dots x(t - (10 - 1)\times 20)) \tag{7}
$$

将ESN的输入层节点数设定为  $K = 3$  ，隐层和输出层节点的个数及其它参数选择同3.2节。同样，用前  $50\%$  的样本数据训练ESN，并对剩余  $50\%$  的数据利用已有的模型进行单步预测和5步预测，预测效果及其误差曲线如图7、图8所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/44daa363b7e5581fd14ac87520db9ac7694e4aa94dde66ec008b11dcf91c347f.jpg)  
图7本文预测模型对滑油散热器温度的单步预测曲线

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4642643e-6359-4740-b010-caf43197c3cf/6b04b69407cd1490fa8030b4f504c5e646d4349f5cf2a55400d87a24238c7bfe.jpg)  
图8本文预测模型对滑油散热器温度的5步预测曲线

从图7和图8的预测效果曲线可以看出，本文预测模型对降噪后的滑油散热器温度的单步预测和5步预测都比较准确，能够有效地预测出其趋势。具体的预测误差和预测时间列于表2中。

表2本文预测模型的误差和预测时间  

<table><tr><td>预测步长</td><td>网络训练时间/s</td><td>预测时间/s</td><td>对训练样本的拟合E NRMSE</td><td>对测试样本的预测E NRMSE</td></tr><tr><td>单步预测</td><td>3.386</td><td>3.177</td><td>0.056 783</td><td>0.124 639</td></tr><tr><td>5步预测</td><td>3.395</td><td>4.082</td><td>0.068 036</td><td>0.255 297</td></tr></table>

对比表1和表2可以看出，本文预测方法能对滑油散热器温度数据进行准确有效的预测，并具有较高的预测精度，同时相比传统ESN预测模型，在一定程度上减少了ESN网络的训练时间和预测时间。

# 4结论

本文针对传统基于回声状态网络在非线性时间序列预测中的不足，构建了基于小波降噪的回声状态网络快速预测模型。该方法保留了ESN网络在非线性时间序列预测中的优势，并采用小波分析对混沌非线性时间序列进行降噪，以提高模型对含噪序列预测的精度。

通过对某飞机发动机滑油散热器温度时间序列数据进行预测对比分析，表明本文方法具有更好的拟合和预测精度，从而验证了模型的有效性。

# 参考文献：

[1] 陈铿, 韩伯棠. 混沌时间序列分析中的相空间重构技术综述. 计算机科学, 2005, 32(4): 67- 70Chen Keng, Han Botang. A Survey of State Space Reconstruction of Chaotic Time Series Analysis. Computer Science, 2005, 32(4): 67- 70 (in Chinese)[2] Jaeger H. The Echo State Approach to Analyzing and Training Recurrent Networks. German National Research Center for Information Technology, Tech Rep 148, 2001[3] 韩敏. 混沌时间序列预测理论与方法. 北京: 中国水利水电出版社, 2007Han Min. Prediction Theory and Method of Chaotic Time Series. Beijing: China Water Power Press, 2007 (in Chinese)[4] 陆振波, 蔡志明, 姜可宇. 基于改进的 C- C 方法的相空间重构参数选择. 系统仿真学报, 2007, 19(11): 2527- 2529, 2538Lu Zhenbo, Cai Zhiming, Jiang Keyu. Determination of Embedding Parameters for Phase Space Reconstruction Based on Improved C- C Method. Journal of System Simulation, 2007, 19(11): 2527- 2529, 2538 (in Chinese)[5] Rosenstein M T, Collins J J, De Luca C J. Reconstruction Expansion as a Geometry Based Framework for Choosing Proper Delay Time. Physica D, 1994, 74: 82- 98[6] Mallat S, Huang W. Singularity Detection and Processing with Wavelets. IEEE Trans on Information Theory, 1992, 38(2): 617- 643[7] 雷正伟, 徐章遂, 米东, 刘美全. 神经网络的预测性能的优化分析. 计算机测量与控制, 2004, 12(1): 15- 16Lei Zhengwei, Xu Zhangsui, Mi Deng, Liu Meiquan. Optimization Analysis of Neural Networks Forecast Performance. Computer Measurement and Control, 2004, 12(1): 15- 16 (in Chinese)[8] 郭阳明, 翟正军, 姜红梅. 基于新息的多参量混沌时间序列 LS- SVR 加权预测. 西北工业大学学报, 2009, 27(1): 83- 86Guo Yangming, Zhai Zhengjun, Jiang Hongmei. Weighted Prediction of Multi- Parameter Chaotic Time Series Using Least Squares Support Vector Regression (LS- SVR). Journal of Northwestern Polytechnical University, 2009, 27(1): 83- 86 (in Chinese)

# An Effective Prediction Model for Aircraft Chaos Time Series Based on Echo State Networks (ESN)

Guo Yangming $^{1}$ , Cai Xiaobin $^{1,2}$ , Fu Linjuan $^{1}$ , Ma Jiezhong $^{1}$ 1. Department of Computer Science and Engineering, Northwestern Polytechnical University, Xi'an 710072, China2. Science and Technology Commission of AVIC, Beijing 100012, China

Abstract: It is significant for flight safety to accurately detect the coming fault of aircraft or predict its change trend. Aiming at suppressing the shortcoming of fault prediction based on traditional ESN, we present a new prediction method combining ESN with wavelet denoising. Sections 1 and 2 of the full paper explain our prediction model mentioned in the title, which we believe is effective and whose core is: the method not only reserves the advantages of ESN model in nonlinear time series prediction but also reduces the noise influence in practice, i.e., the pretreatment via wavelet transform will be done before prediction. Section 3 concerns a certain type of aero- engine lubricator. Its simulation results are presented in Figs. 4, 5, 7, 8 and Tables 1 and 2. The simulation results and their analysis show preliminarily that the proposed method improves the prediction accuracy of nonlinear chaotic time series including noises, thus indicating that the proposed model is an effective approach in actual application.

Key words: aircraft, efficiency, errors, mathematical models, noise abatement, wavelet transforms; echo state networks (ESN), nonlinear time series, prediction