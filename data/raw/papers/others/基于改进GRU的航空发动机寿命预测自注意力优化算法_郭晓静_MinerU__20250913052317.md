文章编号：1000- 8055(2024)12- 20220984- 11

doi:10.13224/j.cnki.jasp.20220984

# 基于改进GRU的航空发动机寿命预测自注意力优化算法

郭晓静，徐晓慧，郭佳豪

（1. 中国民航大学航空工程学院，天津300300；2. 中国民航大学电子信息与自动化学院，天津300300）

摘要：航空发动机性能参数具有多元高维及时序性，可表征寿命退行，采用常规模型训练易导致梯度消失。因此提出一种改进门控循环单元（gated recurrent unit）的自注意力（self- attention）优化算法，分析数据源域行梯度及列间相关性，扩增寿命强相关列优化特征权重，加速模型收敛，提高预测精度。在发动机寿命预测数据集（C- MAPSS）上实验表明：该算法得到的寿命方均根误差（RMSE）落在区间[10.52,18.91]，超前预测分值(score）落在区间[48.69,204.98]，相比传统方法大幅降低，改善了寿命预测效果，能够为发动机寿命预测和超前维护提供有效解决方案。

关键词：剩余使用寿命；预测与健康管理；门控循环单元；自注意力机制；主成分分析中图分类号：V240.2 文献标志码：A

# Improved GRU-based self-attention optimization algorithm for aero-engine remaining useful life prediction

GUO Xiaojing，XU Xiaohui，GUO Jiahao

（1. School of Aeronautical Engineering，Civil Aviation University of China，Tianjin 300300，China; 2. College of Electronic Information and Automation, Civil Aviation University of China，Tianjin 300300，China)

Abstract: Multivariate, high- dimensional and time- ordered aero- engine performance parameters can characterize life regressions, which are prone to gradient disappearance using conventional model training. A self- attention optimization algorithm was proposed to improve the gated recurrent units (GRU). Row gradients of source domain and inter- column correlations were analyzed. The feature weights were optimized by augmenting the strongly correlated lifetime columns, with its aim to accelerate model convergence and improve prediction accuracy. Experiments on the engine life prediction dataset (C- MAPSS) showed that the root mean square error (RMSE) of life obtained by the algorithm fell in the interval [10.52, 18.91] and the over- prediction index (score) in the interval [48.69, 204.98]. Compared with the traditional method, the effect of life prediction was greatly reduced, and an effective solution was provided for engine life prediction and advanced maintenance.

Keywords: remaining useful life (RUL); prediction and health management; gated recurrent units (GRU); self- attention mechanism; principal component analysis (PCA)

作为飞机动力系统的核心组件，航空发动机剩余寿命（RUL）预测具有重要意义。发动机本身结构复杂，在油路、气路、电路的协同驱动下，实现叶片转速控制；相关运行参数经检测存储至集成组件，并由飞行管理计算机系统据此完成其他飞行参数的计算与校正，从而实现对飞机滑行、爬升、巡航、进近、着陆等各阶段的发动机推力控制。根据美国国家航空航天局(NASA)的统计，民航发动机故障约占飞机机械故障的  $30\%$  ，全球每年在飞机发动机方面的维护费用超过20亿美元。因此，通过研究发动机运行状态实现剩余寿命预测，降低偶然失效导致的飞行安全隐患，能够一定程度上降低维修成本，具有现实意义。

发动机剩余寿命预测与发动机故障诊断均属健康管理(PHM)范畴，但区别于故障诊断采用的特征聚类分析，剩余寿命预测方法属于回归分析。因此，寿命回归预测需要兼顾发动机控制结构与运行状态时序参数。随着信息化技术、电子技术与性能参数技术的发展，机载飞行数据记录器(QAR)记录并存储的发动机性能参数日益丰富，呈现大规模、多元高维和时序性特点。国内外研究学者所提出的剩余寿命预测算法，分为基于物理模型的方法、基于统计模型的方法、基于机器学习的方法和基于深度学习的方法。最早提出的基于物理模型的寿命预测算法，侧重从机械结构的构型、动力模型来研究结构损伤导致的寿命降低，但由于机械系统结构复杂且工作环境恶劣，很难准确建立物理模型来反映实际退行规律。基于历史数据特征预测寿命的统计学方法通常需要假定退化模型[3- 4]，手工提取特征，难以挖掘数据中的潜在规律[5]，导致模型泛化性差。2018年，黄亮等提出一种基于Wiener过程的寿命预测方法，在发动机寿命预测数据集（C- MAPSS）中的相对误差为  $0.25\%$  。同年，Du等提出采用机器学习方法将支持向量回归应用于锂电池剩余寿命预测中，在锂电池数据集中的相对误差为  $5\%$  ，但回归模型易产生过拟合现象。2019年，Ordonez等将自回归与支持向量机结合的模型应用于航空发动机寿命预测，但模型预测精度偏低。在CMAPSS数据集中的方均根误差（RMSE）最优取值为39.68。随着设备复杂化和集成化，数据呈现大规模的特性，因此提出利用深度学习方法的非线性映射能力和特征提取能力[9- 10]，构建模型训练样本以提高预测效果及泛化性能，而为了针对性

利用时序参数，常需要利用长短期记忆网络LSTM与门控循环单元GRU对长序列特征信息记忆优势构建融合模型。2019年，Zhang等利用卷积、循环结构对时序依赖关系的处理优势，提出卷积循环神经网络(CNN- RNN)融合模型预测剩余寿命（RUL），准确性指标（RMSE)在4组数据集（C- MAPSS）中取值落在[16.89，30.96]，但所采用的循环结构处理长时序数据会导致梯度消失。2020年，Li等提出了一种基于门控循环单元（GRU）来预测剩余寿命（RUL），准确性指标（RMSE)在4组数据集（C- MAPSS）中取值落在[13.45,25.40]，门控循环单元能够减缓梯度消失，但该方法无法捕捉长序列数据之间相关性。2023年，陈保家等提出了基于残差嵌套式长短期记忆和注意力机制模型预测发动机寿命的方法，准确性指标（RMSE）落在区间[11.94，20.99]，但隐藏层较多，增加了网络模型在提取性能参数特征的复杂性。

由于航空发动机性能参数具有明显的时序、多元及大规模特征，本文在分析性能参数源域的行梯度变化和列相关性的基础上，将卷积结构、门控循环结构与自注意力算法融合，提出构建CNN- GRU- 自注意力机制模型，提高发动机寿命预测精度，并改善超前预测效果。

# 1 问题描述

航空发动机以控制转速、产生推力为目标，控制方式及效果与系统气路结构有关。以本文研究的涡扇发动机为例，气路结构由进气道（外部入口）、风扇、涵道、高/低压压气机、燃烧室、高/低压涡轮、尾喷管组成，如图1所示。气流由进气道进入，经过风扇提高空气流速，吸入压气机。经低压压气机、高压压气机，完成低速和高速两级增压。增压后气体随压气机转子叶片进入燃烧室，吸收燃料热能，驱动涡轮高速转动，进而将气体热能转变为动能，带动转子旋转，产生推力。实际推力主要来源于转子转动。因此，发动机内部各运行阶段的速度、压强、温度、与推力等共同构成其运行参数，能够用于剩余寿命预测。由于实际可获取的发动机参数一部分来自性能参数直接采集，一部分来自飞行管理计算机解算，一部分来自对同量纲参数的实时比值，所以性能参数维度丰富，具有时序性，且部分参数之间、参数与寿命之间存在强相关性。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/c6cafbd9fdc7fcefdff4a549f52411765827381462516b812f11352b1fdd42a0.jpg)  
图1涡扇发动机气路结构[16] Fig.1 Turbofan engine airpath structure[16]

构建发动机剩余寿命预测模型需要解决多元时序回归问题。假定某发动机性能参数集为  $X_0$  寿命时间周期（或寿命逆序数）为  $T_{\parallel}$  性能参数总维度记为  $n$  。则  $X_0$  可表示为式（1)，其中  $x_{i}^{k}$  指该发动机在  $t$  时刻第  $k$  维性能参数的值。

$$
X_{0} = \left[ \begin{array}{ccccccccc}x_{1}^{1} & x_{1}^{2} & \dots & x_{1}^{k - 1} & x_{1}^{k} & \dots & x_{1}^{n}\\ x_{2}^{1} & x_{2}^{2} & \dots & x_{2}^{k - 1} & x_{2}^{k} & \dots & x_{2}^{n}\\ \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ x_{1}^{1} & x_{1}^{2} & \dots & x_{1}^{k - 1} & x_{1}^{k} & \dots & x_{1}^{n}\\ \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ x_{T}^{1} & x_{T}^{2} & \dots & x_{T}^{k - 1} & x_{T}^{k} & \dots & x_{T}^{n} \end{array} \right] \tag{1}
$$

利用性能参数构建回归预测模型  $F$  ，定义剩余寿命真实值为  $Y,$  剩余寿命预测值为  $\hat{Y}$  ，则模型使预测值  $\hat{Y}$  与真实值  $Y$  逼近，且两者偏差达到最小。对于任一台发动机，性能参数具有时序性，当前寿命预测值与前一时刻预测值和当前时刻性能参数有关。因而，时刻剩余寿命预测值  $\hat{Y}$  和方均根误差（rootmeansquareerror，RMSE，量符号记为  $E_{\mathrm{RMSE}}$  )分别满足式（2）、式（3)，且方均根误差取得极小值。

$$
\hat{Y}_t = F(X_0,\hat{Y}_{t - 1}) \tag{2}
$$

$$
E_{\mathrm{RMSE}} = \min \sqrt{\frac{\sum_{i = 1}^{T}|\hat{Y}_i - Y_i|^2}{T}} \tag{3}
$$

在模型测试期间，选取  $d_{i} = \hat{Y}_{i} - Y_{i}$  ，则  $d_{i} > 0$  时，剩余寿命预测值大于剩余寿命真实值，属于滞后预测；反之，当  $d_{i}< 0$  时，属于超前预测。因此，发动机剩余寿命预测效果除预测精度外，还应包含超前性指标。通常定义超前预测分值（score，量

符号记为  $V_{\mathrm{score}}$  )如式(4)所示。在相等预测误差条件下（  $\mathcal{A}$  点和  $B$  点处)，超前预测对应分值小于滞后预测对应分值。分值越小，超前预测性能越好[16]，如图2所示。当超前预测分值为恒定值时，对应的超前预测误差（C点处）比滞后预测误差（  $B$  点处)更大，为了平衡这种误差，根据经验与实验确定  $a_1 = 13$  和  $a_2 = 10$  。由于后续实验采用的是寿命逆序值，即每个时刻表示的剩余寿命。因而，超前预测分值越低，模型预测效果越好。

$$
V_{\mathrm{score}} = \left\{ \begin{array}{ll}\sum_{i = 1}^{T}(\mathrm{e}^{-\frac{d_i}{a_1}} - 1) & d_i< 0\\ \displaystyle \sum_{i = 1}^{T}(\mathrm{e}^{\frac{d_i}{a_2}} - 1) & d_i\geqslant 0 \end{array} \right. \tag{4}
$$

剩余寿命预测模型  $(F)$  可实现性能参数源域向预测寿命值目标域之间的映射，如图3所示。发动机性能参数来源使其数据源域参数具有纵向列内时序性和横向列间相关性，因此若使RMSE取得极小值，则可以通过对源域补充与寿命真实值强相关标识列加以改善特征提取效果。设相关性系数矩阵为  $W$  ，满足式（5）；源域中取  $m$  个寿命强相关列，按式（6)计算标识列，实现源域增维，

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/2003e13f9be0867c6f85317ad5f615421bf5876fa0199cbed0b265f2b9a6cead.jpg)  
图2超前预测分值误差函数图[16] Fig.2 Score error function diagram[16]

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/8efded449ab0f827e6662c39b41ab210ab206e243d1c83c59e4761d1faac4cea.jpg)  
图3 演域目标域映射关系图 Fig.3 Source domain target domain mapping relationship diagram

得到  $X_{1}$  如式（7）所示。

$$
Y = WX_{1} \tag{5}
$$

$$
x_{t}^{n + l} = \sum_{i = 1}^{m} \omega x_{t}^{i} \tag{6}
$$

$$
X_{1} = \left[ \begin{array}{cccccccccc}x_{1}^{1} & x_{1}^{2} & \dots & x_{1}^{k - 1} & x_{1}^{k} & \dots & x_{1}^{n} & \dots & x_{1}^{n + l}\\ x_{2}^{1} & x_{2}^{2} & \dots & x_{2}^{k - 1} & x_{2}^{k} & \dots & x_{2}^{n} & \dots & x_{2}^{n + l}\\ \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ x_{1}^{1} & x_{1}^{2} & \dots & x_{1}^{k - 1} & x_{1}^{k} & \dots & x_{1}^{n} & \dots & x_{1}^{n + l}\\ \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ x_{T}^{1} & x_{T}^{2} & \dots & x_{T}^{k - 1} & x_{T}^{k} & \dots & x_{T}^{n} & \dots & x_{T}^{n + l} \end{array} \right] \tag{7}
$$

上述分析表明，构建回归预测  $F$  模型的关键在于源域的扩增方式和时间步长权重的优化。需要重点解决3个方面问题。首先是满足精度达标基础上，提高超前预测效果，其次是选择合理的标识列数  $(l)$ ，并优化寿命强相关列的权重矩阵  $(W)$ ，最后是改善由于维度扩增导致的运算量增大，防止模型过拟合，从而提高模型泛化性。

# 2 剩余寿命预测模型构建

# 2.1 GRU结构

对于长序列数据的输入，为了提高模型预测效果，常采用循环神经网络(RNN)实现，但RNN会导致梯度消失。门控循环单元（GRU)在RNN中加入更新门和重置门，如图4所示。GRU能够实现对长数据序列的输入更新，并缓解梯度消失。

如前所述，设  $x^{k}$  为一台发动机  $t$  时刻第  $k$  维性能参数的输入，则模型结构中的更新门  $z_{i}$  、重置门  $r_{i}$  、隐藏层  $h$  等参数的计算，如式（8）～式（11）所示。

$$
z_{t}^{k} = \sigma (W_{z} * [h_{t - 1}^{k}, x_{t}^{k}]) \tag{8}
$$

$$
r_{t}^{k} = \sigma (W_{r} * [h_{t - 1}^{k}, x_{t}^{k}]) \tag{9}
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/872ba5d8f0ce1f60f885abf8a3529d86811ea27638f52ae9bc7c74c3ea0c3905.jpg)  
图4 GRU结构图 Fig.4 GRU structure diagram

$$
\tilde{h}_{t}^{k} = \tanh \left(W_{\tilde{h}} * [r_{t}^{k} \cdot h_{t - 1}^{k}, x_{t}^{k}]\right) \tag{10}
$$

$$
h_{t}^{k} = (1 - z_{t}) \cdot h_{t - 1}^{k} + z_{t}^{k} \cdot \tilde{h}_{t}^{k} \tag{11}
$$

其中  $h_{t - 1}^{k}$ $h_{t}^{k}$  分别代表第  $t - 1$  时刻、  $t$  时刻的第  $k$  维性能参数输入GRU时的隐藏层状态；更新门  $z_{t}$  用于控制  $t - 1$  时刻的状态信息更新至  $t$  时刻的数量；重置门  $r_{t}$  控制  $t - 1$  时刻的状态信息被传入  $t$  时刻候选集  $\tilde{h}_{t}^{k}$  的数量。  $\sigma$  为sigmoid激活函数，  $W$  为训练时不断更新的权重和偏置矩阵，“\*”表示矩阵的乘积，“\*”代表点乘（相应位置的元素乘相应位置的元素），“tanh”代表双曲正切激活函数。将GRU结构用于发动机剩余寿命预测时，由于更新门和重置门的设置均与前一时刻、当前时刻的隐藏层相关，因而有利于提取发动机性能参数退化信息，但对性能参数特征信息的提取效果仍需改进。

# 2.2 引入自注意力改进模型

为了提高模型对特征信息的关注，本文引入自注意力机制改进GRU结构。自注意力机制是注意力机制的一种变体，是将单个序列的不同位置形成关联的注意力机制，即利用特征列之间的互相关性为不同时间步长  $(x_{t - 1}^{k} \rightarrow x_{t}^{k})$  特征分配权重。改进后的模型为卷积神经网络（CNN）、门控循环单元（GRU）以及自注意力（self- attention）机制融合模型。卷积结构（CNN）用于对数据集中的全部性能参数，实现特征提取。GRU结构用于获取时间步长内时序依赖信息。由于前一时刻时间步长的特征对于当前时刻的时间步长的寿命预测的贡献不同，因此后续加入自注意力（self- attention）进行时间步长权重优化，为性能参数中不同时间步长包含的特征动态分布权重，确定不同时间步长对剩余寿命（RUL）的重要性，使得模型能够优化特征提取效果，并提高长期记忆能力。模型结构如图5所示。模型中一维卷积中的卷积核尺寸设置为  $2 \times 1$ ，步长为1，GRU的隐藏神经元个数设置为50。

GRU结构在第  $k$  维性能参数的所有时刻的输出构成隐藏状态集合  $H_{t}^{k}$ ，见式（12）。

$$
H_{t}^{k} = \{h_{1}^{k}, h_{2}^{k}, \dots , h_{t}^{k}\} \tag{12}
$$

隐藏状态集合  $H_{t}^{k}$  经由线性变换映射到自注意力机制中  $Q, K$  和  $V$  这3个向量。由softmax（·）函数归一化  $S$  矩阵计算每维性能参数所表示的时间序列中两个时间步长之间的相关性。利用  $S$  矩阵，得到性能参数时间序列中每个时间步长对剩余寿命（RUL）的重要性的权重。最后通过加权求

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/682bced015c25352ef84775b04f5a776128142f676239b90ad4dd96e9d1c5561.jpg)  
图5 模型结构图 Fig.5 Model structure diagram

和得到自注意力层在处理第  $k$  维性能参数输出的特征矩阵  $A_{\mathrm{attention}}$  。所述计算过程如下：

$$
\begin{array}{l}\pmb {Q}^k = \pmb {H}_t\cdot \pmb {W}^{2k}\\ \pmb {K}^k = \pmb {H}_t\cdot \pmb {W}^{kk}\\ \pmb {V}^k = \pmb {H}_t\cdot \pmb {W}^{Vk} \end{array} \tag{14}
$$

$$
S(Q,K) = \frac{Q\cdot K^T}{\sqrt{d_k}} \tag{16}
$$

$$
A_{\mathrm{attention}}^k = \mathrm{softmax}[S(Q^k,K^k)]V^k \tag{17}
$$

式中  $Q^{k},K^{k},V^{k}$  表示自注意力层的输入，  $W^{Qk}$ $W^{Kk}$  和  $W^{Vk}$  分别表示在第  $k$  维性能参数中的权重矩阵， $d_{k}$  为  $Q^{k}$ $K^{k}$ $V^{k}$  的维数。

# 2.3 标识列数据增维

为了提高寿命预测模型预测效果，利用相关性分析与主成分分析法确定列间相关性并增加寿命强相关列。本文所采用的数据集为NASA公开的发动机寿命预测数据集  $\mathbb{C}$  (C- MAPSS)，如表1所示，数据集为4组（FD001～FD004），分别记录多台涡轮发动机在不同运行工况和故障类型下寿命时间范围内获取的20维数据，其中21维代表发动机性能参数值（见表2），3维代表发动机运行时所处的运行工况[16]。按照发动机运行性能参数涉及的物理量，数据大致可以分为温度、压强、转速和流量这4类。

分析可知，发动机的性能参数维能够表征发动机寿命，且寿命真实值与其他21维性能参数均具有相关性。因此，可以通过对源域补充与寿命真实值强相关标识列提高预测精度。性能参数根据其物理意义可被分为4类，即温度、压强、转速和流量。若根据上述4类性能参数与剩余寿命的

表1数据集（FD001～FD004）信息 Table 1 Information of data set (FD001—FD004)  

<table><tr><td rowspan="2">参数</td><td colspan="4">数据集</td></tr><tr><td>FD001</td><td>FD002</td><td>FD003</td><td>FD004</td></tr><tr><td>训练发动机单元个数</td><td>100</td><td>260</td><td>100</td><td>249</td></tr><tr><td>测试发动机单元个数</td><td>100</td><td>259</td><td>100</td><td>248</td></tr><tr><td>运行工况个数</td><td>1</td><td>6</td><td>1</td><td>6</td></tr><tr><td>故障模式个数</td><td>1</td><td>1</td><td>2</td><td>2</td></tr></table>

# 表2 性能参数信息

Table 2 Performance parameter information  

<table><tr><td>序号</td><td>物理描述</td><td>单位</td></tr><tr><td>1</td><td>风扇入口温度</td><td>K</td></tr><tr><td>2</td><td>低压压缩机出口温度</td><td>K</td></tr><tr><td>3</td><td>高压压缩机出口温度</td><td>K</td></tr><tr><td>4</td><td>低压涡轮出口温度</td><td>K</td></tr><tr><td>5</td><td>风扇进口压强</td><td>kPa</td></tr><tr><td>6</td><td>外涵道压强</td><td>kPa</td></tr><tr><td>7</td><td>高压压缩机出口压强</td><td>kPa</td></tr><tr><td>8</td><td>实际风扇转速</td><td>r/min</td></tr><tr><td>9</td><td>实际核心轴速度</td><td>r/min</td></tr><tr><td>10</td><td>发动机压强比</td><td></td></tr><tr><td>11</td><td>高压压缩机出口静压</td><td>Pa</td></tr><tr><td>13</td><td>风扇修正转速</td><td>r/min</td></tr><tr><td>14</td><td>修正转速</td><td>r/min</td></tr><tr><td>15</td><td>涵道比</td><td></td></tr><tr><td>16</td><td>燃烧室油气比</td><td></td></tr><tr><td>17</td><td>抽气焓</td><td></td></tr><tr><td>18</td><td>风扇转速</td><td>r/min</td></tr><tr><td>19</td><td>风扇修正转速</td><td>r/min</td></tr><tr><td>20</td><td>高压涡轮冷气流量</td><td>m³/s</td></tr><tr><td>21</td><td>低压涡轮冷气流量</td><td>m³/s</td></tr></table>

相关性进行多列增维，会导致参数增多以及训练时间成本增加。因此本文从4类性能参数中选择

每一类中与寿命相关性最强的一列进行标识列增维操作。图6表示发动机性能参数与寿命之间的相关性。每一类中的寿命强相关列分别是高压压缩机出口总温度、发动机压力比、风扇转速和高压涡轮冷却排气量，利用主成分分析法计算四列性能参数相应的权重  $\omega_{\mathrm{i}}$  ，通过计算标识列在不同时刻的值，得到一列寿命强相关列，实现标识列数据增维。

由表1可知，4组发动机数据集（FD001～FD004)的工况与故障模式均不一致，为了提升模型的泛化性与鲁棒性，可将4组训练集合并训练，从而得到一个适用于4组测试集的模型。此外，

深度学习模型的性能提升在一定程度上取决于数据集的规模，而源域参数具有纵向时序性，因此增加样本量（发动机台数)也有助于模型进一步学习时序序列的特征，从而提升模型的预测精确性。基于上述考虑，本文将4组训练集合并训练，再利用4组测试集分别测试预测效果。

通过对发动机数据集中各维性能参数的退化过程实验发现，发动机在剩余寿命充足的运行初期时运行状态较为稳定，可以认为此阶段的发动机的RUL保持恒定[17- 18]，但当剩余寿命减少、进入寿命运行后期时，发动机的性能会随着时间的增加而急剧下降，如图7所示。若直接使用线性

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/b4eb0fe95e58bf3b7ef119ceb75a5d6144a3d12e79f435db7105e4fd038e71cb.jpg)  
性能参数相关性系数图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/86cbb2a4a13f7788dc80477945e4c09da16710a2816b95e0f9ccee923e677add.jpg)  
图6合并训练集与寿命相关性分析图 Fig.6 Merged training set and lifetime correlation analysis graph

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/5898cce54889c2284070fb6efc994954fc6cfcf2b5a025549a2515a33a115afc.jpg)  
图7 FD001训练集部分性能参数图

退化曲线，即每台发动机总运行时间减去当前运行时间得到的数据集的RUL标签作为目标函数，则会增加RUL预测结果的滞后性[19]。因此本文采用分段线性函数处理数据集，当发动机初期处于健康状态，其RUL值是恒定的，拐点后使用线性递减的RUL。分段线性目标函数如图8所示。研究表明，将数据集RUL标签分段值设置为第130个运行周期预测效果较好[20]。在本文中设定的发动机剩余寿命  $Y_{\mathrm{piecewise}}$  如式（18）所示。

$$
Y_{\mathrm{piecewise}} = \left\{ \begin{array}{ll}Y(Y\leqslant R_{\mathrm{m}})\\ R_{\mathrm{m}}(Y > R_{\mathrm{m}}) \end{array} \right. \tag{18}
$$

其中  $R_{\mathrm{m}}$  是分段值，实验中设置为130。

综上所述，本文发动机剩余寿命预测模型的构建分为3个阶段：数据预处理、模型建立和模型训练及测试，如图9所示。在数据预处理阶段，归一化原始数据、设置分段线性标签以及处理标识列增维；模型建立阶段重点解决输入层、神经网络层、拼接层和全连接层的网络结构设计；模型训练及测试阶段重点选择合适的超参数和优化方法，并评估模型在测试集上的性能，最终得到预测结果。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/82d97239ad564607d5bbfa1bac48cef217710bef37ad05c32579d626bbca3795.jpg)  
图8修正目标函数分段退化

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/0d2376c549b7134022585e0f7421439f487587b8433cedf60213a21c680e6c5d.jpg)  
Fig.7 Graph of some performance parameters of FD001 training set  图9发动机剩余寿命预测模型 Fig.9 Remaining engine life prediction model

# 3 实验及结果分析

Fig.8 Modified objective function segmental degradation curve

本文实验基于Python3.8解释器，Keras2.4.3API和Tensorflow2.3.1深度学习框架。实验数据集选

用前述C- MAPSS数据集。针对数据集4个子集 $\mathrm{(FD001\sim FD004)}$ ，为了使构建的预测模型能够适应不同的运行工况与故障模式，本文对4个子集的训练集进行了合并训练和数据标识列增维处理。将4组数据集的训练集合并为1组，并将3列运行工况数据与22维性能参数数据共同作为25维数据输入，从而消除复杂工况的不利影响。与原始分组训练集相比，本文实验数据集的训练集规模由  $160359\times 25$  扩增为  $160359\times 26$ 。

# 3.1 实验结果

为了减少数据集各维性能参数之间由于量纲和取值的范围不同所引起的偏差，本文采用Min- Max数据标准化方法对训练集和测试集的数据进行归一化。具体如式（19）所示。

$$
x_{t}^{k} = \frac{x_{t}^{k} - \min \left(x^{k}\right)}{\max \left(x^{k}\right) - \min \left(x^{k}\right)} \tag{19}
$$

式中  $x_{t}^{k}$  为发动机数据经过归一化处理后的第  $k$  维性能参数在第  $t$  时刻中的值。  $x_{t}^{k}$  为第  $k$  维性能参数在第  $t$  时刻中的值，  $\min (x^{k})$  和  $\max (x^{k})$  分别为第  $k$  维性能参数的最小值和最大值。数据集经过归一化处理后的数据范围为  $0,1]$ 。

为了验证模型性能，本文对C- MAPSS数据集进行了两类实验。实验1采用合并训练集进行训练；实验2采用4组训练集分别训练。在两类实验中，均采用4组测试集来独立测试。两类实验的训练收敛效果如图10所示。实验1迭代10个轮次，实验2迭代6个轮次，训练集的损失值与验证集的损失值均逐步下降最后趋于稳定，最终达到收敛。实验结果如表3所示。

由表3可知，实验1（合并训练）的预测效果在RMSE指标和超前预测分值指标均优于实验2（分组训练）的预测结果。说明合并数据集，增大了样本量，有助于消除工况产生的不良影响、提

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/eed8a07b1734e8af0727110c31d066eaf65c0a5962b3c368090794b709200250.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/56b8e7bfc63002acf1f36d2c6a77f652a8a6bedf142a1aefc36160faca886935.jpg)  
图10实验1与实验2的训练收敛效果 Fig.10 Training convergence effect of experiment 1 and experiment 2

# 表3两类实验在4组测试样本中的RMSE和超前预测分值

# 结果

Table 3 RMSE and score results for the two types of experiments in the four test groups  

<table><tr><td rowspan="2">测试数据集</td><td colspan="2">实验1
(合并训练结果)</td><td colspan="2">实验2
(分组训练结果)</td></tr><tr><td>ERMSE</td><td>Vscore</td><td>ERMSE</td><td>Vscore</td></tr><tr><td>FD001</td><td>10.52</td><td>48.69</td><td>12.40</td><td>56.22</td></tr><tr><td>FD002</td><td>14.83</td><td>149.26</td><td>20.28</td><td>458.84</td></tr><tr><td>FD003</td><td>10.91</td><td>49.99</td><td>12.97</td><td>190.04</td></tr><tr><td>FD004</td><td>18.91</td><td>204.98</td><td>22.88</td><td>508.60</td></tr></table>

高预测的准确性。从4个数据子集（FD001～FD004）测试样本中各随机选择一台发动机，剩余寿命预测曲线见图11。可以看出，模型能够预测出退化拐点和线性退化趋势。

# 3.2 消融实验

为了验证自注意力机制、CNN- GRU融合模型及本文模型（增维前）的性能，将单个GRU模型、CNN- GRU模型、本文模型（增维前）与本文构建的模型进行对比，实验预测结果如表4所示。通过比较计算可得，在4个数据集子集中，本文所提出模型均比GRU与CNN- GRU模型的RUL预测效果好。在工况与故障模式最复杂的FD004中，本文所提模型比单个GRU模型的RMSE、超前预测分值分别提高了  $16.65\%$ 、 $68.27\%$ ，比CNN- GRU模型的RMSE、超前预测分值分别提高了  $18.87\%$ 、 $53.93\%$ ，比本文模型（增维前）的RMSE、超前预测分值分别提高了  $17.02\%$ 、 $53.01\%$ 。因此，将CNN和self- attention引入GRU模型，并增加标识列，能够有效提高剩余寿命（RUL）预测准确率，并且

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/bcd3e490-15fb-41b1-9dad-3d7428adf992/cf2c8df734c93d76f19ffd37619b9f24ef077491b71e016df6e583a7a98b9649.jpg)  
图11 实验1对4组测试样本中任一发动机的预测情况 Fig.11 Prediction of experimental 1 on any engine of 4 groups test samples

# 表4 C-MAPSS数据集消融实验结果对比

Table 4 Comparison of ablation experimental results of C-MAPSS dataset  

<table><tr><td rowspan="2">模型</td><td colspan="4">ERMSE</td><td colspan="4">Vscore</td></tr><tr><td>FD001</td><td>FD002</td><td>FD003</td><td>FD004</td><td>FD001</td><td>FD002</td><td>FD003</td><td>FD004</td></tr><tr><td>GRU</td><td>20.87</td><td>22.13</td><td>18.16</td><td>22.69</td><td>223.24</td><td>672.43</td><td>284.66</td><td>646.18</td></tr><tr><td>CNN-GRU</td><td>12.52</td><td>17.46</td><td>14.34</td><td>23.31</td><td>50.58</td><td>157.91</td><td>134.44</td><td>444.95</td></tr><tr><td>本文模型</td><td>10.52</td><td>14.83</td><td>10.91</td><td>18.91</td><td>48.69</td><td>149.26</td><td>49.99</td><td>204.98</td></tr></table>

实现超前预测。

# 3.3对比实验

选择本文方法、RNN Auto- Encoder[21]、Multi- Head CNN- LSTM[22]、TCAN[23]的实验结果进行对比。实验结果见表5。本文方法所得到的RMSE在4组数据集测试集上均优于其他方法。其中FD001中RMSE最低为10.52，比RNN Auto- En

coder[21]、Multi- Head CNN- LSTM[22]、TCAN[23]这3种方法分别减少了  $26.08\%$  、  $18.39\%$  、  $9.6\%$  ，在FD004中最高为18.91，比上述3种方法分别减少了  $14.62\%$  、  $17.38\%$  、  $1.35\%$  。此外，本文的超前预测分值范围在[48.69,204.98]，相比其他3种方法也大幅降低，且本文提出的模型能够实现超前预测。

表5C-MAPSS数据集不同方法下的RMSE与超前预测分值结果对比

Table 5 Comparison of RMSE and score results of C-MAPSS dataset under different methods  

<table><tr><td rowspan="2">方法</td><td colspan="2">FD001</td><td colspan="2">FD002</td><td colspan="2">FD003</td><td colspan="2">FD004</td></tr><tr><td>ERMSE</td><td>Vscore</td><td>ERMSE</td><td>Vscore</td><td>ERMSE</td><td>Vscore</td><td>ERMSE</td><td>Vscore</td></tr><tr><td>AutoEncoder[17]</td><td>13.58</td><td>220</td><td>19.59</td><td>2 650</td><td>19.16</td><td>1 727</td><td>22.15</td><td>2 901</td></tr><tr><td>Multi-Head CNN-LSTM[22]</td><td>12.19</td><td>330</td><td>19.93</td><td>2 880</td><td>12.85</td><td>401</td><td>22.89</td><td>6 520</td></tr><tr><td>TCAN[19]</td><td>11.64</td><td>230.22</td><td>17.21</td><td>2 283.52</td><td>11.90</td><td>2 901</td><td>19.17</td><td>2 510.34</td></tr><tr><td>本文方法(合并训练)</td><td>10.52</td><td>48.69</td><td>14.83</td><td>149.26</td><td>10.91</td><td>49.99</td><td>18.91</td><td>204.98</td></tr></table>

# 4结论

本文针对传统方法在航空发动机剩余寿命预测精度较低的问题，提出一种基于改进GRU的航空发动机寿命预测自注意力优化算法，并得出如下结论：

1）通过分析多维性能参数的物理意义，利用相关性分析与主成分分析法进行源域增维，能够提高预测精度。

2）采用CNN结构提取多维性能参数的退化特征，GRU结构学习时间序列之间的时序关系，再利用自注意力机制为特征信息合理分配权重，能够有效提升发动机剩余寿命预测精度。

3）通过实验表明该模型对于具有长时间序列和多状态参数的航空发动机剩余寿命预测具有良好的泛化性和较高的预测精度，且对比其他文献方法具有一定优势，但超前预测存在一定的误差，后续将对此做进一步研究。

# 参考文献：

[1] CHEN Zhenghua, WU Min, ZHAO Rui, et al. Machine remaining useful life prediction via an attention- based deep learning approach [J]. IEEE Transactions on Industrial Electronics, 2021, 68(3): 2521- 2531. [2] 梁伟阁，张钢，王健，等.复杂机械设备健康状态预测方法研究综述[J].兵器装备工程学报，2022,43(7):67- 77. LIANG Weige, ZHANG Gang, WANG Jian, et al. A review on health state assessment and remaining useful life prediction of mechanical equipment under intelligent manufacturing[J]. Journal of Ordnance Equipment Engineering, 2022, 43(7): 67- 77. (in Chinese)[3] LIAO Guobo, YIN Hongpeng, CHEN Min, et al. Remaining useful life prediction for multi- phase deteriorating process based on Wiener process[J]. Reliability Engineering and System Safety, 2021, 207: 107361. [4] LIU He, SONG Wanqing, NIU Yuhui, et al. A generalized cauchy method for remaining useful life prediction of wind turbine gearboxes[J]. Mechanical Systems and Signal Processing, 2021, 153: 107471. [5] 裴洪，胡昌华，司小胜，等.基于机器学习的设备剩余寿命预测方法综述[J].机械工程学报，2019,55(8):1- 13. PEI Hong, HU Changhua, SI Xiaosheng, et al. Review of machine learning based remaining useful life prediction methods for equipment[J]. Journal of Mechanical Engineering, 2019, 55(8): 1- 13. (in Chinese)[6] 黄亮，刘君强，贡英杰.基于Wiener过程的发动机多阶段剩余寿命预测[J].北京航空航天大学学报，2018,44(5):1081- 1087. HUANG Liang, LIU Junqiang, GONG Yingjie. Multi- phase residual life prediction of engines based on Wiener process[J]. Journal of Beijing University of Aeronautics and Astronautics, 2018, 44(5): 1081- 1087. (in Chinese)[7] DU Jingcai, ZHANG Weige, ZHANG Caiqing, et al. Battery re

maining useful life prediction under coupling stress based on support vector regression[J]. Energy Procedia, 2018, 152: 538- 543. [8] ORDNEZ C, LASHERAS F S, ROCA- PARDINAS J, et al. A hybrid ARIMA- SVM model for the study of the remaining useful life of aircraft engines[J]. Journal of Computational and Applied Mathematics, 2019, 346: 184- 191. [9] KHAN S, YAIRI T. A review on the application of deep learning in system health management[J]. Mechanical Systems and Signal Processing, 2018, 107: 241- 265. [10] BEJAOUI I, BRUNEO D, XIBILIA M G. Remaining useful life prediction of broken rotor bar based on data- driven and degradation model[J]. Applied Sciences, 2021, 11(16): 7175. [11] HOCHREITER S, SCHMIDHUBER J. Long short- term memory[J]. Neural Computation, 1997, 9(8): 1735- 1780. [12] CHUNG J, GULCEHRE C, CHO K H, et al. Empirical evaluation of gated recurrent neural networks on sequence modeling[EB/OL]. (2014- 12- 11) [2022- 11- 02]. https://doi.org/10.48550/arXiv.1412.3555. [13] ZHANG Xinyun, DONG Yan, WEN Long, et al. Remaining useful life estimation based on a new convolutional and recurrent neural network[C]//Proceedings of IEEE 15th International Conference on Automation Science and Engineering. Piscataway, US: IEEE, 2019: 317- 322. [14] LI Li, ZHAO Zhen, ZHAO Xiaoxiao, et al. Gated recurrent unit networks for remaining useful life prediction[J]. IFAC- PapersOn- Line, 2020, 53(2): 10498- 10504. [15] 陈保家，郭凯敏，陈法法，等.基于残差NLSTM和注意力机制的航空发动机剩余寿命预测[J].航空动力学报，2023, 38(5):1176- 1184. CHEN Baojia, GUO Kaimin, CHEN Fafa, et al. Residual life prediction of aero engines based on residual NLSTM and attention mechanism[J]. Journal of Aerospace Power, 2023, 38(5): 1176- 1184. (in Chinese)[16] SAXENA A, GOEBE B, K, SIMON D, et al. Damage propagation modeling for aircraft engine run- to- failure simulation[C]//Proceedings of 2008 International Conference on Prognostics and Health Management. Piscataway, US: IEEE, 2008: 1- 9. [17] XIA Jun, FENG Yunwen, LU Cheng, et al. LSTM- based multilayer self- attention method for remaining useful life estimation of mechanical systems[J]. Engineering Failure Analysis, 2021, 125: 105385. [18] 郭晓静，殷宇萱，.负压悬于改进LSTM的航空发动机寿命预测方法研究[J].机床与液压，2022, 50(20):185- 193. GUO Xiaojing, YIN Yuxuan, YUN Yujing. Aeroengine life prediction method based on improved LSTM[J]. Machine Tool and Hydraulics, 2022, 50(20): 185- 193. (in Chinese)[19] 许昱晖，舒俊清，宋亚，等.基于多时间尺度相似性的涡扇发动机寿命预测[J].浙江大学学报（工学版），2021, 55(10): 1937- 1947. XU Yuhui, SHU Junqing, SONG Ya, et al. Remaining useful life prediction of turbofan engine based on similarity in multiple time scales[J]. Journal of Zhejiang University (Engineering Science), 2021, 55(10): 1937- 1947. (in Chinese)[20] HEIMES F O. Recurrent neural networks for remaining useful life estimation[C]//Proceedings of 2008 International Conference on Prognostics and Health Management. Piscataway, US: IEEE, 2008: 59- 65. [21] YU Wennian, KIM I Y, MECHEFSKE C. An improved similarity- based prognostic algorithm for RUL estimation using an RNN au-

toencoder scheme[J]. Reliability Engineering and System Safety, 2020, 199: 106926. [22] MO H, LUCCA F, MALACARNI J, et al. Multi- head CNN- LSTM with prediction error analysis for remaining useful life prediction[C]//Proceedings of the 27th Conference of Open Innovations Association. Piscataway, US: IEEE, 2020: 164- 171.

[23] 刘丽, 裴行智, 雷雪梅. 基于时间卷积注意力网络的剩余寿命预测方法[J]. 计算机集成制造系统, 2022, 28(8): 2375- 2386. LIU Li, PEI Xingzhi, LEI Xuemei. Temporal convolutional attention network for remaining useful life estimation[J]. Computer Integrated Manufacturing Systems, 2022, 28(8): 2375- 2386. (in Chinese)

（编辑：王碧珺）