摘要：故障状态类型的判别是航空装备故障预测系统的核心环节，它直接影响到故障预测的准确性；针对航空装备的故障状态类型判别问题，提出一种基于马氏距离的故障预测方法；首先介绍了马氏距离，其次建立了状态数据库矩阵及状态判别模型，并给出了基于马氏距离的故障预测流程；最后将该方法用于某型飞机火控系统的故障预测中，使得在线和离线的平均故障预测准确度分别达到98.48%和97.77%，表明马氏距离在航空装备的故障预测中有较好的应用和推广价值。

关键词：马氏距离；航空装备；故障预测



# 0 引言

航空装备故障预测是指基于特征预测信息，对航空装备部件或系统进行准确的剩余寿命预测，并对可能发生的故障作出预先诊断的方法。它是PHM（Prognostics and Health Management）技术在航空领域的重要应用，在提高装备的可利用率和可维护性、延长装备的寿命等方面具有很高的军事应用价值。航空装备故障预测系统的基本过程包括信息提取与处理、状态类型判别以及故障预测与诊断决策。其中，状态类型的判别是故障预测的核心环节，它直接影响预测的准确度，常用的判别方法有时域分析法、模式识别法及统计分析法等。

马氏距离是统计学中两组样本集数据之间的协方差，它代表了两个样本集之间的相似度[3- 5]。由于马氏距离可以消除量纲的影响，并且综合考虑了各种特性之间的联系，在状态类型的判别方面具有特征分析全面、准确度高等优势，适合应用于多故障模式的故障预测研究中。

# 1 马氏距离

假设两个变量  $X$  和  $Y$  的取值分别为  $x_{1},x_{2},\dots ,x_{n}$  和  $y_{1},y_{2},\dots ,y_{n}$  ，那么  $X$  和  $Y$  之间的样本协方差被定义为：

$$
\frac{1}{n}\sum_{i = 1}^{n}(x_{i} - \bar{x})(y_{i} - \bar{y})
$$

其中：  $\bar{X} = \sum_{i = 1}^{n}X_{i},\bar{Y} = \sum_{i = 1}^{n}Y_{i}$

对于  $P$  个变量，可以建立  $p\times p$  维的协方差矩阵，同时为了消除协方差受  $X$  和  $Y$  取值范围的约束，通过标准化的方法可以得到  $X$  和  $Y$  间的样本相关系数：

$$
\frac{\sum_{i = 1}^{n}(x_{i} - \bar{x})(y_{i} - \bar{y})}{\left(\sum_{i = 1}^{n}(x_{i} - \bar{x})^{2}\sum_{i = 1}^{n}(y_{i} - \bar{y})^{2}\right)^{\frac{1}{2}}}
$$

由此可以得到两个  $p$  维测量值  $x_{i}$  和  $y_{i}$  之间的马氏距离，定义如下：

$$
d_{MH}(i,j) = ((x_{i} - y_{j})^{\prime}\sum^{-1}(x_{i} - y_{j}))^{\frac{1}{2}} \tag{1}
$$

其中：  $(x_{i} - y_{j})^{\prime}$  表示矩阵  $(x_{i} - y_{j})$  的转置，  $\sum^{- 1}$  为相关系数矩阵。  $d_{MH}(i,j)$  值越小，表示测量值  $x_{i}$  与  $y_{j}$  之间的相似度越高。

# 2 基于马氏距离的故障预测模型

# 2.1 建立装备状态数据库矩阵

假设复杂装备系统的历史数据类有  $n$  组，称之为样品，并且每个样品测得指标个数为  $p$  个，则原始数据可用一个属性矩阵表示：

$$
\begin{array}{r}\mathbf{X}_{1} \begin{array}{c}x_{11} \end{array} \begin{array}{c}x_{12} \end{array} \begin{array}{c}\dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \dots \\ \end{array} \end{array} \tag{2}
$$

同时，装备系统的历史检测数据中还存在有  $m$  组正常运行情况下的状态数据，其属性矩阵为：

$$
\begin{array}{r}Y_{1} \\ Y_{T} = \begin{array}{c}Y_{1} \\ Y_{2} \\ \vdots \\ Y_{m} \end{array} \left[ \begin{array}{cccc}y_{11} & y_{12} & \dots & y_{1p} \\ y_{21} & y_{22} & \dots & y_{2p} \\ \vdots & \vdots & \dots & \vdots \\ y_{m1} & y_{m2} & L & y_{mp} \end{array} \right] \quad (j = 1,2,\dots ,p) \end{array} \tag{3}
$$

在工程应用中，影响系统状态的各指标的量纲并不是统一的，为了消除量纲不统一给数据处理带来的不利影响，还需要对上述数据进行标准化处理。首先，利用式（2）中的正常状态数据求得各个指标测量值的均值：

$$
\bar{y}_{j} = \frac{1}{m} \sum_{p = 1}^{m} y_{ij} (j = 1,2,\dots ,p) \tag{4}
$$

对于故障状态下的数据，就可以利用各指标测量值偏离正常状态的程度来刻画各故障的具体情况，即：

$$
x^{\prime}_{ij} = \frac{x_{ij} - y_{j}}{y_{j}}, (i = 1,2,\dots ,n; j = 1,2,\dots ,p) \tag{5}
$$

由于式（5）消除了各指标的量纲，实现了量纲的归一化，因此，原始数据的状态矩阵式（2）可以表示成式（6）的形式：

$$
\begin{array}{r}X_{1} \begin{array}{cccc}x^{\prime}_{11} & x^{\prime}_{12} & \dots & x^{\prime}_{1p} \\ x^{\prime}_{21} & x^{\prime}_{22} & \dots & x^{\prime}_{2p} \\ \vdots & \vdots & \vdots & \vdots \\ x_{n1}^{\prime} & x_{n2}^{\prime} & \dots & x_{np}^{\prime} \end{array} \end{array} \tag{6}
$$

通过以上处理，定义第  $i$  个样品和第  $j$  个样品间的相关系数为：

$$
r_{ij} = \frac{\sum_{k = 1}^{p} (x_{jk}^{\prime} - \overline{x^{\prime}}_{i}) (x_{jk}^{\prime} - \overline{x^{\prime}}_{j})}{\sqrt{\sum_{k = 1}^{p} (x_{jk}^{\prime} - \overline{x^{\prime}}_{i})^{2} \cdot \sum_{k = 1}^{p} (x_{jk}^{\prime} - \overline{x^{\prime}}_{j})^{2}}} \tag{7}
$$

其中：  $\overline{x^{\prime}}_{i} = \frac{1}{p} \sum_{k = 1}^{p} x_{jk}^{\prime}, \overline{x^{\prime}}_{j} = \frac{1}{p} \sum_{k = 1}^{p} x_{jk}^{\prime}, i = 1,2,\dots ,n; j = 1,2,\dots ,p$

所以，由式（7）得各样品之间的相关系数矩阵为：

$$
\mathbf{R} = (r_{ij})_{n \times n} = \left[ \begin{array}{cccc}1 & & & \\ r_{21} & 1 & & \\ \vdots & \vdots & \dots & \\ r_{n1} & r_{n2} & \dots & 1 \end{array} \right] \tag{8}
$$

由于式（8）的元素满足  $- 1 \leq r_{ij} \leq 1$ ，因此可以根据相关系数矩阵  $\mathbf{R}$  对  $n$  组观测值进行分类：  $r_{ij}$  越接近1，则两种状态越相似。再根据专家经验和历史故障数据分析确定出阈值  $\delta$  后，对装备的运行状态进行分类，得到  $m$  类装备的状态数据库矩阵  $[n - 7]$

$$
\begin{array}{r}X_{1} \\ X_{1} \\ X_{2} \\ \vdots \\ X_{m} \end{array} \left[ \begin{array}{cccc}x_{11}^{\prime} & x_{12}^{\prime} & \dots & x_{1p}^{\prime} \\ x_{21}^{\prime \prime} & x_{22}^{\prime \prime} & \dots & x_{2p}^{\prime \prime} \\ \vdots & \vdots & \dots & \vdots \\ x_{m1}^{\prime \prime} & x_{m2}^{\prime \prime} & \dots & x_{mp}^{\prime} \end{array} \right] \tag{9}
$$

# 2.2 建立故障规则知识库

通过对历史故障数据库的分析，可以确定出复杂装备的大部分故障模式，如表1所示。表中，故障状态下的数据均由故障数据的平均值经归一化处理后得到。因此，我们可以分别获得系统在正常状态下和故障状态下的属性矩阵，可以看作是一个案例库或故障规则知识库。

$$
X_{0} \begin{array}{cccc} \overline{x_{11}} & 0 & 0 & \dots & 0 \\ \overline{x_{11}} & \overline{x_{12}} & \dots & \overline{x_{1p}} \\ \vdots & \vdots & \dots & \vdots \\ \overline{x_{11}} & \overline{x_{12}} & \dots & \overline{x_{1p}} \\ \overline{x_{11}} & \overline{x_{12}} & \dots & \overline{x_{1p}} \end{array} \tag{10}
$$

其中，  $\overline{X}_{0}$  中的元素0表示系统正常运行情况下测量值偏离正常状态的程度为0。

# 2.3 状态判别模型的建立与算法的实现

基于故障规则知识库进行故障预测时，对于任意一次的在线检测或历史记录数据，若它与第  $i$  类故障模式的重心距离最近，则认为它最有可能发生第  $i$  类故障，需要先修正这类故障，如果没有故障就去修正与检测值距离次近的第  $j$  类故障，以此类推。显然，要预测可能发生的故障并给予及时维护，关键在于判别检测值  $\bar{X} = (\bar{x}_{1}, \bar{x}_{2}, \dots , \bar{x}_{n})^{\prime}$  最有可能属于的故障类别。为此，根据马氏距离的形式，定义复杂装备系统的状态趋势预测值与故障模式重心  $\bar{X}_{i} = (\bar{x_{i1}}, \bar{x_{i2}}, \dots , \bar{x_{in}})^{\prime}$  之间的马氏距离为：

$$
d_{MH}(\bar{X}, \bar{X}_{i}) = ((\bar{X} - \bar{X}_{i})^{\prime} \sum^{-1} (\bar{X} - \bar{X}_{i}))^{\frac{1}{2}} \tag{11}
$$

在实际工程应用时，每一个系统检测值通过归一化处理后，分别计算与复杂系统故障规则库中  $n$  类故障模式重心的马氏距离，然后进行大小排序，给出系统运行的分析报告。系统维护时先检测复杂系统是否存在  $d_{MH}(\bar{X}, \bar{X}_{i})$  最小的故障类，再依次从小到大检测，如果存在可能的故障就进行维护处理。

在复杂装备的故障诊断和预测过程中，在线故障预测与离线故障预测的处理方式略有不同。在线故障预测仅需测量一次实时数据，处理起来较简单，预测流程如图1所示。离线故障预测由于要处理系统运行与设备检测时记录的大量数据，处理起来相对复杂，预测流程如图2所示。

在线故障预测算法的实现流程如下所述。

第1步：利用统计学相关知识、专用设备检测诊断和专家分析，对系统历史数据及检测数据进行处理得到初始故障规则知识库  $\{\bar{X}_{0}, \bar{X}_{1}, \bar{X}_{2}, \dots , \bar{X}_{n}\}$ ，以矩阵的形式预存到计算机程序中；

第2步：利用式（5）对系统在线检测值进行归一化处理，消除系统状态重量纲不统一的影响；

第3步：根据式（11）计算在线检测值和各类故障重心的马氏距离，如果  $d_{MH}(\bar{X}, \bar{X}_{i}) = 0$ ，说明系统运行完全正常；如果

表1故障信息表  

<table><tr><td>故障现象</td><td>故障模式</td><td>故障状态数据</td><td>解决方案</td></tr><tr><td rowspan="2">故障现象1</td><td>故障模式1</td><td>对应故障状态下的数据 X1: x11, x12, …, x1p</td><td>对应解决方案1</td></tr><tr><td>故障模式2</td><td>对应故障状态下的数据 X2: x21, x22, …, x2p</td><td>对应解决方案2</td></tr><tr><td rowspan="3">故障现象2</td><td>故障模式3</td><td>对应故障状态下的数据 X3: x31, x32, …, x3p</td><td>对应解决方案3</td></tr><tr><td>故障模式4</td><td>对应故障状态下的数据 X4: x41, x42, …, x4p</td><td>对应解决方案4</td></tr><tr><td>…</td><td>……</td><td>……</td></tr><tr><td>…</td><td>…</td><td>……</td><td>……</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/9456ce10-221a-4c4e-952a-03d248780b77/8d34e5f2e302289d6931b8c9119a8a5153a4232e5f5a5d9fdf238605393baf62.jpg)  
图1在线故障预测流程图

$d_{MH}(\bar{X},\bar{X}_i) = 0(i = 1,2,\dots ,n)$ ，说明系统存在第  $i$  类故障，应按对应模式对系统进行排故维护；如果马氏距离以上两条均不满足，进入下一步；

第4步：如果  $d_{MH}(\bar{X},\bar{X}_0)\neq 0$ ，且  $d_{MH}(\bar{X},\bar{X}_0)\leq \delta$ ，则认为系统虽然运行正常，但此时系统性能已发生异常变化，系统可能在未来的某一时刻发生故障，进入第5步；如果  $d_{MH}(\bar{X},\bar{X}_0) > \delta$ ，说明系统存在未知模式故障，需要利用专用检测设备进行详细的检测确认，得到新的故障模式并充实故障规则知识库；

第5步：  $①$  对  $d_{MH}(\bar{X},\bar{X}_i)$  （其中  $i = 1,2,\dots ,n$  ）进行从小到大排序，给出分析报告（包括预测结果、维护方案等），先检测系统是否存在马氏距离最小的故障模式，再从小到大依次检测维护；  $②$  把归一化处理后的在线检测值添加到长期积累的状态预测数据库中，利用预测模型对系统的状态进行预测，给出预测结果和维护方案。

离线故障预测算法的实现流程如下所述。

第1步：对历史数据库中的所有检测值  $X_{i}$  进行初步处理，合并相同组得到初始数据库（2）；

第2步：利用式（5）对合并后的数据进行归一化处理，得到归一化数据库（6）；

第3步：利用式（7）计算归一化数据库（6）各类状态之间的相关系数，并进行聚类处理得到  $m$  类装备状态的数据库（9）；

第4步：根据公式（11）分别计算聚类数据库中各类检测值  $\bar{X}_j$  和故障规则知识库中各类故障重心的马氏距离，如果  $d_{MH}(\bar{X}_j,\bar{X}_0) = 0$ ，说明系统运行完全正常；如果  $d_{MH}(\bar{X}_j,\bar{X}_i) = 0(i = 1,2,\dots ,n)$ ，说明系统存在第  $i$  类故障，应按对应模式对系统进行排故维护；如果马氏距离以上两条均不满足，进入下一步；

第5步：如果  $d_{MH}(\bar{X}_j,\bar{X}_0)\neq 0$ ，且  $d_{MH}(\bar{X}_j,\bar{X}_0)\leq \delta$ ，则认为系统虽然正常运行，但此时系统性能已发生异常变化，系统可能在未来的某一时刻发生故障，进入下一步；如果

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/9456ce10-221a-4c4e-952a-03d248780b77/f1e7f2e5c0ba98f3368ae0b5644282a5204d71150d6b3f59cd9c8968507b80e1.jpg)  
图2离线故障预测流程图

$d_{MH}(\bar{X}_j,\bar{X}_0) > \delta$ ，说明系统存在未知模式故障，需要根据状态数据确认故障原因，或利用专用检测设备进行详细的检测确认，从而得到新的故障模式并充实故障规则知识库；

第6步  $①$  对  $d_{MH}(\bar{X}_j,\bar{X}_i)$  （其中  $i = 1,2,\dots ,n$  ）进行从小到大排序，给出分析报告（包括预测结果、维护方案等），先检测系统是否存在马氏距离最小的故障模式，再从小到大依次检测维护；  $②$  把归一化处理后的在线检测值添加到长期积累的状态预测数据库中，利用预测模型对系统的状态进行预测，给出预测结果和维护方案

# 3某型飞机火控系统故障预测应用

以某型飞机火控系统为研究对象，在真实工作环境的情况下，经人工故障设置（故障注入）后，采用基于马氏距离的故障预测方法进行500次故障预测实验。注入的故障模式有9种：  $X_{1}$  一天线故障、  $X_{2}$  一高频接收机故障、  $X_{3}$  一低频接收机故障、  $X_{4}$  一主控振荡器故障、  $X_{5}$  一发射机故障、  $X_{6}$  一同步器故障、  $X_{7}$  一变换部件故障、  $X_{8}$  一电源故障、  $X_{9}$  一计算机故障。

# 3.1在线故障预测

将系统运行时测得的实时数据利用式（5）归一化处理后，再根据式（11）计算在线检测值和各类故障重心的马氏距离  $d_{MH}(\bar{X}_j,\bar{X}_i)$ ，给出预测结果；实时观测系统的运行状态，并记录下各故障的故障模式；

# 3.2离线故障预测

对历史数据库中的所有检测值经合并相同组、归一化处理及聚类处理后，得到矩阵形式的装备状态的数据库（9），再根据公式（11）计算数据库矩阵（9）中各类检测值和故障重心的马氏距离  $d_{MH}(\bar{X}_j,\bar{X}_i)$ ，给出预测结果。

最后，整合实验数据，将每一故障模式发生的预测次数与实测次数进行比较，并分别计算出故障预测准确度，实验结果如表2所示。

（下转第2058页）

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/9456ce10-221a-4c4e-952a-03d248780b77/7ff212a3d77760b06193de541577860583a00465ffc6221bfc4cc86f809f54d3.jpg)  
图9 实验设备结构图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/9456ce10-221a-4c4e-952a-03d248780b77/0fc068422bf4faed2bcbb48de5ed62f14565341205e6a9e132a3402f52834a17.jpg)  
图10 实验误差图

本文系统测试准确性有很大提高，具有很高的实用价值。

# 5 结束语

氢气在空气中的爆炸极限浓度较低，易发生危险，针对传统的电化学传感器氢气检测中容易受到电磁干扰，浓度检测不准，容易引起爆炸的原因。设计并实现了基于声谐振频率驱动的氢气流量检测系统，通过检测不同浓度的氢气通过传感器后引起的传感器谐振频率的变化，进而测出氢气的浓度，系统基于S3C2410模块设计，设计了外围的信号调理电路，对芯片进行了Linux系统移植。实验证明，系统能在  $10\mathrm{~s~}$  内对超浓度的氢气流量监控报警，不同的交叉气体下系统的氢气流量检测准确度高达  $98\%$  ，具有很强的实用性。