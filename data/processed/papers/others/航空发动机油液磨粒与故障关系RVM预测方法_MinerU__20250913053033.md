摘要支持向量机方法应用于发动机油液磨粒与故障关系预测时，常出现稀疏性不强、计算量大、核函数必须满足Mercer条件等问题。针对这一问题，在原理介绍和推导的基础上，利用某型航空发动机滑油光谱分析得到的237组数据中的7种金属磨粒浓度及其对应的发动机工作状态，对相关向量机预测方法进行了检验。采用相关向量机、最小二乘支持向量机和反向传播神经网络方法，对发动机工作状态进行预测。结果表明，在同等条件下，与LSSVM和BP- NN相比，RVM拥有计算量较少、预测时间较短，精度较高等优势，可广泛应用于发动机油液磨粒分析与故障预测。

关键词 相关向量机；航空发动机；油液磨粒；故障预测DOI 10.3969/j.issn.1009- 3516.2014.04.005中图分类号 TP18 文献标志码 A 文章编号 1009- 3516(2014)04- 0017- 04

# Research and Application on A Predictable Method of the Relationships between Aero Engine Oil Wear Particle and Fault

WANG Jian $^{1}$ , LI Yan $^{1}$ , BAI Peng $^{1}$ , YANG Dong $^{2}$   (1. Science College, Air Force Engineering University, Xi'an 710051, China; 2. Unit 94020, Yinchuan, 750021, China)

由于发动机故障与监测参数之间的映射关系模糊，基于专家系统方法、D- S证据理论等发动机故障诊断方法被提出并应用。近年来，人工神经网络（Artificial Neural Network，ANN）在发动机故障预测方面应用广泛，较好解决了非线性问题。但是，其存在需要大量训练样本、过学习、收敛速度慢、易陷入局部极值等问题，影响了故障预测效果。支持向量机（Support Vector Machine，SVM）具有小样本、泛化能力强等优点，但同时存在稀疏性不强、计算量大、核函数必须满足Mercer条件等缺点，使得应用受到限制。

相关向量机（Relevance Vector Machine，RVM）是一种建立在SVM上的稀疏概率模型，其数学基础为贝叶斯学习理论。在同样的条件下，RVM比SVM和ANN的模型更简单，由于其核函数不需要满足Mercer条件，因而具有较好的泛化能力并成为机器学习研究的热点，得到了较好的应用。

# 1 RVM原理

# 1.1 基本理论

假设给定训练集为  $\{x_{i},t_{i}\}_{i = 1}^{N}$ ，其中  $\{x_{i}\}_{i = 1}^{N}$  为输入样本特征值，  $\{t_{i}\}_{i = 1}^{N}$  是对应的目标值，RVM的模型输出为：

$$
y(x,\pmb {\omega}) = \sum_{i = 1}^{N}\omega_{i}K(x,x_{i}) + \omega_{0} \tag{1}
$$

式中：  $\pmb {\omega} = (\omega_0,\ldots ,\omega_i)^{\mathrm{T}}$  为权值向量；  $K(x,x_{i})$  为核函数；  $N$  为训练样本总数。

设训练样本相互独立且含有均值为0、方差为 $\sigma^2$  的Gauss噪声  $\epsilon_{n}$ ，则整个数据集的似然函数为：

$$
p(t\mid \pmb {\omega},\sigma^2) = (2\pi \sigma^2)^{\frac{-N}{2}}\exp \left\{-\frac{\|\mathbf{\omega}\cdot\pmb{\Phi}\pmb{\omega}\|^2}{2\sigma^2}\right\} \tag{2}
$$

约束条件为：  $\begin{array}{rlr}{\pmb {\omega}} & = & {\left[\omega_1,\omega_2,\ldots ,\omega_n\right],\pmb {\Phi} =} \end{array}$ $\left[\sigma (x_{1}),\sigma (x_{2}),\ldots ,\sigma (x_{N})\right]^{\mathrm{T}}\cdot \pmb {\Phi},(\pmb{x}_{n}) = \frac{1}{2}$ $K(x_{n},x_{1}),\ldots K(x_{n},x_{N})]^{\mathrm{T}}$  。  $\Phi$  为核函数中代入的特征向量，组成  $N(N + 1)$  的矩阵。由结构风险最小化原则知，为避免过学习，对  $\omega$  加入限制条件：

$$
p(\pmb {\omega}\mid \alpha) = \prod_{i = 0}^{N}\frac{\alpha_i}{\sqrt{2\pi}}\exp \left\{-\frac{\alpha_i\omega_i^2}{2}\right\} \tag{3}
$$

式中  $\alpha_{i}$  为决定  $\omega$  先验概率的  $N + 1$  维超参数。假设 $\alpha_{i}$  和  $\sigma^2$  服从Gamma先验概率分布：  $\begin{array}{rl}{p(\alpha)} & = \end{array}$  Gamma  $(a,b),p(\sigma^2) = \mathrm{Gamma}(c,d)$  。约束条件为： $\begin{array}{rlr}{\mathrm{Gamma}(a,b)} & = & {\Gamma (a)^{-1}\omega^a a^{- 1}e^{- ab},\Gamma (a)} & = \end{array}$

$\int_0^\infty t^{a - 1}e^{- t} \mathrm{d}t, a, c$  为Gamma分布的形状参数，  $b, d$  为尺度参数，为达到无信息先验假设，一般取值为 $10^{- 4}$ 。

给定似然函数和先验分布后，由Bayesian准则可得后验分布为：

$$
\begin{array}{r}p(\pmb {\omega}\mid t,\alpha ,\sigma^2) = p(t\mid \pmb {\omega},\sigma^2)p(\pmb {\omega},\alpha ,\sigma^2) / p(t\mid \alpha ,\sigma^2) = N(t\mid \mu ,\Sigma) \end{array} \tag{4}
$$

式中：

$$
\left\{ \begin{array}{l}\Sigma = (\sigma^{-2}\Phi^{\mathrm{T}}\Phi +A) - 1 \\ \mu = \sigma^{-2}\Sigma \Phi^{\mathrm{T}}t \end{array} \right. \tag{5}
$$

$\Xi$  为后验协方差，  $\mu$  为均值，  $\Psi = \sigma^{2}I + \Phi A^{- 1}\Phi^{\mathrm{T}}, A$  为  $(\alpha_0, \alpha_1, \ldots , \alpha_N)$  的对角矩阵。由此可见，权值的后验概率是由超参数  $\alpha$  和噪声方差  $\sigma^2$  共同决定。则超参数的似然分布为：

$$
\left\{ \begin{array}{l} p(t\mid \alpha ,\sigma^2) = \int p(t\mid \pmb {\omega},\sigma^2)p(\pmb {\omega}\mid \alpha)\mathrm{d}\pmb {\omega} = N(0,\Psi) \\ N(0,\Psi) = (2\pi) - \frac{N}{2}\left(\Psi \right)^{-\frac{1}{2}}\exp \left\{-\frac{t^{\mathrm{T}}\Psi^{-1}t}{2}\right\} \end{array} \right. \tag{6}
$$

由于  $p(\alpha , \sigma^2 \mid t)$  无法进行分解计算，所以选择用delta函数的峰值逼近找到其最优值  $\alpha_{MP}, \sigma_{MP}^2$  。函数表示为：

$$
\delta (\alpha_{MP}, \sigma_{MP}^2) = \arg \max_{\alpha \in \Sigma} p(\alpha , \sigma^2 \mid t) \tag{7}
$$

由此，给出一个新的测试样本  $x_{*}$ ，预测相应的目标  $t_{*}$ ，预测概率模型改为：

$$
p(t_{*} \mid t, \alpha_{MP}, \sigma_{MP}^2) =
$$

$$
\int p(t_{*} \mid \pmb {\omega}, \sigma_{MP}^2) p(\pmb {\omega} \mid t, \alpha_{MP}, \sigma_{MP}^2) \mathrm{d}\pmb{\omega} \tag{8}
$$

模型的求解转变为如何获取  $\alpha_{MP}$  和  $\sigma_{MP}^2$  。本文使用迭代估计法求式（6）的最大近似解。在式（6）中对  $\alpha$  和  $\sigma^2$  求偏导，令导数的值为0，可得：

$$
\alpha_{i}^{\mathrm{new}} = \gamma_{i} / \mu_{i}^{2} \tag{9}
$$

式中  $\mu_{i}$  为式（5）的第  $i$  个后验平均权重，定义  $\gamma_{i} = 1 - \alpha_{i} \Sigma_{ii}, \Sigma_{ii}$  为式（5）中的第  $i$  项对角元素。先给出  $\alpha$  和  $\sigma^2$  的估计值，当  $\alpha_{i}$  很大时，  $\omega_{i}$  被它的先验概率严格约束时，  $\Sigma_{ii} \approx \alpha_{i}^{- 1}$ ，且  $\gamma_{i} \approx 0$  。相反，当  $\alpha_{i}$  很小，  $\omega_{i}$  适应数据时，  $\gamma_{i} \approx 1$  。

噪声方差  $\sigma^2$  为：

$$
(\sigma^2)^{\mathrm{new}} = \frac{\parallel t - \Phi_{\mu} \parallel^2}{N - \sum_{i = 0}^{N} \gamma_{i}} \tag{10}
$$

式中分母的  $N$  为样本数。再由式（9）和式（10）的不断更迭直至达到合适的收敛尺度，得到的收敛的  $\alpha_{i}$  对应的  $x_{i}$  称为相关向量。

# 1.2 建立预测模型

RVM的预测操作步骤见图1。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/77796ff5-05d2-4988-be93-f0663b13e919/8ef6309b647b4aa5269ed221af3a8caf806b0ab4b63e6c6254e1c90aebf5b4a3.jpg)  
图1 RVM预测操作步骤 Fig.1 Predicting procedure of RVM

# 2 预测模型应用

# 2.1 预测流程

RVM模型预测包括训练和检验2个过程：

Step1 将已知故障关系的油液磨粒浓度数据输入RVM预测模型；

Step2 输出预测结果与已知结果做误差分析。Step3 选误差最小的模型参数建立最优模型。

Step4 输入未知故障关系的待检测数据，最终得出预测值。

# 2.2 样本数据

以某型航空发动机在正常模式和故障模式下的油样为例进行光谱分析，采用  $\mathrm{Fe}, \mathrm{Al}, \mathrm{Cu}, \mathrm{Cr}, \mathrm{Ag}, \mathrm{Ti}, \mathrm{Mg}$  7种元素浓度，对应2种工作模式，用“1”表示正常模式，用“2”表示故障模式，共237组数据[12]。限于篇幅，数据在此从略。从中随机抽取116个作为训练样本，剩下的121组数据作为测试样本，分别使用RVM方法、SVM方法和BP神经网络方法进行预测。

# 2.3 不同核函数预测结果比较

选用不同的核函数进行参数导优，结果见表1。

表1 不同核函数预测的均方误差  $(\%)$

Tab.1 The mean square error of predicting in different kernel functions  $(\%)$  

<table><tr><td>核函数</td><td>RVM</td><td>LSSVM</td></tr><tr><td>Linear</td><td>14.538</td><td>15.213</td></tr><tr><td>Polynomial</td><td>8.071</td><td>9.631</td></tr><tr><td>Gauss</td><td>6.992</td><td>7.035</td></tr><tr><td>Sigmoid</td><td>7.399</td><td>10.805</td></tr></table>

在常用核函数中，Gauss核具有较好的学习能力，适用于高、低维，大、小样本集，且Gauss核参数比其他常用核函数的参数少，可减轻核参数的训练次数和时间，因此，本文采用Gauss核函数。

# 2.4 不同参数预测结果

RVM方法选用Gauss核函数，实验证明核宽  $\sigma = 3.75$  时预测结果的平均平方误差最小，见图2。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/77796ff5-05d2-4988-be93-f0663b13e919/450154900d959236a04e59691c0185c68b933037989c8acc1807e89bffb8a40c.jpg)  
图2 RVM不同核参数的预测结果 Fig.2 Predicting results by different kernel parameters of RVM

SVM方法选用Gauss核函数，实验证明，核宽  $\sigma = 2, c = 1, g = 0.0037$  时平均平方误差最小。固定  $c = 1$  ，平均平方误差变化的趋势见图3。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/77796ff5-05d2-4988-be93-f0663b13e919/cd0d81b90012e1d1e98ba3c2afa5b8128cef9808316726ad3ce7365d27042655.jpg)  
图3 SVM不同参数的预测结果 Fig.3 Predicting results by different kernel parameters of SVM

根据Kolmogorov定理，采用一个3层BP网络作为状态分类器。用  $n$  表示输入特征向量的分量数，  $m$  表示输出状态类别总数，则隐层节点数为  $\sqrt{mn} +a$  ，其中  $a$  为  $1 \sim 10$  之间的一个常数[12]。输入神经元节点数为7，输出神经元节点为2，通过实验得最优隐层神经元节点数为12。平均平方误差随隐层节点数变化的趋势见图4。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/77796ff5-05d2-4988-be93-f0663b13e919/0d8032e65a2ab01800e29991606acf6fc0a8863a2fa6b1762e3681ad7b1e27a6.jpg)  
图4 BP-NN不同隐层数的预测结果 Fig.4 Predicting results by different numbers of BP-NN hidden layer

分别用RVM、SVM和BP- NN对检测数据进行预测，预测结果和原始数据的比较见图5。

从图5可以看出，3种方法对检测数据均具有较好的逼近能力，预测结果与真实值比较接近。检测结果分析见表2。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/77796ff5-05d2-4988-be93-f0663b13e919/2400660f9300e159159d3fb58f94d74bfae9b53bf34d43d0154513c9337f48d4.jpg)  
图5 3种方法预测结果的平均绝对误差比较

Fig.5 Compare predicting results by different methods

表23种预测模型结果比较

Tab.2 Compare predicting results by three models  

<table><tr><td></td><td>RVM</td><td>LSSVM</td><td>BP-NN</td></tr><tr><td>有效向量数</td><td>6</td><td>52</td><td></td></tr><tr><td>最大误差绝对值</td><td>0.175 19</td><td>0.375 19</td><td>0.272 45</td></tr><tr><td>最小误差绝对值</td><td>0.000 468</td><td>0.002 653</td><td>0.000 12</td></tr><tr><td>平均误差绝对值</td><td>0.052 92</td><td>0.066 42</td><td>0.070 37</td></tr><tr><td>平均平方误差/%</td><td>0.629 7</td><td>0.703 5</td><td>1.169 7</td></tr><tr><td>训练时间/s</td><td>4.7</td><td>1.8</td><td>5.2</td></tr><tr><td>检测时间/s</td><td>0.5</td><td>1.7</td><td>2.6</td></tr></table>

由表2可以看出，RVM方法的相关向量数量小于LSSVM方法的支持向量个数，在保证精度的情况下，RVM方法降低了运算量和检测时间，减小了误差，提高了检测效率。

# 3 结语

本文将RVM应用于发动机油液磨粒与故障关系预测中，针对滑油样本的光谱数据，分别使用RVM、LISSVM和BP- NN3种方法进行预测，将参数寻优后的预测结果进行比较，实验证明RVM比LISSVM和BP- NN具有更强的可推广性。实际操作中发现，由于RVM核函数的多样性和不同参数寻优方法对不同模型的效率差别，下一步将针对不同类型的航空发动机油液数据模型进行最优化研究。

# 参考文献（References）：

[1] Yu song P, Veeke H P M, Lodcwijks G. A simulation based expert system for process diagnosis[C]// Proceedings of the eurosis 4th international industrial simulation conference. Ghent: Eurosis ETI, 2006: 393- 398.

[2] 黄瑛，陶云刚.D- S证据理论在多传感器数据融合中的应用[J].南京航空航天大学学报，1999，31（2）：172- 177.

HUANG Ying，TAO Yungang.Application of D- S evidential reasoning in multisensor data fusion[J]. Transactions of nanjing university of aeronautics & astronautics，1999，31（2）：172- 177. （in Chinese）

[3] 屈梁生，张海军.机械故障诊断的几个基本问题[J].中国机械工程，2000，10（1- 2）：211- 216.

[4] Vapnik V N. The nature of statistical learning theory [M]. New York: Springer- Verlag, 1999. [5] 王晓丹，高晓峰，姚旭，等.SVM集成研究与应用[J].空军工程大学学报：自然科学版，2012，13（2）：84- 89. WANG Xiaodan，GAO Xiaofeng，YAO Xu, et al. Research and application of SVM ensemble[J]. Journal of air force engineering university: natural science edition,2012,13（2）：84- 89. （in Chinese）[6] Xu X M, Mao Y F, Xiong J N, et al. Classification performance comparison between RVM and SVM[C]// Proceedings of the IEEE international workshop on anti- counterfiting, security, identification. Fujian: IEEE press,2007;208- 211. [7] Tipping M E. Sparse Bayesian learning and the relevance vector machine[J]. Machine learning research, 2001(1):211- 244. [8] Widodo A. Fault diagnosis of low speed bearing based on relevance vector machine and support vector machine[J]. Expert systems with applications, 2009, 36(3):7252- 7261. [9] Tipping M E. Sparse Bayesian learning and the relevance vector machine[J]. Journal of machine learning research,2001,1(3):211- 244. [10] 周欣，秦晓东，吴瑛.稀疏贝叶斯模型和相关向量机在信号识别中的应用[J]. 电路与系统学报，2011，16(6):75- 80. ZHOU Xin, QIN Xiaodong, WU Ying. Application of sparse Bayesian model and relevance vector machine to signal classification[J]. Journal of circuits and systems,2011,16(6):75- 80. （in Chinese）[11] 文振华.智能诊断专家系统知识获取方法研究及应用[D]. 南京：南京航空航天大学，2006：64- 65. WEN Zhenhua. Research and application of knowledge acquirement methods for intelligent diagnosis expert system[D]. Nanjing: Nanjing university of aeronautics and astronautics,2006:64- 65. （in Chinese）[12] 张立明.人工神经网络的模型及应用[M]. 上海：复旦大学，1993. ZHANG Liming. The model and application of neural network[M]. Shanghai: Fudan university, 1993. （in Chinese）

（编辑：徐敏）