摘要：针对民用飞机电源系统嵌入式软件的可移植性、可扩展性要求，提出基于统一建模语言（Unified Modeling Language，UML）的面向对象设计方法；针对不同硬件平台上软件开发周期长、成本高的问题，采用分层插件设计方法。按照UML设计的开发过程，建立系统需求的用例图、软件逻辑架构的静态结构模型和运行架构的动态行为模型；对电源系统进行实时健康监控，完成对输出的配电管理。实际使用证明，嵌入式软件具有良好的可移植性、扩展性，软硬件独立设计可缩短系统开发周期、降低成本，系统设计能够实现自身健康管理。

关键词：民用飞机；电源系统；统一建模语言；分层插件；健康管理中图分类号：TP302.1 文献标志码：A 文章编号：1671- 637X(2016)03- 0082- 05

# Design and Implementation of Civil Aircraft Power Supply System Base on UML

RU Wei, ZHANG Shuang, HU Yu- fan, ZHANG Yang- yang (Aeronautical Computing Technique Research Institute, AVIC, Xi'an 710068, China)

# 0 引言

民用飞机在使用阶段经济性评价的标准是飞机直接运营成本（DOC），无论是新机研制还是机型改进，DOC都是竞争分析中最重要的评价指标之一。安全性是航空公司与乘客共同关注的核心问题，因此在民用飞机设计中，飞机的经济性和安全性尤其重要。民用飞机电源系统在设计中需重点考虑经济性与安全性。

嵌入式系统以应用为中心、硬件平台为基础，具有

体积小、反应速度快等特点，广泛应用于物联网、航空航天、工业控制厂等领域。目前技术的发展带来嵌入式应用规模不断增长、嵌入式系统需求的复杂性、不确定性不断提高，系统硬件平台不断更新，而产品研发周期却越来越短，为了降低成本，嵌入式应用软件的可移植性、可扩展性就越来越重要。

统一建模语言UML是面向对象分析与设计的标准语言，传统的面向过程开发方法已不适应当前嵌入式软件的大规模、高复杂的需求，面向对象设计技术采用封装、继承等抽象机制降低了系统复杂性，在嵌入式软件的开发过程中用来提高软件的可重用性、可扩展性，UML在嵌入式软件工程中已得到广泛应用，如嵌入式软件测试、嵌入式系统可靠性、嵌入式设备驱

动、代码覆盖率统计。

目前，电源系统已在分布式电源系统、DSP芯片系统等平台上使用，但这些都是传统面向过程开发设计，每个嵌入式系统的硬件平台差别较大，并且在不同的硬件平台上，软件不具有可移植性、可扩展性。针对上述情况，本文引入UML面向对象分析方法的设计，建立了系统需求、逻辑设计及运行架构在UML中对应的需求分析、静态结构模型和动态行为模型；应用分层插件设计思想，软硬件独立设计从而缩短不同硬件平台带来的软件开发周期、降低成本，提高经济性，即低层驱动（硬件）+上层应用（软件）独立设计，提高嵌入式电源系统软件开发在其他平台的移植性及扩展性，并对电源系统进行实时监控，完成对输出的配电管理，提高系统的安全性。

# 1 分层插件设计

当前嵌入式平台的主流系统架构设计方法为传统的分层架构，分层架构为一种层次化的设计，即嵌入式系统分为软件、硬件两部分实现，按照功能模块的调用顺序划分为硬件层、驱动层、API应用层，各个层之间为单向调用和单向依赖。电源系统采用一种改进的分层插件设计，硬件层、驱动层、API以“平台”形式存在，各层对上层提供的接口相互独立，可独立开发和维护；应用层独立于硬件平台设计，各种应用与硬件无关。分层插件系统模型如图1所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/f7021780f11450e0e543c96f866a0405dad40867e91fa42008ef950ae2f3afde.jpg)  
图1分层插件系统模型 Fig.1 Hierarchical plug-in system model

# 2 电源系统分析与设计

# 2.1 系统概述

民用飞机某电源系统将输入  $270\mathrm{V} / 400\mathrm{Hz}$  交流电转换为直流  $28~\mathrm{V}$ ，实现电源系统故障检测、处理、配置信息、历史信息的存储以及根据故障检测的结果进行输出配电管理，通过RS232总线实现电源系统的健康状态上报及健康管理。系统功能如下：1）通过加电自测试（PBIT）、周期自测试（CBIT），对各个关键部件进行测试，完成系统各个关键部件的故障检测、健康监控管理，

并且能够向综合维护管理服务上报健康状态；2）能够在PBIT，CBIT测试过程中，在NVRAM中完成故障记录、存储；3）能够根据检测结果，实现对多路输出的独立配电管理，同时可接收外部命令，实现独立配电管理；4）能够将软硬件版本，P/N等构型周期性上报。

# 2.2 需求分析

根据系统功能要求，识别出电源系统嵌入式软件需求，如下所述：1）健康监控及上报，对关键部件进行PBIT，CBIT测试，将测试结果上报给综合维护管理服务；2）故障记录，测试结果故障在NVRAM中记录、存储；3）配电管理，根据检测结果，实现多路输出的独立配电管理，同时可接收综合维护管理命令实现输出独立配电管理；4）构型管理，周期性上报软硬件版本、P/N构型等。

根据系统需求，识别出用户为综合维护管理服务。识别出的用例为配电管理、健康监控上报、构型管理、维护测试。系统用例如图2所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/c05a08d8999ae2a83cfca3d2be99003655132f52d94d16cbf0aea41c57fde963.jpg)  
Fig 2 Power supply system use case diagram

图2中，配电管理实例包含健康监控及上报实例，配电管理需要根据健康监控状态完成对相应输出的配电管理；健康监控及上报实例包含构型管理实例，健康监控及上报读取构型信息，完成周期性构型信息的上报，同时此实例完成对电源系统的健康实时监控，以实现健康管理。

# 2.3 静态结构模型

根据改进的分层插件设计，电源系统采用硬件层平台、驱动层平台、API平台及应用层平台，其分层插件如图3所示。在分层插件设计中，即若更换处理器硬件平台则重新设计处理器的硬件电路图，重写驱动及API接口程序，此部分的修改不会影响应用层，即可实现在不同的硬件平台上，应用层平台不需修改即可实现多平台的移植应用，使应用软件具有良好的移植性。

通过对用例图及分层插件示意图的分析，可确定系统的逻辑架构，即静态结构模型，确定类的属性、操作及类之间的关系。

电源系统驱动层提供类Init，其为串口、处理器、Flash、定时器提供初始化。其中：串口初始化内容为波

特率、奇偶校验、停止位、数据长度；处理器初始化内容为各种资源分配；Flash初始化内容为存储空间的分配；定时器初始化内容为系统时钟、GPIO管脚、定时器使能、中断、优先级等。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/3d885706f8d7c8b7989f0fde9b4f79367dab4722ad1d82f4bd2636a2b54949a3.jpg)  
图3 电源系统的分层插件图

Fig.3 Hierarchical plug- in diagram of power supply system

电源系统API平台层提供类UART、类NVRAM和类Test_Item。各个类的功能如下：1）类UART根据信息定义格式，完成不同消息不同长度的接收与发送，为健康上报、构型信息上报及接受综合维护管理命令提供接口；2）类NVRAM提供向NVRAM进行读写操作，为健康监控管理读取存储在NVRAM上的构型信息及检测的故障存储提供接口；3）类Test_Item提供处理器，NVRAM，Flash，RTC，RS232，电压，电流，温度的测试操作，各个测试项的检测方法见表1。

# 表1 测试项及方法

Table 1 Test items and test methods  

<table><tr><td>检测项</td><td>检测内容</td><td>检测通过准则</td></tr><tr><td>处理器</td><td>Integer Arithmetic, Integer Rotate/Shift, Integer Compare and Logical</td><td>各条指令所得到的结果与预期结果相一致</td></tr><tr><td>NVRAM</td><td>读检测、读－写检测</td><td>读检测：遍历完NVRAM预期读检测区域；读－写检测：读取的数据与写入的数据相一致</td></tr><tr><td>Flash</td><td>stuck/float 位测试</td><td>stuck检测：能够遍历完文件；fluct位检测：两次读取的数据完全一致</td></tr><tr><td>RTC</td><td>计时检测</td><td>两次读写时间值为后一个时间值大于前一个</td></tr><tr><td>RS232</td><td>读检测</td><td>读取寄存器的数据与预先定义的数据一致</td></tr><tr><td>电压</td><td>读取A/D转换后的电压值</td><td>电压值在一定的电压阈值内</td></tr><tr><td>电流</td><td>读取A/D转换后的电流值</td><td>电流值在一定的电流阈值内</td></tr><tr><td>温度</td><td>读取A/D转换后的温度值</td><td>温度值在一定的温度范围内</td></tr></table>

电源系统应用层提供类PBIT、类CBIT、类PowerCtrl、类API。各个类的功能如下：1）类PBIT、类CBIT根据不同要求对处理器，NVRAM，Flash，RTC，电压，电流，温度进行测试，并将检测结果存储在NVRAM中；2）类PowerCtrl根据各个检测项的检测结果及接收的

综合维护管理指令对输出的配电提供管理，完成输出的独立配电提供管理，驱动层类为所有硬件驱动，提供硬件具体操作和抽象接口；3）类API由OS提供，为应用层提供操作接口，应用层为应用程序封装类，为系统实现提供具体操作。电源系统的类图如图4所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/cb3e422115f8b0b7e2a5b9a934da0bc5c950399319833c44017ecad9072fffdd.jpg)  
图4 电源系统类图 Fig.4 Power supply system class diagram

Fig.4 Power supply system class diagram

# 2.4 动态结构模型

序列图和状态图表描述了系统的动态行为。图5为电源系统的序列图，图中使用括号表示约束。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/661b2d4b3ede68d6f77c0128fdd0ea683a1af1c3cbed485bf6c5e1acb354d719.jpg)  
图5 电源系统序列图 Fig.5 Power supply system sequence diagram

系统首先进行串口、定时器、处理器、Flash的初始化。初始化完成后进行PBIT，完成检测项中各个部件的检测并将检测结果存储到NVRAM，当检测结果全部通过后进行所有输出的初次配电管理，即所有的输出正常打开。在正常工作时，首先检测是否有外部指令对输出进行上下电控制，如果有，则执行输出的配电管理，否则读取定时器时间，当定时器计时周期到1s时，完成电压、电流、温度、处理器等硬件的检测并将检测结果存储到NVRAM，同时将检测结果通过串口上报给

外部综合维护管理，当某一路输出出现故障或系统温度过高，对相应支路的输出进行配电管理，实现对电源系统的健康管理；当定时器计时周期到2s时，上报软硬件构型信息。

状态图描述了单个对象的状态变化，初始化对象完成所有硬件的初始化、PBIT完成检测后执行首次配电管理、按照定时周期完成CBIT及检测结果的存储、根据检测结果完成相应的输出配电管理以及接受综合维护管理命令实现输出的独立配电管理。各个对象变化如图6所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/72e1ffea-17c5-4953-a927-5c6f84823fbc/bdd025e1f07343e911ac21a64b62f4ca0b226566f2e3e4c9c4cd181d39b933a4.jpg)  
图6 电源系统状态图 Fig.6 Power supply system, state diagram

# 3 电源系统实现

根据上述设计，使用CCS3.3环境开发，电源系统在TMS320F28335芯片上运行，与综合维护管理通过RS232进行消息交互。电源系统实现通过以下3种场景进行验证。

1）各项初始化成功后，进行PBIT，在PBIT测试通过后对所有输出进行配电管理：综合维护管理对输出无配电管理命令，电源系统以1s周期进行CBIT，CBIT检测项无故障；以2s周期向综合维护管理上报构型信息。

2）场景2与场景1不同之处为电源系统正常运行时，其接受综合维护管理发送的输出配电管理命令，此时电源系统执行命令。

3）场景3与场景1不同之处为在进行CBIT检测时，channel2电压测试结果为FAIL，此时根据故障处理要求，对channel2进行配电管理，即channel2下电。

# 4 结束语

嵌入式系统越来越广泛应用于各个领域，相应软件规模、复杂程度迅速增长。民用飞机电源系统设计在实际使用中，采用了基于UML的面向对象分析方法的设计，满足了嵌入式软件的可移植性、可扩展性要求；采用分层插件设计思想通过对硬件平台层、硬件驱动及API层的修改，实现了电源系统软硬件独立设计、开发，降低设计成本；通过对电源系统的关键硬件、电压、电流、温度的监控，实现了系统自身健康管理，降低维修成本，提高了系统的经济性和安全性。本文设计的嵌入式电源系统，为以后电源系统的开发、移植、扩展做了一些探索，也为高效、高质量开发应用软件奠定了基础。

计，满足了嵌入式软件的可移植性、可扩展性要求；采用分层插件设计思想通过对硬件平台层、硬件驱动及API层的修改，实现了电源系统软硬件独立设计、开发，降低设计成本；通过对电源系统的关键硬件、电压、电流、温度的监控，实现了系统自身健康管理，降低维修成本，提高了系统的经济性和安全性。本文设计的嵌入式电源系统，为以后电源系统的开发、移植、扩展做了一些探索，也为高效、高质量开发应用软件奠定了基础。