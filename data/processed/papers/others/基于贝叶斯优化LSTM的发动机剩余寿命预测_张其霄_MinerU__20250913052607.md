摘要：针对航空发动机剩余寿命预测中深度学习算法参数优化效率低、预测准确率差等问题，在长短期记忆网络算法(LSTM)的基础上提出一种基于贝叶斯优化的LSTM算法。利用长短期记忆网络对航空发动机的传感器数据进行时间序列预测，并运用贝叶斯优化算法对长短期记忆网络的超参数进行迭代优化。利用NASA公开数据集对算法进行验证，结果表明，相较于其他算法，优化后的算法在优化参数、提高预测准确率方面有明显改善，能为保证航空器的安全使用以及制定维修替换策略提供参考。

关键词：贝叶斯优化，LSTM，航空发动机，剩余寿命预测，预测与健康管理

中图分类号：TP183 文献标识码：A DOI:10.3969/j.issn.1002- 0640.2022.04.015

引用格式：张其霄，董鹏，王科文，等.基于贝叶斯优化LSTM的发动机剩余寿命预测[J].火力与指挥控制，2022,47(4):85- 89.

# Residual Service Life Prediction for Aircraft Engines Based on Bayesian Optimal Long Short-term Memory Network

ZHANG Qi- xiao, DONG Peng, WANG Ke- wen, LU Wei (Department of Management Engineering and Equipment Economics, Naval University of Engineering, Wuhan 430033, China)

Citation format:ZHANG Q X, DONG P, WANG K E, et al. Residual service life prediction for aircraft engines based on Bayesian optimal long- short- term memory network [J]. Fire Control & Command Control, 2022, 47(4): 85- 89.

# 0 引言

航空发动机作为重要的航空装备，是一个十分复杂的系统，且航空发动机一般在高温、高压、高转速、高负荷等复杂条件下长时间运行，因此，保证航

空发动机安全性和可靠性十分必要[1]。其中，发动机的预测与健康管理（prognostics and health management, PHM）是一个有效的解决方案。剩余使用寿命（remaining useful life, RUL）预测是PHM研究领域中的关键任务，目标是根据设备健康状态的数据，

预测设备的剩余使用时间[2]。航空发动机的剩余寿命预测主要方法可分为3类：基于物理模型的预测方法、基于数据驱动的预测方法和混合预测方法[3]。由于发动机结构复杂，难以建立精确的物理模型来进行描述，因此，基于发动机监控数据的数据驱动模型是有效的研究方法，成为众多学者们的研究热点。

基于数据驱动的RUL预测方法不依赖于物理失效模型，而是基于数据分析和挖掘，提取反映系统健康状态的特征，继而借助于人工智能等算法实现剩余寿命预测。常见的数据驱动方法可分为两类：基于数理统计和基于机器学习的方法。典型的数理统计模型如马尔科夫、自回归移动平滑（AM- RA）、维纳过程等。相较于统计模型，近年来，基于机器学习方法的研究与应用更为广泛，典型算法有人工神经网络、支持向量机、深度学习等。KHELIF等人基于支持向量回归（support vectorregression，SVR)对涡轮发动机进行了剩余寿命预测[4]；也有学者利用多层感知机（multi- layerperceptron，MLP）进行剩余寿命预测的研究。现有的机器学习方法在一定程度上严重地依赖于专家经验，依靠人工来提取特征，在面对海量数据时性能一般。

深度学习是机器学习的一个组成部分，随着计算机性能的提升、数据积累和深度神经网络理论完善与发展，训练深层网络成为了一个重要发展方向。依赖深层网络提取特征和处理非线性表达，深度学习在许多传统机器学习难题领域取得了重大突破，但深度学习在健康评估和剩余寿命预测的应用仍在探索阶段。BABUGS首先利用卷积神经网络（convolutional neural network，CNN）进行了剩余寿命预测。在LSTM的应用中，ZHENG S在2017年首先利用LSTM网络对涡轮发动机进行了剩余寿命预测[5]；LIX则利用LSTM的变体BiLSTM研究剩余寿命预测问题[6]；李京峰运用深度置信网络对LSTM进行优化，对涡轮发动机进行了剩余寿命预测[7]；HEK则将（bidirectionalhandshakingLSTM，BHSLSTM）应用于剩余寿命预测研究。

虽然以上的几种深度学习方法在PHM领域中已经有了一定的应用，但是在运用深度学习进行剩余寿命预测时，对超参数的确定主要根据经验或者手工优化，参数优化效率较低，在预测准确率上仍然有提升的空间。

因此，依据深度学习算法和优化算法，提出一种基于贝叶斯优化LSTM模型的发动机剩余寿命预测方法。利用贝叶斯优化算法优化LSTM网络，

选择隐藏层数和初始学习率作为优化的超参数，将使用该组超参数在验证集上的RSME作为目标函数。基于目标函数的过去评估结果建立替代函数找到最小化目标函数的值，并作为超参数。利用贝叶斯优化的LSTM函数对发动机剩余寿命进行预测，利用NASA数据集对方法进行验证。

# 1 基本算法

# 1.1 LSTM算法

长短期记忆网络（long short term memory，LSTM）是循环神经网络（RNN）的变体之一，是针对RNN自身所存在的长期依赖问题和模型训练中存在梯度消失、爆炸等问题所专门设计出来的一种时间循环神经网络结构[8]。LSTM的核心思想就是在一般RNN单元结构设的基础上增加3种类型的“门”，通过门限机制来控制传输状态，保留长期记忆和忘掉无用记忆，以保留最重要信息。这3种门分别为：遗忘门、输入门和输出门，示意图如图1所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/9ae1b3e4234f5a0d8500999e67aec63f8855421d5cde655acc0383874d273e67.jpg)  
图1 LSTM示意图

LSTM网络模型指构完毕后，可以运用时间反向传播（BPTT）算法来对LSTM网络进行训练，来得到LSTM的相关参数。

# 1.2 贝叶斯优化算法

贝叶斯优化算法使用概率模型代理拟合原始代价的目标函数，根据后验概率分布构造采集函数，选择下一个最优评估点。文中概率模型选择运用高斯过程回归，采集函数选择运用提升概率函数。

贝叶斯优化过程如图2所示

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/65cbc4ad065ee63d37d4a983e59b5ba88a88dbfd857def2f96cdcefaabbbe64e.jpg)  
图2 贝叶斯优化过程图

# 1.2.1 高斯过程回归

高斯过程是贝叶斯优化的运用中应用最为普遍的概率模型[9]。作为多元高斯概率分布的一般范化，高斯过程主要是由均值函数与半正定的协方差函数组成，即：

$$
y = gp(n(x),k(x,x^{\prime}))
$$

其中，  $n(x)$  是均值函数，  $k(x,x^{\prime})$  是协方差函数。  $\mathcal{X}$  是高斯过程的训练样本，  $\mathcal{X}$  的测度在高斯过程是呈有限维分布的。运用高斯过程对样本中的离散数据进行拟合时，  $n(x)$  一般设置成  $0,k(x,x^{\prime})$  一般使用Matern协方差函数。

# 1.2.2 采集函数

提升概率是最为常用的采集函数。函数将能最大提升当前最大值  $f(x_{\mathrm{max}})$  的点作为下一点。其表达式如下：

$$
f(x) = P(f(x_{\mathrm{max}}) + \alpha) = \phi (\frac{\mu(x) - f(x_{\mathrm{max}}) - \alpha}{\sigma(x)})
$$

其中，  $f(x)$  为目标函数值，  $\phi (*)$  为分布函数，  $\mu (x)$ $\sigma (x)$  分别为高斯过程回归概率模型的均值和方差， $\alpha$  为超参数，以探索最大值空间。  $\alpha = 0$  使得值收敛于 $f(x_{\mathrm{max}})$  ，避免出现局部最优。

利用贝叶斯优化LSTM进行预测的一般步骤为：

1）设定待优化参数范围，优化目标为RMSE；2）利用贝叶斯对LSTM的隐藏层和初始学习率进行优化；3）返回优化的RMSE最小值及对应LSTM模型的超参数；4）将贝叶斯优化LSTM模型的超参数作为最终LSTM模型的参数。

# 2 基于贝叶斯优化LSTM的剩余寿命预测方法

基于贝叶斯优化LSTM网络构建发动机剩余寿命预测模型，该模型在LSTM网络的基础上，使用贝叶斯优化算法对LSTM网络的超参数进行优化，提高预测的准确度。主要对初始学习率和隐藏层数两个超参数进行贝叶斯优化，优化超参数的约束条件如表1所示。

表1超参数约束条件  

<table><tr><td>名称</td><td>标识</td><td>类型</td><td>范围</td></tr><tr><td>初始学习率</td><td>InitialLearnRate</td><td>log</td><td>[1e-5,1e-1]</td></tr><tr><td>隐藏层数</td><td>NumHiddenUnits</td><td>integer</td><td>[10,1 000]</td></tr></table>

运用贝叶斯优化LSTM网络超参数，进而应用LSTM网络对航空发动机进行剩余寿命预测，其具

体实现流程如图3所示

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/7886b6122892cbc18d362a3df742790f96c1a40cec025cb6432fd9c69b19a4ef.jpg)  
图3 具体实现流程图

# 3 实例分析

# 3.1 数据集介绍

验证实验数据集来自于NASA的涡扇发动机退化数据集（C- MAPSS），该数据集记录了每台发动机在采样时间产生的数据样本，记录了从健康到故障的性能退化过程。数据集包含1个时间数据，3个操作模式和21个传感器数据[10]。具体传感器名称如表2所示。数据集包括训练集、测试集和测试集标签。以该数据集为例，测算贝叶斯优化LSTM算法的性能，并与其他算法进行对比分析。

表2 传感器信息表  

<table><tr><td>编号</td><td>名称</td><td>单位</td></tr><tr><td>T2</td><td>风扇入口的总温度</td><td>°R</td></tr><tr><td>T24</td><td>LPC出口处的总温度</td><td>°R</td></tr><tr><td>T30</td><td>HPG出口处的总温度</td><td>°R</td></tr><tr><td>T50</td><td>LPT出口处的总温度</td><td>°R</td></tr><tr><td>P2</td><td>风扇入口的压力</td><td>psia</td></tr><tr><td>P15</td><td>旁通管道中的总压力</td><td>psia</td></tr><tr><td>P30</td><td>高压压缩机出口处的总压力</td><td>psia</td></tr><tr><td>Nf</td><td>物理风扇速度</td><td>rpm</td></tr><tr><td>Nc</td><td>物理核心速度</td><td>rpm</td></tr><tr><td>Epr</td><td>发动机压力比</td><td>--</td></tr><tr><td>Ps30</td><td>高压压缩机出口处的静态压力</td><td>psia</td></tr><tr><td>Phi</td><td>燃油流量与Ps30的比率</td><td>pps/psi</td></tr><tr><td>NRf</td><td>已校正风扇速度</td><td>rpm</td></tr><tr><td>NRc</td><td>校正的核心速度</td><td>rpm</td></tr><tr><td>BPR</td><td>旁路比</td><td>--</td></tr><tr><td>FarB</td><td>燃烧器燃油-空气比</td><td>--</td></tr><tr><td>htBleed</td><td>排气焓</td><td>--</td></tr><tr><td>Nf_dmd</td><td>风扇要求速度</td><td>rpm</td></tr><tr><td>PCNFR_dmd</td><td>校正风扇要求速度</td><td>rpm</td></tr><tr><td>W31</td><td>高压涡轮机冷却剂排放</td><td>lbm/s</td></tr><tr><td>W32</td><td>低压涡轮机冷却剂排放</td><td>lbm/s</td></tr></table>

# 3.2 数据预处理

# 3.2.1 删除常量参数

虽然训练集与测试集一共记录涡扇发动机的21种传感器数据，但其中有一部分传感器是常数量，不随样本或时间变化[1]。换言之，这些常量参数对于航空发动机剩余寿命预测不起作用，对于模型训练也没有帮助。同时，参考其他研究中的做法，方便进行对比分析，对常量参数进行了删除操作，只选取变量传感器数据作为输入来对模型进行训练和验证。

# 3.2.2 数据标准化

然后，对传感器数据进行了数据标准化，方便不同量纲的数据进行分析。数据标准化的一般处理方法主要有Min- max和Z- score两种方法。主要采取Z- score方法对传感器数据进行数据归一化。Z- score表达式如下：

$$
x_{2} = \frac{x - x}{\sigma}
$$

# 3.2.3 设置训练集标签

下面先各按各个样本的大小顺序进行排列。如图4所示，可以发现大部分样本在125以上。因为在系统前期，发动机状态比较稳定，退化较慢。为更快训练算法，按照一般做法[11- 12]对系统前期的数据进行裁剪，选取选取快要发生故障的样本数据，以125对样本进行裁剪。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/13e083f55774ff6402f7d71ee4b2c59bf5d3ced2e9f4ec192b30440e02216195.jpg)  
图4样本数据排序图

# 3.3 设置网络结构

构建基于贝叶斯优化的LSTM网络，LSTM网络包含1个LSTM层、1个池化层和两个全连接层。其中，LSTM网络结构超参数中初始学习率和隐藏层数由贝叶斯优化迭代选优，其他参数如表3所示。

表3LSTM网络参数表  

<table><tr><td>参数</td><td>取值</td></tr><tr><td>miniBatchSize</td><td>20</td></tr><tr><td>maxEpochs</td><td>60</td></tr><tr><td>优化器</td><td>sgdm</td></tr></table>

贝叶斯优化针对初始学习率和隐藏层数进行迭代寻优，迭代次数设置为10。

# 3.4 评价指标

模型评价的常用性能评价指标主要有均方根误差（root mean squared error，RMSE）和评分函数（Score）两种方法。主要采用均方根误差（RMSE）来对航空发动机剩余寿命预测模型的性能进行评价。RMSE的表达式如下所示：

$$
\mathrm{RMSE} = \sqrt{\frac{1}{n}\sum_{i = 1}^{n}(y_{i} - y_{i}^{-})^{2}}
$$

其中， $n$  是样本数量， $y_{i}$  和  $y_{i}$  分别是第  $i$  个样本的LSTM网络预测值和原始值。

# 3.5 实验结果

首先利用贝叶斯优化算法对LSTM算法的超参数进行了优化，经过迭代择优，找到了LSTM超参数最优解，当初始学习率为0.010177，隐藏层数为756时，RMSE最小，为15.188。具体贝叶斯优化过程如图5所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/475e55d354084d840d6c7d0742b3ea947d0503724397260972d2fc507fadef6b.jpg)  
图5贝叶斯优化过程图

然后随机选取6个发动机，对其剩余寿命预测情况进行观察，如下页图6所示，贝叶斯优化LSTM算法对于航空发动机剩余寿命预测效果较好。

# 3.6 对比分析

为了进一步说明预测方法的可行性和有效性，选取其他6种预测方法，与同样数据集的研究结果进行对比分析，以充分评估贝叶斯优化LSTM算法的效果。6种方法同样使用RMSE作为评价指标，具体对比结果如下页表4所示。

由表4可见，与MLP和SVM等机器学习算法相比，贝叶斯优化LSTM结果更好，CNN等常规深度学习模型也取得了更好的结果。和Bi- LSTM、BHSLSTM和LSTM等优化算法相比，RMSE评价结

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/0c679086-79b1-469e-b17e-75a4fde49d85/ea0989f4bb41d93258b22996ebcd62c7f2e4fb63c7edcf26147794d00ff9aa59.jpg)  
图6 发动机剩余寿命预测情况

表4RMSE对比分析表  

<table><tr><td>预测方法</td><td>RMSE</td></tr><tr><td>MLP</td><td>37.56</td></tr><tr><td>SVR</td><td>20.96</td></tr><tr><td>CNN</td><td>18.45</td></tr><tr><td>BiLSTM</td><td>16.8</td></tr><tr><td>BHSLSTM</td><td>18.8</td></tr><tr><td>LSTM</td><td>16.14</td></tr><tr><td>贝叶斯优化 LSTM</td><td>15.188</td></tr></table>

果分别提升了  $9.595\% , 19.128\%$  和  $5.898\%$  。这是因为利用贝叶斯优化算法对超参数进行了迭代择优，克服了手工调整的弊端，能更好地利用深度学习网络进行预测。因此，在航空发动机剩余寿命预测上取得更好的结果。

# 4 结论

航空发动机作为最重要的航空器部件，实时监控健康状态、准确预测剩余寿命，能有效提高航空器的可靠性和安全性，并为制定维修策略提供参考依据。根据深度学习和优化算法，提出了贝叶斯优化LSTM算法的航空发动机剩余寿命预测方法。方法利用贝叶斯优化算法优化LSTM网络的隐藏层数和初始学习率，将使用该组超参数在验证集上的RSME作为目标函数；基于目标函数过去的评估结果建立替代函数找到最小化目标函数的值，并作为超参数；利用贝叶斯优化的LSTM函数对发动机剩余寿命进行预测，然后通过NASA公开数据集对该方法进行了验证。通过与其他6种算法的比较可以

得出，贝叶斯优化LSTM算法能更好地进行参数优化，具有更高的预测精度，在航空发动机进行剩余寿命预测方面应用效果较好。

# 参考文献：

[1]赵广社，吴思思，荣海军.多源统计数据驱动的航空发动机剩余寿命预测方法[J].西安交通大学学报，2017，51(11):150- 155. [2]任子强，司小胜，胡昌华，等.融合多传感器数据的发动机剩余寿命预测方法[J].航空学报，2019，40（12）：134- 145. [3] YU W, KIM I Y, MECHEFSKE C. Remaining useful life estimation using a bidirectional recurrent neural network based autoencoder scheme [J].Mechanical Systems and Signal Processing,2019,129(15):764- 780. [4] KHELIF R, CHEBEL- MORELLO B, MALINOWSKI S, et al. Direct remaining useful life estimation based on support vector regression [J].IEEE Transactions on Industrial Electronics,2017,64(3):2276- 2285. [5] ZHENG S, RISTOWSKI K, FARAHAT A, et al. Long short- term memory network for remaining useful life estimation [C]// Proceedings of the 2017 IEEE International Conference on Prognostics and Health Management (ICPHM),Piscataway:IEEE,2017:19- 21. [6] LI X, DING Q, SUN J Q. Remaining useful life estimation in prognostics using deep convolution neural networks [J]. Reliability Engineering & System Safety,2017,24(172): 1- 11. [7]李京峰，陈云翔，项华春，等.基于LSTM- DBN的航空发动机剩余寿命预测[J].系统工程与电子技术，2020，43（7）：1637- 1644. [8] HOCHREITER S, SCHMIDHUBER J. Long short- term memory[J].Neural computation,1997,27(9):1735- 1780. [9]邓帅.基于改进贝叶斯优化算法的CNN超参数优化方法[J].计算机应用研究，2019，36（7）：1984- 1987. [10] SAXENA, ABHINAV, ODEBEL K, et al. "Damage propagation modeling for aircraft engine run- to- failure simulation. "In Prognostics and Health Management,2008 [C]//PHM 2008 International Conference on, 1- 9. IEEE, 2008. [11]张永峰，陆志强.基于集成神经网络的剩余寿命预测[J].工程科学学报，2020，42（10）：1372- 1380. [12] BABU G S, ZHAO P, LI X L. Deep convolutional neural network based regression approach for estimation of remaining useful life [C]//In Proceedings of the International conference on database systems for advanced applications, Springer, 2016:214- 228. [13] HE K, ZHANG X, REN S, et al. Deep residual learning for image recognition [C]// Proceedings of the 2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR). Piscataway: IEEE, 2016:770- 778.