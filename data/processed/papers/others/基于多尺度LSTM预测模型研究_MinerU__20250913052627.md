摘要：航空发动机剩余寿命（remaining useful life，RUL）预测是设备故障预测与健康管理（prognostics and health management，PHM）的核心问题。针对发动机数据维度高、滞后性强和复杂度高等挑战，提出了一种基于自训练权重的多尺度注意力双向长短期记忆神经网络模型。通过不同尺度的双向长短期记忆神经网络(bidirectional long short- term memory neural network，BiLSTM)提取多尺度特征；提出一种基于自训练权重的融合算法，通过引入注意力机制进行不同尺度的特征筛选，以提高预测精度。将各模型在NASA的C- MAPSS数据集上进行实验对比，结果证明，所提出预测模型在准确率和均方根误差指标上均有所提升。

关键词：故障预测与健康管理；剩余寿命；双向长短期记忆网络；自训练权重；注意力机制；融合算法

中图分类号：TP391.9 文献标志码：A 文章编号：1004- 731X(2022)07- 1593- 12 DOI:10.16182/j.issn1004731x.Joss.21- 0182

# Research on Prediction of Model Based on Multi-scale LSTM

Qiu Junjie, Zheng Hong*, Cheng Yunhui

(School of Information Science and Engineering, East Chines of Science and Technology, Shanghai 200237, China)

# 引言

机器设备的故障预测与健康管理是保障设备系统安全、早期预防和减少维修成本的关键技术。航空发动机作为飞行器的核心动力部件，对其进

行实时状态监测和航空发动机剩余(remaining useful life, RUL)预测是保证飞行器安全可靠运行的重要技术手段。准确预测RUL可及时采取维修策略，减少维修投入成本，提高经济收益，降低事故率。因此，航空发动机RUL预测是PHM

(prognostics and health management)领域中研究的重点问题，也是实施状态维修的重要依据[2]。

航空发动机数据集往往具有滞后、强耦合和参数时变等非线性的特性，由于缺少泛化能力强的数学模型，环境的不稳定和不可控以及大量噪声数据等因素导致RUL的预测变得困难与复杂。因此，单一的深度学习模型不能完全解决这些问题。为了提高RUL预测的精度，本文提出了一种基于自训练权重的多尺度注意力双向长短期记忆神经网络(attention- based bidirectional long short- term memory network，ABiLSTM)模型应用于航空发动机RUL预测，并进行了大量实验验证。

早期基于物理模型的预测方法为该领域主流方法，运用物理学原理搭建数学模型，用于模拟部件的性能退化过程，但是实验成本昂贵，需要严苛的环境，导致该方法应用范围有限。皮骏等提出一种基于QAR(quick access recorder)数据的民用航空发动机高压涡轮叶片实际使用载荷谱的数值模拟方法，为RUL预测提供了可靠工程方法[1]。机器学习方法通过最小化损失函数获取最优预测模型，利用传感器收集数据进行模型训练以获取RUL预测值。张朝龙等针对锂电池噪声类型多，提出了一种基于小波去噪和混沌粒子群相关向量机的锂电池剩余寿命预测方法，利用小波二次降噪，结合粒子群算法优化相关向量机(relevance vector machine，RVM)模型，进而实现RUL预测[5]。赵申坤等将数据驱动方法和贝叶斯理论结合，利用马尔科夫链蒙特卡洛方法更新模型参数并预估系统的RUL值[6]。彭鸿博等提出一种基于信息融合的RVM发动机RUL预测方法，利用核主元分析(kernel principle component analysis，KPCA)提取退化特征信息，采用RVM构建预测模型，其预测效果优于常用的支持向量机(support vector machine，SVM)。Qin等在RVM的基础上利用特征向量选择方法去除冗余数据，提出了一种基于特征向量选择的RVM锂电池RUL预测方法，它改善了关联向量的稀疏性并提高了RUL预

测精度[8]。但是，传统的机器学习方法未能充分挖掘时间序列信息，预测的准确率过低且挖掘复杂数据中有效信息的能力不强。

在面对大规模、高维度数据时，深度置信网络(deep belief network，DBN)、卷积神经网络(convolutional neural network，CNN)对海量数据的特征提取能力较强。ZHANG等提出一种多目标DBN集成方法，结合传统的训练方法，计算每个DBN网络输出在多个DBN组合网络中的权重，并在NASA的航空发动机数据集上取得更高的预测精度[9]。马忠等对CNN进行改进，使用多种一维卷积提取序列特征，并与DBN等方法对比，证明此方法有更高的预测精度[10]。DBN可以实现数据从低级到高级特征的提取与表示，但是没有对数据中时间序列信息进行学习，所以在长期预测时效果较差。

在面对包含时间序列性特点的数据时，循环神经网络(recurrent neural network，RNN)、长短时记忆神经网络(long short- term memory，LSTM)等序列模型具有明显优势，能够完整地表达高维特征信息。Zhang等为了提高预测的鲁棒性，提出一种CNN和RNN的混合模型，它能够提取局部特征和退化特征信息，并在NASA的多个数据集上进行实验，证明该方法的有效性[11]。RNN充分考虑了航空发动机数据样本之间的关联性，但是寿命预测过程容易产生梯度消失和梯度爆炸等问题。基于上述问题，对RNN进行改进，提出LSTM模型。Kakati等将LSTM应用于航空涡轮发动机仿真数据预测，并提出一种在线实时更新模型训练的技术，实验结果表明，该方法的训练效率更高[12]。王鑫等利用多层网络搜索技术获取LSTM预测模型的优化参数，通过飞机故障实验，证明该算法可同时确保预测的精度与适用性[13]。Jiang等提出一种基于BiLSTM和多尺度CNN的RUL预估方法，此方法解决了长期依赖时间序列数据的问题，提高了对数据中退化特征的挖掘效率[14]。BiLSTM在处理时序数据方面较一般序列模

型有更强大的表征能力，然而提取特征信息的复杂度和深度过低。王太勇等引入注意力机制，提出一种基于BiLSTM的自适应故障诊断模型ABiLSTM，通过不同尺度BiLSTM提取深层次特征，注意力机制优化特征参数权重，此方法提高了模型诊断精度，实现了有效故障诊断[15]。但是，注意力机制忽略了数据的全局信息，该融合算法未考虑每条信息存在噪声数据。

因此，本文提出一种基于自训练权重的多尺度ABiLSTM剩余寿命预测方法(multi- scale self- training weights based on ABiLSTM，STW- MSABiLSTM)。以多尺度的BiLSTM网络为特征提取层，使用自训练权重(self- training weights，STW)在单特征内提取目标信息，通过注意力机制筛选多特征之间的关键信息，将各模型在NASA的C- MAPSS数据集上进行实验对比验证。

# 1 基于自训练权重的多尺度ABiLSTM模型

# 1.1 长短期记忆神经网络

作为处理时间序列数据的典型神经网络模型，RNN通过隐藏节点之间的相互连接，赋予了整个神经网络的记忆能力。对于RNN中的每一隐藏状态而言，其输入主要包括两个部分，一是正常接受输入数据的输入，二是将前一个隐藏状态节点作为下一个节点的输入。理论上RNN可以处理任意时序的输入序列，但是在实际应用中，RNN会面临2个挑战：梯度爆炸和梯度消失。因此，在RNN中引入细胞状态，构建LSTM模型。LSTM的神经单元结构如图1所示。

每一个LSTM的神经单元由细胞状态，以及输入门、遗忘门、输出门等3个门组成。

输入门用于处理当前神经单元的输入信息。整个的输入门包含2个部分，左侧通过sigmoid激活函数筛选出有效的输入信息，右侧通过tanh激

活函数构建出候选更新信息，添加到当前的细胞状态中。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/476c96b5a2e0eba4d27d3496e9e79309115b02db47cf558cddc71ff2a5b111b4.jpg)  
图1 LSTM神经单元结构 Fig.1 Structure of the LSTM neural unit

sigmoid端的计算公式为

$$
i_{t} = \sigma (W_{t}[h_{t - 1},x_{t}] + b_{t}) \tag{1}
$$

式中：  $i_{t}$  为输入门；  $\sigma$  为sigmoid激活函数；  $W_{t}$  为输入门权重矩阵；  $h_{t}$  为神经元输出；  $t$  为当前时刻；  $t - 1$  为上一时刻；  $b_{t}$  为其偏置项。

tanh端的计算公式为

$$
C_{t} = \tanh \left(W_{c}[h_{t - 1},x_{t}] + b_{c}\right) \tag{2}
$$

式中：  $W_{c}$  为记忆细胞权重矩阵；  $\bar{C}_t$  为  $t$  时刻备选更新信息；tanh()为激活函数。

遗忘门的主要作用是决定当前状态需要保留或丢弃上一时刻的信息。计算公式为

$$
f_{t} = \sigma (W_{t}[h_{t - 1},x_{t}] + b_{t}) \tag{3}
$$

式中：  $W_{t}$  为遗忘门权重矩阵。

输出门控制当前状态的输出信息，计算公式为

$$
O_{t} = \sigma (W_{0}[h_{t - 1},x_{t}] + b_{t}) \tag{4}
$$

式中：  $W_{0}$  为输出门权重矩阵。

LSTM神经单元的输出信息  $H_{t}$  为将细胞状态通过tanh激活函数进行归一化处理，并将其与输出门  $O_{t}$  的输出相乘，从而确定最终输出信息。

$$
H_{t} = O_{t}\tanh C_{t} \tag{5}
$$

式中：  $C_{t}$  为  $t$  时刻的记忆细胞状态。

细胞状态是一个信息存储的容器，通过遗忘门、输入门和输出门的过程，更新容器内的信息，计算公式为

$$
C_{t} = C_{t - 1}f_{t} + i_{t}\overline{C}_{t} \tag{6}
$$

式中：  $C_{t - 1}$  为  $t - 1$  时刻的记忆细胞状态。

LSTM是一种RNN特殊的变体，可以学习长期依赖信息，以有效保证提取信息的时间逻辑合理性，提高预测的准确率。

在BiLSTM神经网络的基础上，本文通过引

入注意力机制，提出一种新的融合层算法——自训练权重，建立了一种基于自训练权重的多尺度ABiLSTM模型(如图2所示)，用于多参数的航空发动机RUL预测。该模型由输入层、多尺度特征提取层、参数自训练融合层、注意力层、池化层以及输出层组成。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/5818a706fa4206991a572429c507f44c9c9c6f98b41039300ea39bbc58cb53d5.jpg)  
图2基于自训练权重的多尺度ABiLSTM模型 Fig.2 Multi-scale ABiLSTM model based on self-training weights

输入层将传感器模拟采集的发动机原始数据进行数据处理，构造满足要求的输入数据格式，并划分相应的训练集与测试集。多尺度特征提取层包含不同尺度的BiLSTM网络，分别为单层BiLSTM、双层BiLSTM等。多尺度的BiLSTM可提取由浅入深、不同尺度的多重特征，抽取的信息内容更加丰富，从而可以提高模型的表达能力。但是，需要提取的特征尺度越多，包含的BiLSTM层数也会越多，相应的模型参数越多。因此，本文就BiLSTM的层数调整进行探究，以实现模型精度与模型复杂度之间的平衡。

参数自训练融合层采用自训练权重对提取的不同尺度特征进行拼接，对单特征内的每条信息赋予权重，以提升模型的融合效果。注意力层对拼接组成的特征矩阵进行参数权重的优化，实现在多特征之间筛选目标特征，并输出至池化层。池化层通过池化和降低维度，减少参数量。最后，输出层通过全连接层输出预测结果。

该模型采用均方差(mean squared error，MSE)

损失函数进行训练，用来衡量模型的预测值与真实值之间的差距，从而指明模型优化方向。其具体计算公式为

$$
Output = \frac{1}{m}\sum_{i = 1}^{m}(y_{\mathrm{test}}^{i} - y_{\mathrm{label}}^{i})^{2} \tag{7}
$$

式中：  $m$  为样本数量；  $y_{\mathrm{test}}^{i}$  为模型的预测值；  $y_{\mathrm{label}}^{i}$  为样本的真实值。

# 1.2自训练权重

传统的融合层一般采用concat拼接操作，这种算法默认参数权重全取固定值。然而，单特征内部的多条信息肯定包含重点信息和噪声信息，即每条信息需要进行权重参数的优化，从而获得所需的目标信息。

本文提出一种新的融合层算法——自训练权重算法，通过提取的多尺度特征，计算相应的输出权重参数，在参数自训练融合层赋予特征矩阵权重，进而通过add拼接组合特征信息。如图2所示，通过三尺度的BiLSTM网络输出为  $H_{1}$ ，  $H_{2}$  和

$H_{3}$ ，相应的权重计算公式为

$$
\alpha = \frac{\sigma(H_1)}{\sigma(H_1) + \sigma(H_2) + \sigma(H_3)} \tag{8}
$$

$$
\beta = \frac{\sigma(H_2)}{\sigma(H_1) + \sigma(H_2) + \sigma(H_3)} \tag{9}
$$

$$
\gamma = \frac{\sigma(H_3)}{\sigma(H_1) + \sigma(H_2) + \sigma(H_3)} \tag{10}
$$

$$
\alpha +\beta +\gamma = 1 \tag{11}
$$

式中：  $\alpha$  为  $H_{1}$  相应的权重值；  $\beta$  为  $H_{2}$  相应的权重值；  $\gamma$  为  $H_{3}$  相应的权重值。

经过参数自训练融合层拼接的特征矩阵为

$$
\pmb {K}_i = \alpha \cdot \pmb {H}_1 + \beta \cdot \pmb {H}_2 + \gamma \cdot \pmb {H}_3 \tag{12}
$$

# 1.3注意力机制

注意力机制(attention mechanism, AM)是一种研究人类视觉的机制，主要包含两个方面：一是关注重点信息；二是对重点信息和噪声信息赋予不同的权重。因此，对于RUL预测问题引入注意力机制很有必要。该机制可以从发动机多参数中筛选关键特征信息，滤除冗余信息，实现多特征之间的权重参数优化，进而提升预测精度。注意力机制原理如图3所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/d1acfc4287762958c98ec174f9e7f255475404db5502328f49db9dc90d0fc67a.jpg)  
图3注意力机制原理 Fig.3 Principle of attention mechanism

通过参数自训练融合层拼接的特征矩阵  $K_{i}$  经过全连接层计算每个特征所得到的参数权重，

再经过SoftMax层将特征权重进行归一化，得到权重概率  $P_{i}$  。最后，将权重概率  $P_{i}$  与原始特征矩阵  $K_{i}$  加权，得到目标特征矩阵。其具体的计算公式为

$$
W_{i} = f_{\mathrm{att}}(K_{i}) \tag{13}
$$

$$
\pmb {P}_i = \mathrm{softmax}(\pmb {W}_i) \tag{14}
$$

$$
C_i = \sum P_i K_i \tag{15}
$$

式中：  $f_{\mathrm{att}}$  为全连接层，用于计算注意力的分配； $P_{i}$  是归一化后的权重概率，常用softmax()激活函数计算得到；  $W_{i}$  为所得特征参数权重，表示目标值与样本标签值的相关性；  $K_{i}$  为原始特征矩阵。

自训练权重与注意力机制的主要差别是：参数自训练是对于单个特征内部的信息进行权重参数的优化，对特征内部输入batch大小的数据提取有效的信息。而注意力机制是针对多特征之间信息权重参数优化，计算多个特征之间的相关性，在多特征信息中筛选目标特征，剔除噪声特征。自训练权重是局部抽取特征内部信息，注意力机制则是实现多特征之间的“全局”抽取。因此，参数自训练融合层有以下优点： $①$  提升模型融合效果。单个特征每条输入数据都可以筛选目标信息，滤除冗余信息。对每条信息进行权重参数的优化，避免冗余信息的干扰，从而增强模型的融合效果；  $(2)$  模型的可解释性。一般的concat拼接默认固定权重，每条抽取的信息应该有权重之分，人为主观判断权重参数缺乏可解释性，参数自训练可以让模型在训练过程中确定模块的权重参数，以此提高模型的可解释性。

# 2基于自训练权重的多尺度ABI LSTM模型实验

# 2.1数据集

本文实验基于国际预测和健康管理会议(PHM08)上的预测挑战比赛数据集，该数据集由NASA提供，是RUL预测领域公认的权威数据集。它采用C- MAPSS

模拟仿真航空燃气涡轮发动机在不同环境和故障条件下的运行情况，从而获得4组模拟监测数据。数据集由多个多元时间序列构成，每组数据进一步划分为训练集、测试集和RUL数据集，并且每台发动机有不同程度的初始磨损和制造变化，以及含有大量的传感器噪声数据。

C- MAPSS的仿真结果，由风扇、低压压缩机(low pressure compressor, LPC)、高压压缩机(high pressure compressor, HPC)、低压涡轮(low pressure turbine, LPT)和高压涡轮(high pressure turbine, HPT)等五部分组成。为了实时监测发动机性能，利用21个机载传感器在多个地点测量速度、温度和压力。通过3个上限调节器，限制发动机超过核心转速、发动机压力比和高压涡轮出口温度。其中，1个限制调节器用于防止高压压缩机出口的静压过低，并通过加速和减速限制调节器限制核心速度。C- MAPSS提供了一组图形用户界面，以简化输入和输出控制，用于各种可能的用途，包括开环分析、控制器设计和各种情况下发动机及其控制系统的响应仿真。

该数据集包含1种操作时间周期、3种运行参数和21种传感器信号参数，部分数据集描述如表1所示。本文实验部分以4组监测数据中编号为FD001的数据集为例展示实验过程以及分析结果，其为100台发动机的训练数据(共计20631条样本数据)、测试数据(共计13096条样本数据)和测试样例对应的100条真实RUL值。其中，rpm是速度单位，代表的是转速；psia是电压；lbm是热力学卡。

# 2.2 数据处理、网络设置及评价指标

由于原始数据含有大量的噪声数据，为了便于模型训练获取更高的预测精度，需要对数据集进行预处理操作。

首先，获取该数据集的主要数据指标，然后根据数据指标，剔除掉3个人为设置的操作变量，即标准差为0的特征，这些特征为恒定值，在数

据中没有任何变化，对RUL预测没有影响。

表1数据集描述Table 1 Description of dataset  

<table><tr><td>描述</td><td>单位</td></tr><tr><td>风扇入口总温度</td><td>°R</td></tr><tr><td>低压压缩机进气道总温度</td><td>°R</td></tr><tr><td>高压压缩机进气道总温度</td><td>°R</td></tr><tr><td>低压涡轮进气道总温度</td><td>°R</td></tr><tr><td>风机进口压力</td><td>psia</td></tr><tr><td>旁路管道总压</td><td>psia</td></tr><tr><td>高压压缩机出口处总压力</td><td>psia</td></tr><tr><td>发动机压力比(P50/P2)</td><td></td></tr><tr><td>物理风机转速</td><td>r/min</td></tr><tr><td>物理核心速度</td><td>r/min</td></tr><tr><td>高压压缩机出口静压</td><td>r/min</td></tr><tr><td>燃料流量与PS30的比率</td><td>pps/psi</td></tr><tr><td>修正风机转速</td><td>r/min</td></tr><tr><td>修正核心转速</td><td>r/min</td></tr><tr><td>涵道比</td><td>rpm</td></tr><tr><td>要求的风扇转速</td><td>r/pm</td></tr><tr><td>要求的修正风扇转速</td><td></td></tr><tr><td>燃烧器燃气比例</td><td></td></tr><tr><td>放气热含量</td><td></td></tr><tr><td>高压涡轮冷却剂释放速度</td><td>lbm/s</td></tr><tr><td>低压涡轮冷却剂释放速度</td><td>lbm/s</td></tr></table>

其次，参考数据指标获取异常值，依据箱线图对异常值进行处理。本文使用前后均值替换异常值的方式来处理异常值。对于部分异常值相邻的情况，虽然经过前后均值替换，但仍存在异常数据，因此对部分异常值采取整体均值替换的方式进行处理。经过异常值的处理后，由主要数据指标对特征进一步筛选，删除变化波动不大的特征。最终，本文使用处理后的17维数据进行实验。

最后，本文采用Z- score标准化方法对数据集进行归一化，并随机划分80%为训练集和20%为测试集用于模型的训练。Z- score标准化方法也称标准差标准化，是当前主要的数据标准化方式。归一化所得的新数据序列，其计算公式为

$$
y_{i} = \frac{x_{i} - \bar{x}}{s} \tag{16}
$$

$$
\bar{x} = \frac{1}{n}\sum_{i = 1}^{n}x_{i} \tag{17}
$$

$$
s = \sqrt{\frac{1}{n - 1}\sum_{i = 1}^{n}(x_i - \bar{x})^2} \tag{18}
$$

式中：  $x_{i}$  为原始数据序列；  $\bar{x}$  原始数据均值；  $s$  原始数据的标准差；  $n$  为样本数据个数。

网络参数的设置影响构建模型的训练效果，具体参数设置如表2所示。

表2模型参数设置  

<table><tr><td>参数</td><td>取值</td></tr><tr><td>激活函数</td><td>tanh_shrink</td></tr><tr><td>优化器</td><td>Adam</td></tr><tr><td>初始学习率</td><td>0.003</td></tr><tr><td>批量尺寸</td><td>100</td></tr><tr><td>训练周期/个</td><td>100</td></tr></table>

本文使用两种常见的评价指标来衡量模型的准确度，分别为准确率(accuracy，Acc)和均方根误差(root mean square error，RMSE)。两种评价指标的计算公式分别为

$$
Acc(y,\hat{y}) = \frac{1}{n}\sum_{t = 0}^{n}\Pi (y_t = \hat{y}_t) \tag{19}
$$

$$
RMSE = \sqrt{\frac{1}{n}\sum_{t = 1}^{n}(\hat{y}_t - y_t)^2} \tag{20}
$$

式中：  $y_{i}$  为正确的目标样本标签值；  $\hat{y}_i$  为相应样本的预测值；  $\hat{y}_i$  为标签值；  $y_{i}$  为预测值。

# 2.3实验结果与分析

本文针对基于自训练权重的多尺度ABiLSTM的网络结构和模型参数进行实验，通过实验比较不同参数组合下模型的预测性能，进而获得最优预测模型。实验中使用准确率、RMSE指标以及训练时间对不同模型的RUL预测结果进行评估，实验共分为以下3部分：

(1)通过对比试验，探究BiLSTM网络层数对RUL预测结果的影响，确定特征融合的尺度。

(2)通过消融实验，探究自训练权重和注意力机制对RUL预测结果的影响。

(3)通过对比实验，探究基于自训练权重的多尺度ABiLSTM模型的预测效果。

# 2.3.1BiLSTM网络层数对比实验

BiLSTM网络层数与提取的特征尺度成正相关，特征尺度越多，相应的BiLSTM层数越多，导致模型的参数也相应的增多。为此，本文需要在模型预测精度和模型复杂度之间找到平衡点，验证不同尺度下模型的性能，通过不同尺度的BiLSTM网络进行训练，确定特征融合尺度。模型尺度分别为单层ABiLSTM、双尺度ABiLSTM、三尺度ABiLSTM以及四尺度ABiLSTM，不同尺度训练参数设置如表3所示。得到不同尺度下的RUL预测结果如表4所示。不同尺度下BiLSTM网络的RUL真实值与预测值对比曲线图如图4~7所示。

表3不同尺度训练参数设置

Table 3 Settings of different scale training parameters  

<table><tr><td>ABiLSTM模型尺度</td><td>BiLSTM层数</td><td>BiLSTM层节点数</td></tr><tr><td>1</td><td>1</td><td>8</td></tr><tr><td>2</td><td>2</td><td>8,16</td></tr><tr><td>3</td><td>3</td><td>8,16,64</td></tr><tr><td>4</td><td>4</td><td>8,16,64,128</td></tr></table>

表3中第3列BiLSTM层节点数依次为第1层节点数、第2层节点数等。

表4不同尺度下的RUL预测结果 Table 4 Results of RUL prediction based on different scales  

<table><tr><td>ABiLSTM模型尺度</td><td>准确率/%</td><td>RMSE</td><td>训练时间/s</td></tr><tr><td>1</td><td>91.61</td><td>8.98</td><td>264</td></tr><tr><td>2</td><td>92.51</td><td>7.55</td><td>488</td></tr><tr><td>3</td><td>94.47</td><td>7.38</td><td>664</td></tr><tr><td>4</td><td>94.40</td><td>7.51</td><td>889</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/a760615f648f0efc6de4967adf88cf07b929017ca75dce5a25afb22c94b28744.jpg)  
图4 ABiLSM_1的RUL真实值与预测值对比曲线 Fig.4 Contrast curve between true and predicted RUL of ABiLSM_1

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/e130cdb53bf3bbf22d1795e92a0cf07a136f287a3418d1950c4a249b66f3b1e0.jpg)  
图6 ABiLSM_3的RUL真实值与预测值对比曲线 Fig.6 Contrast curve between true and predicted RUL of ABiLSM_3

由表4可知，随着层数和BiLSTM层节点数的增加，实验结果的准确率逐渐升高，模型的训练时间也逐渐变长即训练成本越高。三尺度ABiLSTM和四尺度ABiLSTM模型在准确率这一指标上效果相近，但三尺度ABiLSTM在RMSE指标上较四尺度ABiLSTM模型降低了  $1.73\%$  ，并且三尺度ABiLSTM训练成本较小。说明了层数和节点数过多将极度放大多个特征对模型训练的影响，导致模型预测结果的不稳定和不确定性。因此，综合考虑训练成本和效果，本文选取三尺度BiLSTM作为多尺度特征提取层。

由图4~7可知，随着BiLSTM网络层数的增加，RUL预测的结果逐渐趋于真实值，拟合效果逐渐得到提升。因此，多尺度BiLSTM网络可提取多重特征，使得抽取的信息内容更加丰富，从而提高模型的表达能力，证明多尺度BiLSTM网络的有效性。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/eab22052b7814cc05bd1e8eedbaa21d82c61e51e83804eb93dcd0610e124e413.jpg)  
图5 ABiLSM_2的RUL真实值与预测值对比曲线 Fig.5 Contrast curve between true and predicted RUL of ABiLSM_2

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/788923eef3f1642617e08120a192378d984296729acecd00682f1b1b04e4225f.jpg)  
图7 ABiLSM_4的RUL真实值与预测值对比曲线 Fig.7 Contrast curve between true and predicted RUL of ABiLSM_4

# 2.3.2 消融实验

在2.3.1节确定了提取特征尺度的基础上，本节进行了三尺度BiLSTM模型与三尺度BiLSTM+Attention、三尺度BiLSTM模型与三尺度的BiLSTM+自训练权重(STW)的两组消融实验。最终的消融实验结果如表5所示，相应模型的RUL真实值与预测值对比曲线图如图8~10所示。

表5消融实验的准确率、RMSE和训练时间指标 Table 5 Accuracy, RMSE and training time of ablation experiment  

<table><tr><td>BiLSTM 模型</td><td>准确率/%</td><td>RMSE</td><td>训练时间/s</td></tr><tr><td>3</td><td>93.15</td><td>8.47</td><td>639</td></tr><tr><td>3+Attention</td><td>94.47</td><td>7.38</td><td>664</td></tr><tr><td>3+STW</td><td>94.76</td><td>8.07</td><td>804</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/f0d72fae5b737c7185d6d54e51af3e9a20094bb7c33275c02f0c434a848140fb.jpg)  
图8 BiLSTM_3的RUL真实值与预测值对比曲线 Fig.8 Contrast curve between true and predicted RUL of BiLSTM_3

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/0ba48abcb33214597d144a0f27c622d755a30ffa08a997aec61bb0425e7a2c04.jpg)  
图9 BiLSTM_3+Attention的RUL真实值与预测值对比曲线 Fig.9 Contrast curve between true and predicted RUL of BiLSTM_3+Attention

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/074d550c424d9a95f0b430b8e2d217f1dd5f363e5e9eff278a1609e67da5717e.jpg)  
图10 BiLSTM_3+STW的RUL真实值与预测值对比曲线 Fig.10 Contrast curve between true and predicted RUL of BiLSTM_3+STW

由表5可得，基于注意力机制的三尺度BiLSTM模型RUL预测效果分别在准确率和RMSE指标上优于三尺度BiLSTM模型  $1.32\%$ $12.87\%$  。同时，基于自训练权重的三尺度

BiLSTM模型RUL预测结果优于三尺度BiLSTM模型  $1.61\%$  ，  $4.72\%$  。证明自训练权重对单特征内的每条信息参数权重优化的效果，明显比一般的融合算法融合效果好，增强了模型的可解释性。同时证明注意力机制在多特征之间筛选目标信息、滤除余特征的强大能力。尽管BiLSTM_3+Attention和BiLSTM_3+自训练权重2种模型的训练时间有所增长，但在可以接受的合理范围内。

由图8~10可知，在预测的初始阶段，预测的结果震荡较大，在后期逐渐与真实值相拟合。相较于BiLSTM_3预测的RUL值，BiLSTM_3+Attention与BiLSTM_3+STW更加趋于真实值，并且预测初始阶段波动较小。由此，表明注意力机制可实现关键特征的筛选，从而提高模型的预测精度，自训练权重可以提高模型的融合效果，进而提升预测效果。

# 2.3.3 模型对比实验

为了证明本文模型的预测效果，本节进行本文模型与其他6种模型的对比实验，这6种模型分别为多层感知机(multi_layer perceptron，MLP)、支持向量回归(support vector regression，SVR)、CNN[16]、单层LSTM、卷积自编码(convolutional autoencoder，CAE)LSTM[17]和三尺度ABiLSTM。最终的模型对比实验结果如表6所示。本文提出模型的RUL真实值与预测值对比曲线图如图11所示。

表6不同模型对比实验的准确率、RMSE指标 Table 6 Accuracy and RMSE of different models' comparative experiment  

<table><tr><td>模型</td><td>准确率/%</td><td>RMSE</td></tr><tr><td>MLP</td><td>-</td><td>37.56</td></tr><tr><td>SVR</td><td>-</td><td>20.96</td></tr><tr><td>CNN</td><td>-</td><td>18.45</td></tr><tr><td>单层LSTM</td><td>83.58</td><td>14.60</td></tr><tr><td>CAE-LSTM</td><td>92.51</td><td>10.84</td></tr><tr><td>三尺度的ABiLSTM</td><td>94.47</td><td>7.38</td></tr><tr><td>STW-MSABiLSTM</td><td>96.33</td><td>7.27</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/4c3f6201-3a73-481b-8922-631b76e2d2ac/95bfb835867b391236e7abfe025dec657cd481ae638c0693ba78280090fe7f28.jpg)  
图11 STW-MSABiLSTM的RUL真实值与预测值对比曲线 Fig.11 Contrast curve between true and predicted RUL of STW-MSABiLSTM

由图11可知，虽然预测周期在55~65振荡较大，但本文模型预测曲线基本与真实值相拟合。由表6可知，与MLP、SVR传统的机器学习方法进行横向对比，后5种深度学习方法在RMSE指标上取得了更好的预测效果。例如，CNN预测效果在RMSE指标上优于MLP模型  $50.88\%$  ，优于SVR模型  $11.98\%$  。可见，深度学习在剩余寿命预测领域带来巨大提升。同时，将5种深度学习方法进行纵向对比。首先，由于LSTM模型在解决时间序列数据问题上占有优势，则较CNN模型RMSE降低了  $20.87\%$  。其次，不同尺度的BiLSTM网络可提取多重特征，保证信息的完整性与注意力机制对目标特征的提取，使得三尺度ABiLSTM模型预测效果在准确率和RMSE指标上均优于CAE- LSTM模型  $1.96\%$  和  $31.92\%$  。最后，本文提出的基于自训练权重的多尺度ABiLSTM模型，RUL预测效果分别在准确率和RMSE指标上优于三尺度ABiLSTM模型  $1.86\%$  和  $1.49\%$  ，优于CAE- LSTM模型  $3.82\%$  和  $32.93\%$  。实验结果表明，本文提出的自训练权重极大提升了模型的融合效果，提高了模型的预测精度。

# 3 结论

对于航空发动机数据维度高、非线性和系统复杂等挑战，本文提出一种基于自训练权重的多尺度ABiLSTM模型用于RUL预测问题。首先，

使用若干不同尺度的BiLSTM由浅入深地提取不同尺度的多重特征，通过实验探究不同BiLSTM网络层数对RUL预测结果的影响，实验证明随着网络层数和节点数增多，RUL预测准确率逐渐升高，三尺度BiLSTM预测效果在RMSE指标上优于四尺度BiLSTM  $1.73\%$  且训练成本较低，所以本文确定三尺度BiLSTM为特征提取层。其次，本文提出了一种基于自训练权重的融合算法，通过消融实验证明基于自训练权重的三尺度BiLSTM模型在准确率和RMSE指标上优于三尺度BiLSTM模型  $1.61\%$  ，  $4.72\%$  。实验结果表明，该融合算法可对单特征内的参数权重优化，进而提升模型的融合效果。并且，本文引入注意力机制对不同尺度下的多特征参数权重优化，通过消融实验证明基于注意力机制的三尺度BiLSTM模型RUL预测结果优于三尺度BiLSTM模型  $1.32\%$  、  $12.87\%$  ，说明注意力机制对目标特征的筛选十分有效。最后，将本文模型与其他6种模型对比，实验表明，相比其他6种方法，使用本文预测模型预测精度有所提升，本文模型RUL预测效果在准确率和RMSE指标上优于三尺度ABiLSTM模型  $1.86\%$  和  $1.49\%$  ，优于CAE- LSTM模型  $3.82\%$  和  $32.93\%$  。

本文提出的融合层算法具有良好的泛化性，通过注意力机制可对不同尺度的特征提取关键信息，从而提高RUL的预测精度。但是，本文仍然有一些后续工作值得研究：

(1)本文的数据虽然已经经过异常值等处理，数据依然存在拖尾效应，仍需要依据专业的知识经验进行特征信息筛选。

(2)本文引入注意力机制进行目标特征筛选，造成一定的信息缺失，下一步考虑引入Transformer，考察其对预测效果的影响。

(3)本文仅使用提供的4组监测数据集，并在其上取得了很好的预测效果。下一步将在更多的发动机数据集上进一步应用本文模型，以验证本文模型的鲁棒性。

# 参考文献：

[1] 孔祥伟, 王丹, 吴瑀, 等. 基于堆叠稀疏自编码神经网络的航空发动机剩余寿命预测方法研究[J]. 计算机测量与控制, 2019, 27(12): 29- 33, 38. Kong Xiangwei, Wang Dan, Wu Yu, et al. Research on Prediction Method of Aeroengine Residual Life Based on Stacked Sparse Automatic Encoder[J]. Computer Measurement & Control, 2019, 27(12): 29- 33, 38. [2] 葛承垄, 朱元昌, 邱彦强, 等. 面向装备RUL预测的平行仿真框架[J]. 系统仿真学报, 2018, 30(6): 2216- 2224. Ge Chenglong, Zhu Yuanchang, Di Yanqiang, et al. Equipment RUL Prediction Oriented Parallel Simulation Framework[J]. Journal of System Simulation, 2018, 30(6): 2216- 2224. [3] 温海茹. 基于深度学习的航空发动机剩余使用寿命预测研究[J]. 内燃机与配件, 2020(3): 41- 42. Wen Hairu. Research on Remaining Life Prediction of Aero- engine Based on Deep Learning[J]. Internal Combustion Engine & Parts, 2020(3): 41- 42. [4] 皮骏, 高树伟, 黄江博, 等. 基于QAR数据的涡轮叶片疲劳寿命预测[J]. 系统仿真学报, 2019, 31(6): 1165- 1171. Pi Jun, Gao Shuwei, Huang Jiangbo, et al. Fatigue Life Prediction of Turbine Blades Based on QAR Data[J]. Journal of System Simulation, 2019, 31(6): 1165- 1171. [5] 张朝龙, 何怡刚, 袁莉芬. 基于CPSO- RVM的锂电池剩余寿命预测方法[J]. 系统仿真学报, 2018, 30(5): 1935- 1940. Zhang Chaolong, He Yigang, Yuan Lifen. Approach for Lithiumion Battery RUL Prognostics Based on CPSO- RVM[J]. Journal of System Simulation, 2018, 30(5): 1935- 1940. [6] 赵申坤, 姜潮, 龙湘云. 一种基于数据驱动和贝叶斯理论的机械系统剩余寿命预测方法[J]. 机械工程学报, 2018, 54(12): 115- 124. Zhao Shenkun, Jiang Chao, Long Xiangyun. Remaining Useful Life Estimation of Mechanical Systems Based on the Data- driven Method and Bayesian Theory[J]. Journal of Mechanical Engineering, 2018, 54(12): 115- 124. [7] 彭鸿博, 蒋雄伟. 基于相关向量机的发动机剩余寿命预测[J]. 科学技术与工程, 2020, 20(18): 7538- 7544. Peng Hongbo, Jiang Xiongwei. Remaining Useful Life Prediction for Aeroengine Based on Relevance Vector Machine[J]. Science Technology and Engineering, 2020, 20(18): 7538- 7544. [8] Qin X L, Zhao Q, Zhao H B, et al. Prognostics of Remaining Useful Life for Lithiumion Batteries Based on a Feature Vector Selection and Relevance Vector Machine Approach [C]// 2017 IEEE International Conference on Prognostics and Health Management (ICPHM). Dallas, TXUSA: IEEE, 2017: 1- 6. [9] ZHANG C, LIM L, QIN A K, et al. Multiobjective Deep Belief Networks Ensemble for Remaining Useful Life Estimation in Prognostics[J]. IEEE Transactions on Neural Networks & Learning Systems (S2162- 2388), 2016, 28(10): 2306- 2318. [10] 马忠, 郭建胜, 顾涛勇, 等. 基于改进卷积神经网络的航空发动机剩余寿命预测[J]. 空军工程大学学报(自然科学版), 2020, 21(6): 19- 25. Ma Zhong, Guo Jiansheng, Gu Taoyong, et al. A Remaining Useful Life Prediction for Aero- Engine Based on Improved Convolution Neural Networks[J]. Journal of Air Force Engineering University(Natural Science Edition), 2020, 21(6): 19- 25. [11] Zhang X, Dong Y, Wen L, et al. Remaining Useful Life Estimation Based on a New Convolutional and Recurrent Neural Network[C]// 2019 IEEE 15th International Conference on Automation Science and Engineering (CASE). Vancouver, BC, Canada: IEEE, 2019: 317- 322. [12] Kakati P, Dandotiya D, Pal B. Remaining Useful Life Predictions for Turbolian Engine Degradation Using Online Long Short- Term Memory Network[C]// ASME 2019 Gas Turbine India Conference. Chennai, Tamil Nadu, India: ASME, 2019: 1- 7. [13] 王鑫, 吴际, 刘超, 等. 基于LSTM循环神经网络的故障时间序列预测[J]. 北京航空航天大学学报, 2018, 44(4): 772- 784. Wang Xin, Wu Ji, Liu Chao, et al. Exploring LSTM Based Recurrent Neural Network for Failure Time Series Prediction[J]. Journal of Beijing University of Aeronautics and Astronautics, 2018, 44(4): 772- 784. [14] Jiang Y, Lu Y, Wang Y, et al. Fusion Network Combined With Bidirectional LSTM Network and Multiscale CNN for Remaining Useful Life Estimation[C]// 2020 12th International Conference on Advanced Computational Intelligence (ICACI). Dali, China: IEEE, 2020: 620- 627. [15] 王太勇, 王廷虎, 王鹏, 等. 基于注意力机制BiLSTM的设备智能故障诊断方法[J]. 天津大学学报, 2020, 53(6): 601- 608. Wang Taiyong, Wang Tinghu, Wang Peng, et al. An Intelligent Fault Diagnosis Method Based on Attention- Based Bidirectional LSTM Network[J]. Journal of Tianjin University, 2020, 53(6): 601- 608. [16] Babu G S, Zhao P, Li X L. Deep Convolutional Neural Network Based Regression Approach for Estimation of Remaining Useful Life[C]// International Conference on Database Systems for Advanced Applications. Berlin, Springer, Cham, 2016: 214- 228.

[9] ZHANG C, LIM L, QIN A K, et al. Multiobjective Deep Belief Networks Ensemble for Remaining Useful Life Estimation in Prognostics[J]. IEEE Transactions on Neural Networks & Learning Systems (S2162- 2388), 2016, 28(10): 2306- 2318. [10] 马忠, 郭建胜. 顾涛勇, 等. 基于改进卷积神经网络的航空发动机剩余寿命预测[J]. 空军工程大学学报(自然科学版), 2020, 21(6): 19- 25. Ma Zhong, Guo Jiansheng, Gu Taoyong, et al. A Remaining Useful Life Prediction for Aero- Engine Based on Improved Convolution Neural Networks[J]. Journal of Air Force Enginering University(Natural Science Edition), 2020, 21(6): 19- 25. [11] Zhang X, Dong Y, Wen L, et al. Remaining Useful Life Estimation Based on a New Convolutional and Recurrent Neural Network[C]// 2019 IEEE 15th International Conference on Automation Science and Engineering (CASE). Vancouver, BC, Canada: IEEE, 2019: 311- 322. [12] Kakati P, Dandotiya D, Pal B. Remaining Useful Life Predictions for Turbolian Engine Degradation Using Online Long Short- Term Memory Network[C]// ASME 2019 Gas Turbine India Conference. Chennai, Tamil Nadu, India: ASME, 2019: 1- 7. [13] 王鑫, 吴际, 刘超,等. 基于LSTM循环神经网络的故障时间序列预测[J]. 北京航空航天大学学报, 2018, 44(4): 772- 784. Wang Xin, Wu Ji, Liu Chao, et al. Exploring LSTM Based Recurrent Neural Network for Failure Time Series Prediction[J]. Journal of Beijing University of Aeronautics and Astronautics, 2018, 44(5): 772- 784. [14] Jiang Y, Lu Y, Wang Y, et al. Fusion Network Combined With Bidirectional LSTM Network and Multiscale CNN for Remaining Useful Life Estimation[C]// 2020 12th International Conference on Advanced Computational Intelligence (ICACI). Dali, China: IEEE, 2020: 620- 627. [15] 王太原, 王廷虎, 王鹏, 等. 基于注意力机制BiLSTM的设备智能故障诊断方法[J]. 天津大学学报, 2020, 53(6): 601- 608. Wang Taiyong, Wang Tinghu, Wang Peng, et al. An Intelligent Fault Diagnosis Method Based on Attention- Based Bidirectional LSTM Network[J]. Journal of Tianjin University, D2020, 53(6): 601- 608. [16] Babu G S, Zhao P, Li X L. Deep Convolutional Neural Network Based Regression Approach for Estimation of Remaining Useful Life[C]// International Conference on Database Systems for Advanced Applications. Berlin, Springer, Cham, 2016: 214- 228.

[17] 王旭, 艾红. 基于CAE与LSTM的航空发动机剩余寿命预测[J]. 北京信息科技大学学报(自然科学版), 2020, 35(4): 57- 62. Wang Xu, Ai Hong. Prediction of the Remaining Life of

Aerospace Engine Based on CAE and LSTM[J]. Journal of Beijing Information Science & Technology University, 2020, 35(4): 57- 62.