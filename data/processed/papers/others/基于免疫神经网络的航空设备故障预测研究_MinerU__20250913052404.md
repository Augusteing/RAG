摘要：为解决武器装备全寿命周期费用高，经济可承受性差的难题，开展航空装备的故障预测技术研究。采用免疫算法改进隐含层激励函数得到免疫神经网络，用以进行装备特征参数的跟踪预测，结果表明免疫算法改进的神经网络可在故障前3小时实现预测，较BP网络性能有较大改善。

关键词：故障预测；免疫算法；免疫神经网络

DOI:10.3778/j.issn.1002- 8331.2011.20.064 文章编号：1002- 8331(2011)20- 0231- 03 文献标识码：A 中图分类号：TP206+3

随着武器系统性能的不断提升以及复杂性的不断增长，系统的可靠性、故障诊断与预测以及维修保障等问题越来越受到重视。支持视情维修的故障预测最早是从美国军方发展起来的装备保障技术，主要目的是提高武器系统的可靠性、降低装备的维修和保障费用[1- 2]

人工免疫系统是人们从生物免疫系统运行机制中获得灵感开发出来面向应用的免疫计算模型。作为计算智能的崭新分支，人工免疫系统逐步应用到模式识别、智能优化、数据挖掘、故障诊断等诸多领域，展现出强大的信息处理和问题求解能力。

# 1 免疫算法原理

由于人们对免疫机理中研究的角度不同、受到启发存在差别，所以产生的算法也不尽相同，但通常都称为免疫算法（Immune Algorithm, IA）[3- 5]。本文在进化计算理论框架基础上引入一个新的算子——免疫算子（Immune Operator），从而形成了免疫算法。

生物免疫功能主要由参与免疫反应的细胞或由其构成的器官完成，免疫细胞主要有两大类[6- 7]：一类为淋巴细胞，这类细胞因为对抗原的反映明显的专一性，属于特异性免疫（spe

cific immunity)反应的主要细胞；第二类为具有摄取抗原、处理抗原并将处理后的抗原以某种方式提供给淋巴细胞，其重要特征是在参与各种非特异性免疫(nonspecific immunity)反应的同时，也积极参与特异性免疫反应。

与生物免疫理论相似，免疫算子也分为两种类型：全免疫(full immunity)和目标免疫(target immunity)，两者分别对应于生物学中的非特异性免疫和特异性免疫。全免疫是指群体中每个个体在变异操作后，对其每一环节都进行一次免疫操作的免疫类型；目标免疫则是在个体进行变异操作后，经过一定判断，仅在作用点处发生免疫反映的一种类型。前者主要应用于个体进化的初始阶段，而在进化过程中基本上不发生作用，否则会较大的概率出现“同化现象”（assimilative phenomenon）；后者一般伴随群体进化的全进程，也就是免疫算法中的免疫算子。

实际应用中，问题的求解总是和问题本身的特点及其条件联系在一起的，免疫算法也遵循上述思路。首先，对待求解问题进行具体分析，从中提取最基本的特征信息；其次，对特征信息进行处理，将其转化为求解问题的一种方案；最后，将此方案以适当的形式转化为免疫算子以实施具体的操作。

需要指出的是针对同一待定抗原所能提取的疫苗可能不

止一种，则在接种疫苗过程中可随机地选取一种疫苗，也可以将多个疫苗按照一定的逻辑关系进行组合后再进行注射。

上述免疫思想主要是在合理提取疫苗的基础上，通过接种疫苗和免疫选择两个操作来事实现的，前者是为了提高适应度，后者是为了防止群体退化。免疫算法的执行流程如图1所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/5b9e3471-f9bb-4af7-97c1-8fa20368f885/b68ca7d130179106d06739dd086a2e9cee156c9b6dc67ac213949b16f508c36f.jpg)  
图1 免疫算法流程图

接种疫苗是指对个体按照问题特征信息来修改的某些基因位上的基因或分量，使得个体以较大的概率具有更高的适应度。接种疫苗应满足两个要求：第一，若个体  $y$  的每一个基因位上的信息都与最佳个体不同，则对于任意个体  $x$  转移的概率为0；第二，若个体  $x$  的每个基因位上的信息都与最佳个体相同，即  $x$  已为最佳个体，则  $x$  以概率1转移为  $x$  。设群体  $c = (x_{1},x_{2},\dots ,x_{n})$  ，对其进行接种疫苗是在  $c$  中按照比例  $\alpha$  随机抽取  $n_{\alpha} = \alpha \times n$  个个体进行操作。疫苗来源于待解决问题的先验知识，其所包含的信息及其准确性对算法的性能起着重要作用。

免疫选择一般分两步来完成。第一步是免疫检测，即对接种了疫苗的个体进行检测，若其适应度不如父代，说明在交叉、变异的过程中出现了严重的退化，将该个体用父代中对应的个体取代；第二步是退化选择，即在当前的子代群体中以概率选择个体进入下一代：

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/5b9e3471-f9bb-4af7-97c1-8fa20368f885/2c0af640fa28129efd5e2471394f41986ff258bd130e5b01363695d05db6c079.jpg)  
图2 免疫神经网络结构图

$$
u_{i} = f_{i}(X,V) \tag{2}
$$

式中，  $f_{i}(\cdot)$  为带有一系列参数  $V$  的函数族，该函数的选取及其中参数的确定与待求解问题相关，与BP神经网络中激励函数为通用阈值型或  $S$  型函数等不同。

由于激励函数、疫苗接种单元与待解决问题有关，故激励函数、疫苗接种单元设计是免疫神经网络的核心。免疫神经网络隐含层含有实际问题的特征信息，可使网络在训练时工作量减少，从而提高网络学习速度。

# 2.2 接种疫苗设计

根据课题研究故障预测问题的特点，设计神经元激励函数。设计为单隐含层网络，隐含层神经元激励函数为：

$$
f_{i}(x_{1},x_{2},\dots ,x_{n},\nu_{i}) = \frac{1}{mn} X^{\mathrm{T}}(\nu_{i})_{n\times m}Y \tag{3}
$$

式中，  $X = (x_{1},x_{2},\dots ,x_{n})$  为输入向量，  $Y = (y_{1},y_{2},\dots ,y_{m})^{\mathrm{T}}$  为输出向量，则有隐含层第  $i$  个神经元的评价函数：

$$
E_{i}(\nu_{1},\nu_{2},\dots ,\nu_{M}) = \frac{1}{2}\sum_{j = 1}^{m}(y_{j} - f_{i}(x_{1},x_{2},\dots ,x_{n},\nu_{j}))^{2} \tag{4}
$$

疫苗接种即在评价函数基础上对可调参数——疫苗向量  $V = (\nu_{1},\nu_{2},\dots ,\nu_{M})^{\mathrm{T}}$  进行优化，采用迭代函数如下：

$$
\nu_{i}(k + 1) = \nu_{i}(k) - \frac{\partial E_{i}(\nu_{1},\nu_{2},\cdots,\nu_{M})}{\partial\nu_{i}} \tag{5}
$$

式中，  $k$  为迭代步长。对上式进行循环迭代，直至评价函数值  $E_{i}(\nu_{1},\nu_{2},\dots ,\nu_{M})$  满足设定的网络训练目标。

$$
P(x_{i}) = \frac{\exp\left(\frac{f(x_{i})}{T_{k}}\right)}{\sum_{i = 1}^{n}\exp\left(\frac{f(x_{i})}{T_{k}}\right)}
$$

式中，  $f(x_{i})$  为个体  $x_{i}$  的适应度，  $\{T_{k}\}$  为趋近于0的温度控制序列。

# 2 免疫神经网络模型

# 2.1 免疫神经网络

在基本神经网络以及改进神经网络中，神经元只是简单地将输入信号进行求和，与阈值比较后产生输出信号，此类模型的突出特点是结构简单、通用性强，但忽略了具体问题的特征信息在求解问题时可能产生的积极、辅助作用，其具体表现是在模型中没有给待求解问题的特征信息留有接口。

鉴于上述原因，在原有神经网络模型中添加一个“疫苗接种单元”，以利用待求解问题的特征信息，旨在提高网络针对待求解问题的处理能力，具体结构如图2。

免疫神经网络模型中，将特征信息的接口在神经元的激励函数——将激励函数设计成可变形式，通过某些参数的调整可达到改变其具体形式的目的。

对于神经元  $i$  的激励函数设计成如下形式：

# 3 基于INN的故障预测实例

# 3.1 预测评价指标

神经网络中通常选用均方差作为评价预测结果的指标，仅用单一的指标来衡量故障预测模型的效果是不全面的，因此选用平均绝对误差、均方误差、平均绝对误差百分比、均方误差百分比和Pearson相关系数指标。

平均绝对误差：

$$
e_{\mathrm{MAE}} = \frac{1}{k}\sum_{i = 1}^{k}\left|t_{i}^{\prime} - t_{i}\right| \tag{6}
$$

均方误差：

$$
e_{\mathrm{MSE}} = \frac{1}{k}\sqrt{\sum_{i = 1}^{k}(t_{i}^{\prime} - t_{i})^{2}} \tag{7}
$$

平均绝对误差百分比：

$$
e_{\mathrm{MAPE}} = \frac{1}{k}\sum_{i = 1}^{k}\left|\frac{t_{i}^{\prime} - t_{i}}{t_{i}}\right| \tag{8}
$$

均方误差百分比：

$$
e_{\mathrm{MSE}} = \frac{1}{k}\sqrt{\sum_{i = 1}^{k}\left(\frac{t_{i}^{\prime} - t_{i}}{t_{i}}\right)^{2}} \tag{9}
$$

表1正常应力下累积工作时间数据  

<table><tr><td>参数值</td><td>1.00</td><td>1.01</td><td>1.02</td><td>1.03</td><td>1.04</td><td>1.05</td><td>1.06</td><td>1.08</td><td>1.10</td><td>1.12</td><td>1.14</td><td>1.16</td><td>1.18</td><td>1.20</td></tr><tr><td>装备1</td><td>0</td><td>576</td><td>852</td><td>1144</td><td>1228</td><td>1275</td><td>1514</td><td>1595</td><td>1691</td><td>1788</td><td>1891</td><td>1994</td><td>2048</td><td>2092</td></tr><tr><td>装备2</td><td>0</td><td>570</td><td>882</td><td>1110</td><td>1157</td><td>1299</td><td>1312</td><td>1531</td><td>1554</td><td>1752</td><td>1876</td><td>2009</td><td>2117</td><td>2124</td></tr><tr><td>装备3</td><td>0</td><td>585</td><td>865</td><td>1115</td><td>1279</td><td>1296</td><td>1474</td><td>1665</td><td>1787</td><td>1801</td><td>1877</td><td>1868</td><td>1971</td><td>2074</td></tr></table>

表2不同隐含层单元数时预测结果分析  

<table><tr><td rowspan="2">隐单元</td><td colspan="5">一步预测</td><td colspan="5">两步预测</td></tr><tr><td>eMAE</td><td>eMSE</td><td>eMAPF</td><td>eMSPE</td><td>ePR</td><td>eMAE</td><td>eMSE</td><td>eMAPF</td><td>eMSPE</td><td>ePR</td></tr><tr><td>6</td><td>48.64</td><td>18.08</td><td>0.029 7</td><td>0.012 0</td><td>0.999 5</td><td>57.14</td><td>21.65</td><td>0.033 4</td><td>0.013 0</td><td>0.999 7</td></tr><tr><td>7</td><td>44.02</td><td>17.49</td><td>0.026 9</td><td>0.011 1</td><td>0.999 6</td><td>57.40</td><td>21.90</td><td>0.035 6</td><td>0.013 4</td><td>0.999 7</td></tr><tr><td>8</td><td>42.71</td><td>18.54</td><td>0.025 7</td><td>0.011 5</td><td>0.999 6</td><td>53.24</td><td>20.19</td><td>0.031 9</td><td>0.012 6</td><td>0.999 7</td></tr><tr><td>9</td><td>45.28</td><td>18.85</td><td>0.030 0</td><td>0.011 9</td><td>0.999 5</td><td>55.67</td><td>22.19</td><td>0.034 5</td><td>0.013 2</td><td>0.999 7</td></tr><tr><td>10</td><td>47.20</td><td>18.18</td><td>0.028 5</td><td>0.011 5</td><td>0.999 6</td><td>60.76</td><td>22.75</td><td>0.036 2</td><td>0.014 1</td><td>0.999 6</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/5b9e3471-f9bb-4af7-97c1-8fa20368f885/89b89b68d19e343d515667a396cccf79d015cf6ac0969c6100c5a1cc5eb5b950.jpg)  
图3 免疫神经网络预测结果

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/5b9e3471-f9bb-4af7-97c1-8fa20368f885/45258568f6b15b53a24c90f25629b11ba5f470bdf20f8edd1fb1563de71dab5c.jpg)  
图4 免疫神经网络预测误差百分比

表4免疫神经网络与其他网络预测指标比较  

<table><tr><td rowspan="2">网络</td><td colspan="5">一步预测</td><td colspan="5">两步预测</td></tr><tr><td>eMAE</td><td>eMSE</td><td>eMAPF</td><td>eMSPE</td><td>ePR</td><td>eMAE</td><td>eMSE</td><td>eMAPF</td><td>eMSPE</td><td>ePR</td></tr><tr><td>INN</td><td>42.71</td><td>18.54</td><td>0.025 7</td><td>0.011 5</td><td>0.999 6</td><td>53.24</td><td>20.19</td><td>0.031 9</td><td>0.012 6</td><td>0.999 7</td></tr><tr><td>GNN</td><td>46.89</td><td>17.86</td><td>0.028 5</td><td>0.011 3</td><td>0.999 6</td><td>58.72</td><td>22.06</td><td>0.034 6</td><td>0.013 5</td><td>0.999 7</td></tr><tr><td>RNN</td><td>47.96</td><td>18.89</td><td>0.027 6</td><td>0.011 0</td><td>0.999 7</td><td>63.90</td><td>23.51</td><td>0.037 7</td><td>0.014 4</td><td>0.999 6</td></tr><tr><td>BP网络</td><td>57.18</td><td>21.27</td><td>0.031 9</td><td>0.013 2</td><td>0.999 4</td><td>64.32</td><td>24.25</td><td>0.038 9</td><td>0.015 4</td><td>0.999 5</td></tr></table>

Pearson相关系数：

$$
e_{\mathrm{PR}} = \frac{\sum_{i = 1}^{k}(t_{i} - \bar{t})(t_{i}' - \bar{t}')}{\sqrt{\sum_{i = 1}^{k}(t_{i} - \bar{t})^{2}}\sqrt{\sum_{i = 1}^{k}(t_{i}' - \bar{t})^{2}}} \tag{10}
$$

式中，  $\bar{t}$  为实际序列均值，  $\bar{t}^{\prime}$  为预测序列均值

综上说明，选用式（6）～（10）共五个评价指标对预测结果进行综合评价。

# 3.2 故障预测实例

跟踪某装备在实际工作环境中的使用状况，监测到三套装备的实际特征参数随累积工作时间变化数据如表1。

免疫神经网络采用四参数输入、两步预测对装备1进行预测，当隐含层单元数在6\~10间变化时，其预测结果指标如表2所示，选择隐含层单元数为8的网络结构。

采用上述免疫神经设计结构对装备1进行预测检验，预测值如表3、预测结果及误差百分比如图3、4所示；且免疫神经网络与粗糙神经网络、遗传神经网络和BP神经网络的预测指标比较如表4。

同理对表1中装备2、装备3分别采用免疫神经网方法进行预测，分析比较预测结果得到与装4相同结论，即改进网络

表3 免疫神经网络预测值  

<table><tr><td>参数值</td><td>1.04</td><td>1.05</td><td>1.06</td><td>1.08</td><td>1.10</td><td>1.12</td><td>1.14</td><td>1.16</td><td>1.18</td><td>1.20</td></tr><tr><td>一步预测</td><td>1 284</td><td>1 288</td><td>1 384</td><td>1 640</td><td>1 678</td><td>1 733</td><td>1 885</td><td>1 951</td><td>2 016</td><td>-</td></tr><tr><td>两步预测</td><td>-</td><td>1 337</td><td>1 366</td><td>1 540</td><td>1 701</td><td>1 723</td><td>1 826</td><td>1 946</td><td>1 997</td><td>2 089</td></tr><tr><td>实际监测</td><td>1 228</td><td>1 275</td><td>1 514</td><td>1 595</td><td>1 691</td><td>1 788</td><td>1 891</td><td>1 994</td><td>2 048</td><td>2 092</td></tr></table>

结构都较BP神经网络性能有加大改善，且各有优势：如粗糙神经网络平均绝对误差百分比较小，遗传神经网络的均方误差百分比较小，免疫神经网络的整体性能较优

# 4结论

为利用待求解问题的实际信息，将免疫算法引入神经网络改进神经元激励函数，设计得到免疫神经网络，并将免疫神经网络用于航空设备的故障预测，预测结果表明免疫神经网络较BP网络性能有很大改善，能在故障前3小时实现预测，且与粗糙神经网络、遗传神经网络相比，性能也较为突出。

目前免疫神经网络的激励函数确定主要依靠经验，提出通用的免疫神经网络激励函数确定方法是免疫神经网络未来的研究方向。

表1 不同处理机数下的计算时间以及加速比  

<table><tr><td>进程数</td><td>迭代次数</td><td>求解时间/s</td><td>加速比</td><td>效率/(%)</td></tr><tr><td>1</td><td>28</td><td>88.87</td><td>1.00</td><td>100.00</td></tr><tr><td>2</td><td>31</td><td>51.44</td><td>1.75</td><td>86.38</td></tr><tr><td>4</td><td>31</td><td>35.34</td><td>2.52</td><td>62.87</td></tr></table>

对位于对角线上的带状区域进行计算，随着对角线上的带状区域变窄，求解预条件子的计算量将减少，从而缩短了计算时间。然而求解预条件子的计算量减小相对于选代次数增加所导致的计算时间增长的影响来讲通常是可以忽略的，所以整体的并行效率将随着处理机数的增加而降低。

实验2调整剖分网格的间距使得模型描述更为精细，取值为  $350\times 160\times 6$  至  $1320\times 640\times 6$  ，表2中分别给出了由4个节点组成的并行系统在不同问题规模下的计算加速比和计算效率。

从表2可观察出，当问题规模为  $330\times 160\times 6\sim 1155\times 560\times 6$  的网格时，并行程序的计算效率仅为  $60\% \sim 70\%$  ，且随着规模的增大而增长缓慢。扩大问题规模到  $1188\times 576\times 6$  以上时，并行效率增长迅速，当网格数达到  $1320\times 640\times 6$  时达到了接近实验理想值的  $98.24\%$  。分析其原因一方面在于随着问题规模的扩大，计算初始化以及输入、输出的开销的比重将减小，并行程序将获得更高的计算效率。另一方面当问题规模达到一定程度，单机在计算取数据过程中存在大量的内外存交换开销，而并行系统大多数数据处理操作都是并行地在本地内存中执行，通信开销和计算开销均比较小。

表2 不同问题规模下的加速比和计算效率  

<table><tr><td>网格规模</td><td>迭代次数</td><td>求解时间/s</td><td>加速比</td><td>效率/(%)</td></tr><tr><td>330×160×6</td><td>32</td><td>8.95</td><td>2.47</td><td>61.75</td></tr><tr><td>660×320×6</td><td>31</td><td>35.34</td><td>2.52</td><td>62.87</td></tr><tr><td>825×400×6</td><td>31</td><td>53.85</td><td>2.64</td><td>66.10</td></tr><tr><td>990×480×6</td><td>31</td><td>75.76</td><td>2.63</td><td>65.79</td></tr><tr><td>1 155×560×6</td><td>31</td><td>107.54</td><td>2.71</td><td>67.63</td></tr><tr><td>1 188×576×6</td><td>30</td><td>108.18</td><td>2.86</td><td>71.57</td></tr><tr><td>1 254×608×6</td><td>31</td><td>126.09</td><td>3.09</td><td>77.35</td></tr><tr><td>1 287×624×6</td><td>31</td><td>129.39</td><td>3.32</td><td>82.92</td></tr><tr><td>1 320×640×6</td><td>30</td><td>144.48</td><td>3.93</td><td>98.24</td></tr></table>

实验结果显示，本文提出的孔隙介质中的地下水流动并行数值模拟方法取得了较好的计算效率和加速比，是一种加快地下水数值模拟问题求解速度、提高问题求解规模并具有良好可扩展性的有效并行计算方法。

# 5 结束语

地下水流动数值模拟软件在水资源利用、水资源保护和生态环境保护等众多行业和部门中有着广泛应用。其并行实现是加快问题求解速度、提高问题求解规模的重要手段。然

而，由于高精度模拟中涉及的数据存储和计算等所带来的复杂性常常使得这类问题难于高效求解。提出的孔隙介质中的地下水流并行数值模拟方法采用了分布式内存技术来解决模拟计算求解过程中的大规模稀疏矩阵存储以及计算问题，整合了各种高效并行迭代解法以及预条件子技术。实验表明，基于该地下水流并行数值模拟方法所实现的程序具有良好的并行性能以及可扩展性。