摘要: 在航空发动机健康管理系统中, 针对机载设备具有在线监测和大容量存储发动机工作数据等复杂业务要求, 提出了一种多任务管理和存储管理的应用策略, 前者采用优先级抢占机制, 后者采用二级缓存模式。最后基于VxWorks操作系统和HRFS文件系统实现了该设计策略, 从而验证了上述设计方法可行性。

关键词: 多任务; 二级缓存; 存储策略; 发动机健康系统

中图分类号: V247.5 文献标识码: A 文章编号: 1000- 8829(2016)07- 0056- 03

# A Strategy for Data Monitoring and Storage of Aero Engine

LI Yun- hua, ZHANG Zhe, CHE Xin (AVIC Commercial Aircraft Engine Co., Ltd., Shanghai 201108, China)

先进的航空发动机对可靠性、安全性和可维护性提出了更高的要求。发动机的健康管理系统则是保证飞机飞行安全、降低使用与保障费用的有效途径。通过健康管理系统实时记录发动机各子系统、设备或部件的工作状态和运行参数, 并且实现在线监视、故障诊断及指示告警。为满足数据分析和处理的要求, 在线监测和记录的数据量越来越大。据不完全统计, 发动机故障信息数量达上百种, 属于故障多发系统[1- 3]。当发动机一种或多种故障同时发生时, 要求健康管理系统中的机载软件在保证多种在线监视任务的同时, 还需要实现对发动机工作数据的在线分类、筛选和存储, 这对机载软件的功能和性能都提出了很大的挑战。

本文根据发动机在线监视和存储要求, 提出了一种实现发动机在线监视和大容量数据存储功能的策略, 并且基于风河公司的VxWorks Cert操作系统和Cert HRFS文件系统实现本文提出的上述策略, 前者是业界应用最广泛的嵌入式操作系统, 后者是一种高可靠的嵌入式文件系统。

可靠的嵌入式文件系统。

# 1 问题的提出

发动机工作数据包括气路性能、燃油系统、滑油系统, 以及发动机振动特性等各方面, 具体信号参数如下。

$①$  气路性能参数, 如温度、压力、转子转速等;

$②$  燃油系统参数, 如燃油总管温度、燃油总管压力, 燃油流量等;

$③$  振动性能参数, 如发动机高压转子、低压转子以及风扇的振动等。

$④$  滑油系统参数, 如滑油消耗率、滑油磨损参数、滑油品质、滑油温度和压力等。

健康管理系统的机载设备主要完成上述信号的在线监视和存储功能。数据存储主要有两种情况:  $①$  需要在发动机运行的各个工况下, 以固定的时间间隔采集并保存发动机监测数据;  $②$  当检测到任意一个或多个发动机出现故障, 须对与本次故障有关的发动机数据进行存储, 即存储故障发生时刻前后15s的相关发动机监测数据。

由此可见, 由于发动机健康管理系统所负责的业

务逻辑复杂,且对实时性的要求不同,更为重要的是在满足系统实时性要求的同时,还需解决机载设备在有限的存储资源上存储大容量的发动机工作数据三者之间的矛盾。基于以上两点,机载软件必须具有多任务管理和存储管理策略,以保证系统具有良好的实时性,又确保数据存储的可靠性[4]。

# 2 采取的策略

# 2.1 任务分配策略

在发动机健康机载软件中,具有周期性任务和非周期任务,如图1所示。周期性任务实现发动机信号的采集、处理、数据缓存、状态监视、故障诊断和稳定存储等功能,调度周期大小基本由所要求的处理周期确定;非周期任务实现发动机由故障或外部命令触发的数据存储功能。存储事件包括外部指令存储事件和故障存储事件,外部指令事件指接收到外部指令,保存特定的发动机原始数据;故障存储事件为当机载软件检测到任意一个或多个发动机故障而触发的存储事件。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/11c700c841262dd15951f99029f36bbbdfe1f7506b7f55fa39025a3bfc31cabe.jpg)  
图1 机载健康管理软件任务分配

周期任务本质上由全局时钟源控制。它们之间的同步通过信号量实现,当某个任务获取与之相对应的信号量后,则执行该任务,否则一直处于阻塞状态;周期任务的信号量释放由中断服务子程序执行,在中断服务子程序中以系统时钟为节拍进行计时,当计时值达到用户定义的时刻后,释放信号量。非周期任务则通过控制模块实时地判断当前是否具有外部触发事件,根据检测结果,挂起或终止相对应的非周期任务。

存在多个任务同时运行时,采用优先级抢占机制进行各任务间的切换。任务的优先级由其紧要程度决定,周期任务之间由截止时间确定,截止周期短的周期任务优先级相对较高。非周期任务由于用于发动机工作数据存储到电子盘,涉及慢速设备操作,因此优先级相对较低,各任务详情如表1所示。

表1 所分配任务情况  

<table><tr><td>序号</td><td>任务标识</td><td>功能概述</td><td>任务优先级</td></tr><tr><td>1</td><td>20msTask</td><td>采集发动机温度、压力和转速信号，接收 EEC 和飞机数据，综合诊断气路、燃油系统的故障。此外，具有存储监控单元和数据缓存，保障数据存储的同步和协调</td><td>Priority101</td></tr><tr><td>2</td><td>100msTask</td><td>采集发动机振动和金属屑信号，诊断发动机振动和磨损情况</td><td>Priority102</td></tr><tr><td>3</td><td>200msTask</td><td>完成数据的在线监控</td><td>Priority103</td></tr><tr><td>4</td><td>500msTask</td><td>正常状态下的数据存储</td><td>Priority104</td></tr><tr><td>5</td><td>EventsavTask</td><td>故障故障下的数据存储</td><td>Priority105</td></tr></table>

# 2.2 数据存储策略

发动机数据存储主要面临两个方面的问题:  $①$  由于所存储的发动机数据来源不同,采样周期不同,在故障事件存储时,需要对各类数据进行同步;  $②$  用于存储数据的电子盘属于慢速设备,在数据存储时,如何保证发动机数据信号处理的实时性要求。

考虑以上两个因素,采用两级缓存实现发动机数据存储。如图2所示,一级缓存由多个缓存队列组成,用来接收发动机的所有数据,包括采样数据、信号处理结果、故障诊断结果以及多种状态统计数据。接着,根据存储命令从一级缓存中提取所要存储的发动机数据,将它们进行组包,发送给二级缓存队列。最后,检测二级缓存队列状态,即判断二级缓存是否为空,在二级缓存队列非空时,将其中的数据包以文件形式写入到电子盘中,需要说明的是,为保证正常状态下的存储任务,特开辟独立的二级缓存队列,其格式和故障状态下的二级缓存格式是一致的,下面不再对此赘述。此外,通过存储监视功能实时判断数据存储的健康状况。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/6642a07f99c7956cb23a651f8e57159e76f561e58afc729d2701d0c48678d807.jpg)  
图2 基于双缓存的存储模式

一级缓存作为"数据缓存池",由多个缓存队列组成,缓存队列数量按照发动机的信号采样周期、数据规模和接口类型综合考虑进行分配。缓存队列深度是由缓存的数据量决定的,由于在检测到发动机故障发生时,需要保存故障发生时刻前15s的数据,因此,一级缓存中的各队列深度为对应的某类发动机信号在15s内的数据总量。详细信息见表2。

表2一级缓存队列  

<table><tr><td>队列
序号</td><td>队列标识</td><td>存储的数据</td><td>采样
频率</td><td>获取查
询周期</td></tr><tr><td>队列1</td><td>EECREG[750]</td><td>EEC 通信数据</td><td>—</td><td>20ms</td></tr><tr><td>队列2</td><td>EMUREG[750]</td><td>EMU 监视传感器数据</td><td>5Hz</td><td>20ms</td></tr><tr><td>队列3</td><td>SPAREG[750]</td><td>信号处理诊断数据</td><td>—</td><td>20ms</td></tr><tr><td>队列4</td><td>DMSOrgREG[150]</td><td>金属屑原始数据</td><td>20kHz</td><td>100ms</td></tr><tr><td>队列5</td><td>VNO1OrgREG[75]</td><td>一号轴承振动数据</td><td>10kHz</td><td>200ms</td></tr><tr><td>队列6</td><td>VFCVOrgREG[75]</td><td>FFCCV 振动数据</td><td>10kHz</td><td>200ms</td></tr><tr><td>队列7</td><td>VHRPOrgREG[75]</td><td>HRF 振动数据</td><td>10kHz</td><td>200ms</td></tr><tr><td>队列8</td><td>ACREG[15]</td><td>飞机数据</td><td>20ms、
25ms、
100ms、
250ms 等</td><td>按1s为
单位封
装数据</td></tr></table>

二级缓存队列是用于存放将要写入到电子盘中的单个或多个数据包。每个数据包由单个或多个数据段组成,各个数据段区中,保存的为当前周期所要存储的各类发动机数据。对于不同的故障,要求存储的发动机数据可能是相同的,因此,为避免数据冗余,造成机载存储资源的浪费,在数据组包时,需根据当前周期的发动机存储指令和上周期所存储情况,自动地添加、删除或保持一个或多个数据段对应的发动机数据。各数据段按照其队列号由小到大排列,队列号与发动机信号类型对应关系参见表2。为便于地面数据解析,添加了数据包、故障信息区、存储使能区和数据段信息区等,而数据段区又由段号和数据区组成。二级缓存队列格式如图3所示,各部分含义如表3所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/9804eff1dc36f80c98a61bb99b0e4cbe0fb937b66e708fae413a80ab76c905af.jpg)  
图3二级缓存队列各部分含义

数据量大,采取分时处理方式,即以1s数据段为单位通过多个调度周期完成数据迁移。

一级缓存不仅作为"数据缓存池",而且避免因周期任务调度而造成的数据不同步的问题。二级缓存是快速设备和慢速设备之间的衔接,先将所需存储的数据放入二级缓存中,从二级缓存中取数据写入电子盘。避免一级缓存的数据未写入电子盘而被新数据覆盖的问题。因此,双缓存的使用既解决了发动机监控任务处理实时性要求,又满足发动机数据存储的可靠性要求。

# 3 应用实例

该实例中机载设备以PowerPC8270为处理器,采用VxWorksCert操作系统和HRFS文件系统。在应用软件中实施所提出的发动机状态监视和存储策略设计,软件处理流程如图4所示。VxWorksCert操作系统支持优先级抢占和时间片轮询调度策略,支持多任务操作和任务间通信[5- 6]。CertHRFS文件系统也是风河科技公司提供的一种高可靠文件系统,用于实现复杂的实时数据存储、管理功能,也使数据的下载和维护更加便利,其性能评估和最优配置参见文献[7]。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/0465ee080465f57d03fcc4d7bcc6f07a860b4c557854e20e39420eb26b6f67ec.jpg)  
图4软件处理流程

本实例中利用发动机数学模型模拟超转故障,当低压转子信号超过  $95\%$  ,则认为发生超转故障,结果如图5所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/3fac780a7cdbdff113430227e1bef358da7046cd4fbf2b37489f08fccffa0be2.jpg)

它们以数据段为单位进行了编号,按照段号从小到大,将各数据段进行组包,发送给二级缓存队列,在数据组包时,需根据当前周期的发动机存储指令,添加或删除一个或多个数据段对应的发动机数据。根据存储指令,需提取故障发生时刻前15s的数据,由于该

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/89e9a71a-654f-40fe-88a4-763d46624c3c/48c8d0a36ccdc802a27dc96330cabc33668a9336ad38a2c0258762eea13f74ad.jpg)  
图5发动机数据监控

当发动机产生超转故障后,用于存储故障状态下的文件大小突然增大,表明健康机载设备存储故障发生时刻前的历史数据,接着以特定速率持续到超转故(下转第63页)

推广应用价值。