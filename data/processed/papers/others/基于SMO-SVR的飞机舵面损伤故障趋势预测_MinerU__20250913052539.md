摘要：飞机舵面出现损伤时，为了更准确的预测状态参量变化情况，提出了一种改进的序贯最小优化支持向量回归（SMO- SVR，Sequential Minimal Optimization Support Vector Regression）预测方法。采用改进C- C平均方法对多元时间序列进行箱空间重构，以确定最优嵌入维数  $m$  和延迟时间  $\tau_{\mathrm{d}}$ 。根据所求  $m$  和  $\tau_{\mathrm{d}}$  建立加权SVR预测模型，并调整了SMO算法的停机准则。利用区间自适应粒子群算法（IAPSO，Interval Adaptive Particle Swarm Optimization）优化SVR参数，以提高参数优化速度。为了验证改进算法的有效性，针对飞机方向舵损伤故障趋势进行了预测和分析，并与径向基函数神经网络（RBFNN，Radial Basis Function Neural Network）方法进行了对比，仿真结果表明SMO- SVR预测模型具有很好的预测能力。

关键词：故障趋势预测；支持向量回归；序贯最小优化；舵面损伤；相空间重构

中图分类号：TP  $206^{+}.3$

文献标识码：A 文章编号：1001- 5965（2012）10- 1300- 06

# Fault prediction for aircraft control surface damage based on SMO-SVR

Dong Lei Ren Zhang Li Qingdong

(Science and Technology on Aircraft Control Laboratory, Beijing University of Aeronautics and Astronautics, Beijing 100191, China)

飞控系统是影响飞机安全飞行的重要组成部分。通过预测可反映飞控系统状态性能的重要参数，以实现对飞控系统的状态监测，可增强对于飞控系统故障的早期发现能力。飞控系统的故障一般表现在作动器故障、舵面故障、传感器故障以及系统状态变化和模型参数偏差等几个方面。其中，

舵面故障属于“软故障”，故障程度随时间发展变化，因此，可通过预测系统状态参量的变化趋势来判断在未来一段时间内舵面的损伤情况[1- 3]

飞机舵面出现故障时，飞机的飞行状态将产生很大的非线性变化，故障程度将发展的很快，传统的线性预测模型已不适用。由此，神经网络技术

被用于此类复杂非线性系统的故障预测当中，如文献[4]将神经网络用于飞机舵面故障预测中。但是，文献[4]并没有把舵面故障和作动器故障分开考虑。支持向量回归（SVR，Support Vector Regression）方法可以兼顾学习算法的经验风险和推广能力，避免了样本维数过高和局部极小值等问题。近年来，越来越多的学者将其用于非线性系统的故障预测中。

本文根据飞机舵面故障的复杂非线性特点，提出了一种改进的序贯最小优化支持向量回归（SMO- SVR，Sequential Minimal Optimization Support Vector Regression）时间序列预测方法。将此方法应用于飞机舵面损伤故障趋势预测中，取得了较为满意的效果。

# 1 多元时间序列相空间重构

# 1.1 C-C方法

考虑复杂系统多参量的离散时间序列 $X(t_{\mathrm{p}}) = [x_{1}(t_{\mathrm{p}}),x_{2}(t_{\mathrm{p}}),\dots ,x_{n}(t_{\mathrm{p}})]^{\mathrm{T}},t_{\mathrm{p}} = 1,2,$ $\dots ,N;x_{1}(t_{\mathrm{p}}),x_{2}(t_{\mathrm{p}}),\dots ,x_{n}(t_{\mathrm{p}})$  对应系统的  $n$  个在  $t_\mathrm{p}$  时刻的值。分别对每个参量选择合适的延迟时间  $\tau_{\mathrm{d}}$  和延迟时间窗  $\tau_{\mathrm{w}}$  ，计算最终的嵌入维数m.C- C方法需计算以下3个量：

$$
\begin{array}{l}\overline{S} (t) = \frac{1}{16}\sum_{m = 2}^{5}\sum_{i = 1}^{4}S(m,r_i,t)\\ \Delta \overline{S} (t) = \frac{1}{4}\sum_{m = 2}^{5}\Delta S(m,t) \end{array} \tag{1}
$$

$$
S_{\mathrm{cor}}(t) = \Delta \overline{S} (t) + |\overline{S} (t)|
$$

其中，  $r_i = i\sigma /2$  为搜索半径，  $\sigma$  为时间序列的标准差。由  $\Delta \overline{S} (t)$  的第1个局部极小值对应的  $t$  来计算  $\tau_{\mathrm{d}} = t\tau_{\mathrm{s}}$  ；由  $S_{\mathrm{cor}}(t)$  的全局最小值对应的  $t$  来计算  $\tau_{\mathrm{w}} = t\tau_{\mathrm{s}},\tau_{\mathrm{s}}$  为采样间隔，  $t$  为时滞。选择最大和最小两个搜索半径，定义差量  $\Delta S(m,t)$  为 $\Delta S(m,t) = \max \{S(m,r_i,t)\} - \min \{S(m,r_i,t)\}$

式（1）和式（2）中的关键量  $S(m,r,t)$  定义为

$$
S(m,r,t) = \frac{1}{t}\sum_{s = 1}^{t}[C_s(m,r,t) - C_s^m (1,r,t)]
$$

其中，  $m = 2,3,\dots$  ；嵌入时间序列的关联积分

$$
C(m,r,t) = \lim_{N\to \infty}C(m,N,r,t) \tag{4}
$$

由于实际时间序列的长度  $N$  不可能为无穷，所以具体计算时以

$$
C(m,N,r,t) =
$$

$$
\frac{2}{M(M - 1)}\sum_{1\leqslant i\leqslant j\leqslant M}\Theta (r - \| x_i - x_j\|_\infty) \tag{5}
$$

作为  $C(m,r,t)$  的估计值。其中，  $M = N - (m - 1)t$  为嵌入点数；  $\Theta (\cdot)$  为Heaviside函数； $\| \cdot \|_{\infty}$  为  $l_{\infty}$  - 范数。而以

$$
S(m,N,r,t) =
$$

$$
\frac{1}{t}\sum_{s = 1}^{t}\left[C_{s}(m,N / t,r,t) - C_{s}^{m}(1,N / t,r,t)\right]
$$

作为  $S(m,r,t)$  的估计值。由此，对各参量进行相空间重构，得到多元时间序列嵌入延迟向量如下：

$$
\begin{array}{r l}{\overline{{X}}_{n} =} & {}\\ {x_{1}\left(t_{\mathrm{p}}\right)\quad x_{1}\left(t_{\mathrm{p}} - \tau_{\mathrm{d}}\right)\quad \dots \quad x_{1}\left(t_{\mathrm{p}} - \left(m_{1} - 1\right)\tau_{\mathrm{d}}\right)^{\mathrm{T}}}\\ \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \quad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdash \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad \vdots \qquad} \end{array}
$$

样本时间序列的长度决定了  $\tau_{\mathrm{w}}$  的合理取值范围，时间序列越长，范围越宽。

# 1.2 改进的C-C平均方法

在实际中，  $S_{\mathrm{cor}}(t)$  的某个局部极小值与全局最小值相差无几，容易导致最优  $\tau_{\mathrm{w}}$  选取错误。由此，需要对传统的C- C方法进行改进，改进措施如下：

1）范数是具有等价性的，这里利用2-范数代替原  $\infty$  -范数；

2）令  $\sigma = \mathrm{std}(x)(1 + cv / 3)$ ，  $cv$  为离散变异系数，  $cv = \mathrm{std}(x) / \mathrm{mean}(x)$  。由此，  $r$  将适当的扩大；

3）为了进一步减少振荡，将  $r$  改为  $m$  的函数：  $r(m) = r\log (m + 1)$ ，这样可以随着重构维数的增加适当扩大搜索半径。

得到改进的嵌入时间序列的关联积分为

$$
C(m,N,r(m),t) =
$$

$$
\frac{2}{M(M - 1)}\sum_{1\leqslant i\leqslant j\leqslant M}\Theta (r(m) - \| x_i - x_j\| _2)
$$

其他公式中的  $r$  也都改为  $r(m)$

4）借用谱估计中“平均法”的思想，将时间序列分为多段，求出每一段时间序列的  $\tau_{\mathrm{d}}$  和  $\tau_{\mathrm{w}}$  取其平均作为最终结果，并计算  $m$ 。求解出每个参量的  $\tau_{\mathrm{d}}$  和  $m$  后，取  $\tau_{\mathrm{d}}^{*} = \min (\tau_{\mathrm{d}})$ ，  $m^{*} = \max (m)$  作为最终嵌入延迟参数。其嵌入延迟向量如下：

$$
\overline{X}_{n} =
$$

$$
\begin{array}{r l}{x_{1}\left(t_{\mathrm{p}}\right)} & {x_{1}\left(t_{\mathrm{p}} - \tau_{\mathrm{d}}^{*}\right)\quad \dots \quad x_{1}\left(t_{\mathrm{p}} - \left(m^{*} - 1\right)\tau_{\mathrm{d}}^{*}\right)^{\mathrm{T}}}\\ {\vdots \qquad \vdots \qquad \vdots} & {\vdots}\\ {x_{i}\left(t_{\mathrm{p}}\right)} & {x_{i}\left(t_{\mathrm{p}} - \tau_{\mathrm{d}}^{*}\right)\quad \dots \quad x_{i}\left(t_{\mathrm{p}} - \left(m^{*} - 1\right)\tau_{\mathrm{d}}^{*}\right)}\\ {\vdots \qquad \vdots} & {\vdots}\\ {x_{n}\left(t_{\mathrm{p}}\right)} & {x_{n}\left(t_{\mathrm{p}} - \tau_{\mathrm{d}}^{*}\right)\quad \dots \quad x_{n}\left(t_{\mathrm{p}} - \left(m^{*} - 1\right)\tau_{\mathrm{d}}^{*}\right)} \end{array}
$$

# 2 加权SMO-SVR预测模型的建立

# 2.1 非线性加权SVR

回归估计函数  $f(x)$  可以表示为

$$
f(x) = \langle \pmb {w}\bullet \pmb {\Phi}(x)\rangle +b \tag{10}
$$

式中，  $b$  为阈值；  $\mathbf{w}$  的维数为特征空间维数.为求解式（10）中的  $\mathbf{w}$  和  $b$  ，即求下式最小：

$$
R(\pmb {w},\pmb {\xi}_i,\pmb {\xi}_i^*) = \frac{1}{2}\| \pmb {w}\| ^2 +C\sum_{i = 1}^{l}(\pmb {\xi}_i + \pmb {\xi}_i^*)
$$

s.t.  $y_{i} - \pmb {w}\bullet \pmb {\Phi}(x_{i}) - b\leqslant \pmb {\epsilon} + \pmb{\xi}_{i}$

$$
\pmb {w}\bullet \pmb {\Phi}(x_i) + b - y_i\leqslant \pmb {\epsilon} + \pmb {\xi}_i^*
$$

$$
\xi_{i}\geqslant 0\quad \xi_{i}^{*}\geqslant 0
$$

其中，  $\epsilon$  为损失函数，用于控制回归逼近误差管道的大小；  $G$  为惩罚因子，用来平衡回归函数  $f$  的平坦程度；  $\xi_{i}$  和  $\xi_{i}^{*}$  为松弛因子.

对于利用  $m^{*}$  重构后的多元时间序列数据来说，离被预测点越远则关系度越小.由此，本文将加权系数  $\rho$  引入到SVR中，公式如下：

$$
\rho_{i} = \eta +\Big[i - \mathbb{H}\mathbb{H}\Big(\frac{i - 1}{m^{*}}\Big)m^{*}\Big]\frac{1 - \eta}{m^{*}}
$$

$$
1\leq i\leq nm^{*} \tag{12}
$$

其中，  $\eta$  为初始关系度；  $n$  为时间序列的参量个数.可重写优化目标函数为

$$
R(\pmb {w},\pmb {\xi},\pmb{\xi}^{*}) = \frac{1}{2}\| \pmb {w}\|^{2} + C\sum_{i = 1}^{l}\rho_{i}(\pmb{\xi}_{i} + \pmb{\xi}_{i}^{*})
$$

引入拉格朗日乘子，构造拉格朗日函数如下：

$$
\begin{array}{rcl}{} & {} & {L(\pmb {w},b,\alpha ,\pmb {\xi},\pmb{\xi}^{*}) =}\\ {} & {} & {\frac{1}{2}\| \pmb {w}\|^{2} + C\sum_{i = 1}^{l}\rho_{i}(\pmb{\xi}_{i} + \pmb{\xi}_{i}^{*}) - }\\ {} & {} & {\sum_{i = 1}^{l}\alpha_{i}(\pmb {\epsilon} + \pmb{\xi}_{i} - y_{i} + \pmb {w}\bullet \pmb {\Phi}(x_{i}) + b) - }\\ {} & {} & {\sum_{i = 1}^{l}\alpha_{i}^{*}(\pmb {\epsilon} + \pmb{\xi}_{i}^{*} + y_{i} - \pmb {w}\bullet \pmb {\Phi}(x_{i}) - b) - }\\ {} & {} & {\sum_{i = 1}^{l}(\lambda_{i}\bullet \pmb{\xi}_{i} + \lambda_{i}^{*}\bullet \pmb{\xi}_{i}^{*})} \end{array} \tag{14}
$$

要使式（14）取最小值，则参数  $\pmb {w},b,\pmb {\xi}_i,\pmb {\xi}_i^*$  的偏导都应为零，如式（15）所示.与传统方法不同

的是，此处求解的联立方程带有  $\rho$

$$
\frac{\partial L}{\partial\pmb{w}} = \pmb {w} - \sum_{i = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right)\cdot \pmb {\Phi}\left(x_{i}\right) = 0
$$

$$
\frac{\partial L}{\partial b} = \sum_{i = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right) = 0
$$

$$
\frac{\partial L}{\partial\xi_i} = C\rho_i - \alpha_i^* -\lambda_i^* = 0
$$

$$
\frac{\partial L}{\partial\xi_i^*} = C\rho_i - \alpha_i^* -\lambda_i^* = 0
$$

将式（15）代入式（14），可得对偶优化问题为

$$
\begin{array}{l}{\min W(\alpha ,\alpha^{*}) = -\frac{1}{2}\sum_{i,j = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right)\left(\alpha_{j} - \alpha_{j}^{*}\right)\cdot}\\ {\left[\pmb {\Phi}(x_{i})\cdot \pmb {\Phi}(x_{j})\right] - }\\ {\sum_{i = 1}^{l}\alpha_{i}\left(\epsilon -y_{i}\right) - \sum_{i = 1}^{l}\alpha_{i}^{*}\left(\epsilon +y_{i}\right)} \end{array} \tag{10}
$$

s.t.  $\sum_{i = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right) = 0$

$$
\alpha_{i},\alpha_{i}^{*}\in [0,C\rho_{i}]i = 1,2,\dots ,l
$$

则回归估计函数可改写为

$$
f(x) = \sum_{i,j = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right)K(x,x_{i}) + b \tag{17}
$$

其中，  $K(x,x_{i})$  为核函数.因为  $\alpha_{i}$  和  $\alpha_{i}^{*}$  不能同时为0，所以  $b$  可以按下式计算：

$$
b = \left\{ \begin{array}{ll}y_{i} - < \pmb {w}\bullet \pmb {\Phi}(x_{i}) > - \epsilon & \alpha_{i}\in (0,C\rho_{i})\\ y_{i} - < \pmb {w}\bullet \pmb {\Phi}(x_{i}) > + \epsilon & \alpha_{i}^{*}\in (0,C\rho_{i}) \end{array} \right.
$$

# 2.2 改进的SMO算法

SMO算法把问题分解为可能达到的最小规模，即每次只优化两个拉格朗日乘子  $\alpha_{1}$  和  $\alpha_{2}$  ，算法采用两层循环

外层循环：对参量  $\alpha_{2}$  进行选择.在样本数据的非边界点中找出违反KKT条件的样本点

内层循环：从非边界样本点中找出使 $\mid E(\alpha_1) - E(\alpha_2)\mid$  最大的优化参量  $\alpha_{1}^{[8 - 9]}$  .其中， $\mid E(\alpha_1) - E(\alpha_2)\mid$  为变化量；  $E(\cdot)$  为误差函数.SMO算法过程如下所述

对于初始选择的  $\alpha_{1}$  和  $\alpha_{2}$  ，要更新这两个值，乘子的新值必须在一条直线上，如下式：

$$
\left. \begin{array}{l}\alpha_{1}y_{1} + \alpha_{1}y_{2} = \alpha_{1}^{0}y_{1} + \alpha_{2}^{0}y_{2} \end{array} \right\} \tag{19}
$$

其中，  $\alpha_{i}^{0}$  为  $\alpha_{i}$  的旧值；  $\bar{\rho}$  为  $\alpha_{1}$  和  $\alpha_{2}$  所对应权值系数的平均值

1）求解  $\alpha_{2}$  的优化值  $\alpha_{2}^{\prime}$  ，其可行域为  $L\leq$

$\alpha_{2}^{o} \leqslant H$ ，其中，当  $y_{1} \neq y_{2}$  时，

$$
\begin{array}{l}{L = \max \left(0,\alpha_{2}^{o} - \alpha_{1}^{o}\right)}\\ {H = \min \left(C\rho ,C\rho +\alpha_{2}^{o} - \alpha_{1}^{o}\right)} \end{array} \tag{20a}
$$

当  $y_{1} = y_{2}$  时，

$$
\begin{array}{l}{L = \max \left(0,\alpha_{2}^{o} + \alpha_{1}^{o} - C\rho\right)}\\ {H = \min \left(C\rho ,\alpha_{2}^{o} + \alpha_{1}^{o}\right)} \end{array} \tag{20b}
$$

通过求解可知  $\alpha_{2}$  的优化值为

$$
\alpha_{2}^{o} = \alpha_{2}^{o} + \frac{y_{2}\left[E\left(x_{1}\right) - E\left(x_{2}\right)\right]}{K\left(x_{1},x_{1}\right) + K\left(x_{2},x_{2}\right) - 2K\left(x_{1},x_{2}\right)}
$$

2）求解  $\alpha_{1}$  的优化值  $\alpha_{1}^{o}$ ，令  $s = y_{1}y_{2}$ ，则

$$
\alpha_{1}^{o} = \alpha_{1}^{o} + s\left(\alpha_{2}^{o} - \alpha_{2}^{o}\right) \tag{22}
$$

3）根据式（23）对阈值  $b_{1}$  进行修正：

$$
\begin{array}{c}{b_{1}^{\prime} = E(\alpha_{1}) + y_{1}(\alpha_{1}^{\prime} - \alpha_{1}^{\prime})K(x_{1},x_{1}) + }\\ {y_{2}(\alpha_{2}^{\prime} - \alpha_{2}^{\prime})K(x_{1},x_{2}) + b^{\prime}}\\ {b_{2}^{\prime} = E(\alpha_{2}) + y_{1}(\alpha_{1}^{\prime} - \alpha_{1}^{\prime})K(x_{1},x_{2}) + }\\ {y_{2}(\alpha_{2}^{\prime} - \alpha_{2}^{\prime})K(x_{2},x_{2}) + b^{\prime}} \end{array} \tag{23}
$$

其中，  $b^{0}$  为旧值；  $b_{i}$  为优化值

SMO算法一般采用KKT条件作为循环结束条件，这里称之为停机准则.在算法开始迭代时，目标函数快速上升，而在后期上升速度却变得很慢.因此，需对停机准则进行改进

对于2.1节中式（13）和式（16），如果  $(w,\xi ,$ $\xi^{*}$  ）为目标函数原始问题的解，同时  $(\alpha ,\alpha^{*})$  为对偶问题的解，那么令  $R(w,\xi ,\xi^{*}) = W(\alpha ,\alpha^{*})$  ，由此可得

$$
\frac{1}{2}\parallel \pmb {w}\parallel^2 =
$$

$$
\frac{1}{2}\sum_{i,j = 1}^{l}\left(\alpha_{i} - \alpha_{i}^{*}\right)\left(\alpha_{j} - \alpha_{j}^{*}\right)K\left(x_{i},x_{j}\right) =
$$

$$
-W(\alpha ,\alpha^{*}) - \sum_{i = 1}^{l}\alpha_{i}(\epsilon -y_{i}) - \sum_{i = 1}^{l}\alpha_{i}^{*}(\epsilon +y_{i})
$$

令

$$
\begin{array}{c}{\phi = \frac{R(w,\xi,\xi^{*}) - W(\alpha,\alpha^{*})}{R(w,\xi,\xi^{*}) + 1}}\\ {\nu = -\sum_{i = 1}^{l}\alpha_{i}(\epsilon -y_{i}) - \sum_{i = 1}^{l}\alpha_{i}^{*}(\epsilon +y_{i})} \end{array}
$$

则

$$
\phi = \frac{-2W(\alpha,\alpha^{*}) + \nu + C\sum_{i = 1}^{l}\rho_{i}(\xi_{i} + \xi_{i}^{*})}{-W(\alpha,\alpha^{*}) + \nu + C\sum_{i = 1}^{l}\rho_{i}(\xi_{i} + \xi_{i}^{*}) + 1}
$$

对于事先给定的精度要求，当  $\phi$  小于这个精度时，算法终止.把  $\phi$  停机准则和KKT条件的停

机准则一同使用，可设定经若干次迭代后进行一次  $\phi$  检验，这样提高了算法的运行效率

# 2.3 基于IAPSO算法的SVR参数优化

本文选用径向基函数作为SVR的核函数，表达式如下：

$$
K(x_{i},x_{j}) = \exp \left[-\gamma \parallel x_{i} - x_{j}\parallel^{2}\right) \tag{26}
$$

其中，  $\gamma$  为核参数.采用区间自适应粒子群（IAP- SO,Interval Adaptive Particle Swarm Optimization）方法[9]来优化SVR的  $G$  和  $\gamma$  .定义以下公式：

$$
\begin{array}{l}\overline{D} = \frac{1}{m}\sum_{i = 1}^{m}\sqrt{\sum_{i = 1}^{d}\left(p_{gd} - x_{id}\right)^2}\\ \displaystyle D_{\max} = \max_{i = 1,2,\dots ,m}\left[\sqrt{\sum_{i = 1}^{d}\left(p_{gd} - x_{id}\right)^2}\right]\\ \displaystyle k = \frac{D_{\max} - \overline{D}}{D_{\max}} \end{array} \tag{27}
$$

其中，  $\bar{D}$  为平均聚焦距离；  $D_{\mathrm{max}}$  为最大聚焦距离；  $k$  为粒子目前的聚焦距离变化率；  $p_{gd}$  为粒子群全局最优值；  $m$  为粒子的总个数；  $d$  为空间维数

算法每迭代一次就可计算得到  $k$  ，根据  $k$  的值来对惯性权重  $u^{\prime}$  进行修正.公式如下：

$$
\begin{array}{l}{\left(a_{1} + \frac{1}{2} r_{1}^{2}\right)\ln k\mid \quad \mid k\mid >1}\\ {w^{\prime} = a_{1}a_{2} + \frac{\mid r_{1}\mid}{2}}\\ {\left(a_{2} + \frac{\mid r_{2}^{2}\mid}{2}\right)\frac{1}{\ln k}\mid \mid k\mid < 0.05} \end{array}
$$

其中，  $a_1$  和  $a_{2}$  为可调参数，这里分别取0.45和 $0.35;r$  为  $[0,1]$  间均匀分布的随机数.由此，得到IAPSO优化算法形式为

$$
\left. \begin{array}{l}v_{i(d + 1)} = w^{\prime}v_{id} + c_{1}r_{1}^{\prime}\left(p_{id} - x_{id}\right) + \\ c_{2}r_{2}^{\prime}\left(p_{gd} - x_{id}\right)\\ x_{i(d + 1)} = x_{id} + v_{i(d + 1)} \end{array} \right\} \tag{29}
$$

其中，  $c_{1}$  和  $c_{2}$  为加速因子

该方法随机地选取  $w^{\prime}$  ，使得  $w$  随着  $k$  自适应地进行调整.当  $k$  变化较大时，表明粒子的  $\bar{D}$  和 $D_{\mathrm{max}}$  相差较大，也说明粒子的全局搜索能力差，应让粒子尽可能快的进入全局搜索模式.相反，  $k$  变化较小时，应尽可能提高粒子的局部搜索能力.

# 3 飞机舵面故障趋势预测

在实际中，对于飞机来说，能够检测到的参量是有限的，而且所采集的数据通常受到噪声的影响，降低了预测的准确度.由此，需要先对所采集

的样本进行预处理，然后选择与待预测参量具有强相关性的辅助因子来进行故障趋势预测。基于改进SMO- SVR的飞机舵面故障趋势预测框图如图1所示。预测步骤如下：

1）建立六自由度飞机模型，采集多维参量的时间序列样本数据，并对所有参量的样本进行去噪和归一化处理。然后利用改进的C-C方法对去噪后的数据进行相空间重构，得到  $m^{*}$  和  $\tau_{\mathrm{d}}^{*}$ ；

2）对相空间重构后的多元时间序列进行强相关性分析，并利用IAPSO方法寻找最优的  $C$  和  $\gamma$ 。根据  $m^{*}$  和  $\tau_{\mathrm{d}}^{*}$  建立加权SMO-SVR预测模型；

3）利用训练好的模型进行一步预测，并将一步预测值充实到原始序列中，同时去掉最老的数据，重复第2）、第3）步，实现滚动预测。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/3051967b-025d-41b8-a821-a916d2d772f6/617fde258fcfc5a218f36886fe431db90ca1d48054d60417e13f21d837989e2d.jpg)  
图1基于改进SMO-SVR的飞机舵面故障趋势预测框图

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/3051967b-025d-41b8-a821-a916d2d772f6/4a1bd8b0b195767a53107a7f9a1daa6aaf2470546338543948d3d45b0db07e58.jpg)  
图2 偏航角速度

假设飞机初始在  $5\mathrm{km}$  高空，以  $0.69Ma$  直线飞行，初始配平条件如迎角、舵偏角均为零。本文以  $\phi ,r$  预测  $r$ ，利用改进C- C方法对样本数据进行相空间重构，求得  $m^{*} = 5$ ，  $\tau_{\mathrm{d}}^{*} = 1$ 。针对输入输出样本，利用IAPSO对参数  $C$  和  $\gamma$  进行优化，适应度曲线如图3所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/3051967b-025d-41b8-a821-a916d2d772f6/c11e90d498a09a227fb5988a2152d4bd4bba4f50557d748fe14daafc9833f715.jpg)  
图3最优参数适应度

求得最优参数为  $C = 52.3299$ ，  $\gamma = 0.01$ 。从故障开始的  $22\mathrm{s}$  到  $32\mathrm{s}$  分别对去噪后的数据进行单步和两步故障趋势预测，并与径向基函数神经网络（RBFNN，Radial Basis Function Neural Network）方法进行对比，如图4和图5所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/3051967b-025d-41b8-a821-a916d2d772f6/6794c2cc759fcd9748b518200ed1017ba5f13bc628131ad869fb6b488ccd5db0.jpg)  
图4单步预测仿真图

# 4 仿真分析

本文选择以下飞机状态参量来进行故障趋势预测，分别是副翼舵偏  $\delta_{\mathrm{a}}$  、升降舵舵偏  $\delta_{\mathrm{e}}$  、方向舵舵偏  $\delta_{\mathrm{r}}$  、滚转角速度  $p$  、俯仰角速度  $q$  、偏航角速度  $r$  、滚转角  $\phi$  、俯仰角  $\theta$  和偏航角  $\psi$ 。对于方向舵损伤故障来说，参量中  $r$  和  $\psi$  变化比较明显，本文仅以这两个参量为例。给定方向舵舵偏为  $0\sim 0.035\mathrm{rad}$  的周期指令，采样周期为  $0.05\mathrm{s}$ ，在  $22\mathrm{s}$  时注入方向舵损伤故障，损伤程度随时间增加而增大，  $r$  的变化曲线如图2所示。

同理，以  $\delta_{\mathrm{e}},q,\theta ,\psi$  预测  $\psi$ ，可求得  $m^{*} = 5$ ，  $\tau_{\mathrm{d}}^{*} = 1$ ，  $C = 17.7418$ ，  $\gamma = 0.01$ ，预测后的性能对比如表1所示。可知，无论是单步预测还是两步预测，SMO- SVR方法都优于RBFNN方法。

本文选取了两个性能指标来对比RBFNN和SMO- SVR方法的预测性能，分别为：平

均绝对百分比误差  $e_{\mathrm{MAPE}}$  和均方根误差  $e_{\mathrm{RMSE}}$  。公式如下：

$$
e_{\mathrm{MAPE}} = \frac{1}{n - 1}\sum_{i = 1}^{n}\left|\frac{y_i - \hat{y}_i}{y_i}\right| \quad y_i \neq 0
$$

$$
e_{\mathrm{RMSE}} = \sqrt{\frac{1}{n}\sum_{i = 1}^{n}\left(y_i - \hat{y}_i\right)^2}
$$

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/3051967b-025d-41b8-a821-a916d2d772f6/8d463ca989576cadb8f298ae490b92bf8aa152b87f19e831995d36bff8296e8f.jpg)  
图5 两步预测仿真图

表1性能对比表  

<table><tr><td>性能指标</td><td>RBFNN单步</td><td>SMO-SVR单步</td><td>RBFNN两步</td><td>SMO-SVR两步</td></tr><tr><td>eMAPE-r</td><td>0.6775</td><td>0.5861</td><td>1.6683</td><td>0.7738</td></tr><tr><td>eMAPE-ψ</td><td>0.0217</td><td>0.0203</td><td>0.0548</td><td>0.0526</td></tr><tr><td>eRMSE-r</td><td>0.00074</td><td>0.00063</td><td>0.0074</td><td>0.00092</td></tr><tr><td>eRMSE-ψ</td><td>0.00041</td><td>0.00042</td><td>0.0010</td><td>0.00075</td></tr></table>

在单步预测结果中，SMO- SVR方法的整体预测性能略优于RBFNN方法.对于  $r$  ，其变化比较剧烈，SMO- SVR对时间序列数据的急剧变化具有更好的跟踪能力.对于  $\psi$  ，其变化趋势比较平缓，SMO- SVR的优势不是特别明显，甚至RBFNN对于  $\psi$  的  $e_{\mathrm{RMSE}}$  性能优于SMO- SVR方法；但在两步预测中，RBFNN方法的预测性能下降的比较明显，而SMO- SVR方法仍然保证了较高的预测精度，说明此方法克服了神经网络方法的过学习和局部极小值等问题，具有更强的回归建模能力和更好的预测性能.

# 5结论

仿真结果表明：本文提出的改进SMO- SVR故障趋势预测方法能够对舵面损伤时的状态参量趋势进行有效预测，并与RBFNN方法进行了比较，证明本文提出的方法预测精度更佳.但该方法也存在不足，当多步滚动预测后，预测准确度大大降低，如何将预测数据和训练数据进行交互并建立动态预测模型是进一步研究方向.

# 参考文献（References）

[1] Belkharraz A I, Sobel K. Direct adaptive control for aircraft control surface failures [C] //Proceedings of the American Control Conference. Piscataway, NJ, USA: IEEE, 2003:3905 - 3910[2] Weiss J L, Willsky A S, Looze D P, et al. Detection and isolation of control surface effectiveness failures in high performance aircraft [C] //Proceedings of the National Aerospace and Electronics Conference. Burlington, MA, US: ALPHATECH, Inc, 1985: 552 - 559[3] 张怡哲，邓建华. 舵面损伤在线故障模式预测及故障检测 [J]. 西北工业大学学报，2003，21（3）：298 - 301Zhang Yizhe, Deng Jianhua. On- line fault mode prediction and fault detection for control surface damage [J]. Journal of Northwestern Polytechnical University, 2003, 21（3）:298 - 301 (in Chinese)[4] 李斌，章卫国，宁东方，等. 基于神经网络技术的飞机舵面故障趋势预测研究 [J]. 系统仿真学报，2008,20（21）:5840 - 5842Li Bin, Zhang Weiguo, Ning Dongfang, et al. Fault prediction system of airplane steer surface based on neural network model [J]. Journal of System Simulation, 2008, 20（21）:5840 - 5842 (in Chinese)[5] Kim H S, Eykholt R, Salas J D. Nonlinear dynamics, delay times, and embedding windows [J]. Physica: D, 1999, 127:48 - 60[6] Kugjuntzis D. State space reconstruction parameters in the analysis of chaotic time series- the role of the time window length [J]. Physica: D, 1996, 95:13 - 28[7] 杨金芳，翟永杰，王东风，等. 基于支持向量回归的时间序列预测 [J]. 中国电机工程学报，2005, 25（17）:10 - 114Yang Jinfang, Zhai Yongjie, Wang Dongfeng, et al. Time series prediction based on support vector regression [J]. Proceedings of the CSEE, 2005, 25（17）:110 - 114 (in Chinese)[8] Platt J. Fast training of support vector machines using sequential minimal optimization [M]. Cambridge, MA: MIT Press, 1999: 185 - 208[9] 王书舟，伞冶，张允昌. 基于支持向量机改进SMO算法的直升机旋翼自转着陆过程建模 [J]. 航空学报，2009, 30（1）: 46 - 51Wang Shuzhou, San Ye, Zhang Yunchang. Modeling for landing process of helicopter with rotator self- rotating based on modified SMO algorithm of support vector machine [J]. Acta Aeronautica et Astronautica Sinica, 2009, 30（1）:46 - 51 (in Chinese)[10] 王杰，姜念，张毅.SVM算法的区间自适应PSO优化及其应用 [J]. 郑州大学学报，2011, 32（1）:75 - 79Wang Jie, Jiang Nian, Zhang Yi. SVM algorithm based on interval adaptive PSO and its application [J]. Journal of Zhengzhou University, 2011, 32（1）:75 - 79 (in Chinese)

（编辑：刘登敏）