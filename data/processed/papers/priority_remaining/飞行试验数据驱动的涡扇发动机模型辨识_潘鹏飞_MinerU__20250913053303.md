摘要：为实现航空发动机飞行试验实时监控，分析整理了涡扇发动机实际飞行试验数据，并以三层前向人工神经网络为基础，通过引入输出层反馈至输入层，形成该涡扇发动机的NNARX模型。对包括高压转子转速在内的11个发动机关键参数变化模型进行研究，并在额外架次全程飞行试验数据上验证和讨论辨识模型的推广能力。结果表明，辨识模型样本点上最大相对误差在  $5\%$  以内，辨识模型可以应用到该型发动机的试飞实时监控中，同时也可为后续建立涡扇发动机的全包线自适应实时监控模型提供参考。

关键词：航空发动机；飞行试验；人工神经网络；NARX模型辨识；全飞行包线；趋势监控；健康管理中图分类号：V235.13 文献标识码：A 文章编号：1672- 2620（2016）06- 0021- 05

# Flight test data-driven model identification of turbofan engine

PAN Peng- fei，MA Ming- ming，XU Yan- zhi (Chinese Flight Test Establishment，Xi'an 710089，China)

# 1 引言

用于飞行试验的航空发动机的技术状态通常都不成熟，在飞行条件、大气环境等不可预料因素的影响下，会遭遇稳定性故障、气路故障、振动故障及磨损故障。为提高航空发动机试飞安全，需要利用实时模型对发动机重要参数的变化趋势进行预测，以便实时掌握发动机工作状态，提前采取措施减小或消除异常工况。

航空发动机飞行试验实时监控的关键在于发动

机模型的获取。虽然传统的发动机部件模型充分考虑了工作中的气动热力过程，精度高，但由于计算复杂，实时计算时可能出现迭代不收敛等问题，尚未应用到航空发动机飞行试验实时监控中[1- 2]。现阶段可行的方案是基于系统辨识的方法，从航空发动机历史飞行试验数据中辨识出发动机模型用于实时飞行监控。

基于人工神经网络的航空发动机NARX（非线性自回归)模型属于黑箱模型，从运行数据中直接辨

识得到航空发动机模型，综合了人工神经网络强大非线性运算能力，同时还兼备NARX辨识方法的优点。NARX模型辨识方法的实用性已得到国内外学者的证实[3- 11]，然而其大部分研究工作是通过模拟数据或地面试验数据训练模型[12- 13]，难以在实际飞行试验中推广应用。本文以某型涡扇发动机实际飞行试验数据为基础，利用人工神经网络对该型发动机的NARX模型进行辨识，用于在实际试飞中基于模型实时监控发动机工作状态。

# 2 模型辨识方法

NARX模型采用输入延迟  $u(t - k)$  和输出延迟  $y(t - m)$  作为回归算子[14]，模型结构可写为  $y(t) = F^{\mathrm{nl}}\big[u(t),\dots ,u(t - k),y(t - 1),\dots ,y(t - m)\big]$ ，其中  $F^{\mathrm{nl}}$  代表合适的非线性函数。

前人研究表明[1,3- 5,13- 16]，只要具有合适的隐含层及神经元个数，人工神经网络就能以任意精度逼近任何非线性函数。文中采用人工神经网络方法拟合NARX模型中的  $F^{\mathrm{nl}}$ ，模型结构可写为  $y(t) = F^{\mathrm{net}}\big[u(t),\dots ,u(t - k),y(t - 1),\dots ,y(t - m)\big]$ ，其中  $F^{\mathrm{net}}$  为基于人工神经网络在数据样本上训练得到的非线性函数。

# 3 涡扇发动机非线性模型辨识

飞行试验期间，通过机载测试系统测取了涡扇发动机各个截面处的压力、温度等参数，同时记录了飞机姿态、发动机控制器等参数。测试数据经遥测系统实时发送至地面监控室，由试飞工程师对发动机状态进行实时监控。

# 3.1 神经网络输入输出参数

涡扇发动机人工神经网络模型输入包括两部分：当前时刻和延迟后的外部输入参数，以及延迟后的模型预测参数。外部输入参数为：气压高度  $H_{\mathrm{p}}$ ，飞行马赫数  $Ma$ ，大气总温  $T_{\mathrm{th}}$ ，发动机油门杆角度  $\Phi$ ，发动机作战/训练信号  $G_{\mathrm{sr}}$ 。模型预测参数为：高压转子转速  $n_{\mathrm{H}}$ ，低压转子转速  $n_{\mathrm{L}}$ ，低压涡轮出口总温  $T_{\mathrm{c}}$ ，低压涡轮出口总压  $p_{\mathrm{G}}$ ，低压导向叶片角度  $\alpha_{1}$ ，高压导向叶片角度  $\alpha_{2}$ ，高压压气机出口压力  $p_{31}$ ，主燃油总管压力  $p_{\mathrm{f}}$ ，尾喷管喉部直径  $D_{\mathrm{g}}$ ，滑油回油温度  $T_{\mathrm{old}}$ ，发动机振动值  $B$ 。发动机人工神经网络模型结构如图1所示，图中TDL1、TDL2分别代表输入参数和输出参数的延迟环节。模型输入、输出参数信息见表1，表中  $t$  为当前时刻，  $k$  为输入最大延迟时间，  $m$  为输出最大

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/d2fedb27-722d-4df8-a4ca-08788ca26546/bc76fd8069b2f995e3a29f6071fcc2d9c29156d44d04597955cb27a5588f0a46.jpg)  
图1涡扇发动机人工神经网络模型结构 Fig.1 The structure of turbofan engine ANN model

表1发动机非线性模型输入输出参数信息 Table 1 Input and output parameters in the engine nonlinear model  

<table><tr><td></td><td>输入参数</td><td>输出参数</td></tr><tr><td>Hp(t),...Hp(t-k),Ma(t-k),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nF(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nH(t-k),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nH(t-k),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nH(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nF(t-m),nH(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-k),nF(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t-k),nF(t-m),nF(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-m),nH(t-k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t(k),nH(t((</td><td></td><td></td></tr></table>

延迟时间。

# 3.2 飞行试验数据样本

采用该型发动机试飞期间11架次飞行数据作为人工神经网络模型的训练学习样本。利用Euclidean距离对数据样本点进行筛选，剔除数据样本中状态相近的数据点。若需从原始数据样本库  $C$  中增加数据样本点  $P_{i}$  至训练学习样本集  $C_{\mathrm{sub}}$ ，首先将  $P_{i}$  与  $C_{\mathrm{sub}}$  中的样本点  $P_{i}(j = 1,2,\dots ,N)$  逐个进行Euclidean距离计算，若满足要求则将  $P_{i}$  增加至  $C_{\mathrm{sub}}$  中。记  $a_{ij}$  代表  $P_{i}$  到  $P_{j}$  之间的Euclidean距离，由于  $P_{i} = \left[H_{\mathrm{p},i},Ma_{i},\phi_{i},n_{\mathrm{H},i,j}\right]^{2}, P_{j} = \left[H_{\mathrm{p},j},Ma_{j},\phi_{j},n_{\mathrm{H},j}\right]^{T}$ ，则：

$$
d_{ij} = \left|P_{i} - P_{j}\right| =
$$

$$
\sqrt{\left(H_{\mathrm{p},i} - H_{\mathrm{p},j}\right)^2 + \left(Ma_{i} - Ma_{j}\right)^2 + \left(\phi_{i} - \phi_{j}\right)^2 + \left(n_{\mathrm{H},i} - n_{\mathrm{H},j}\right)^2}
$$

# 3.3 神经网络训练学习

选用三层神经网络结构。隐含层传递函数选用双曲正切函数，输出层传递函数选用纯线性函数，采

用LM算法对人工神经网络进行训练学习。模型输出指标采用MSE性能函数以及输入、输出之间的回归系数  $R$ 。

# 4 结果分析与讨论

人工神经网络训练时，将数据样本按照  $70\%$ 、 $15\%$  和  $15\%$  的比例分为三组，分别用于模型训练、模型测试和模型验证。数据样本点在飞行包线内分布与分组情况见图2。为方便对比分析，文中对数据样本进行了归一化处理。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/d2fedb27-722d-4df8-a4ca-08788ca26546/073de6d2bb6a337517688485b5515574d86620e316a38481f5bcd7b20adab27f.jpg)  
图2飞行试验数据样本在飞行包线内的分布 Fig.2 Distribution of flight test data samples in flight envelope

为确定涡扇发动机人工神经网络模型输入、输出的延迟时间和隐含层神经元数目，以发动机高压转子转速为基准模型，训练学习得到人工神经网络模型性能指标，如表2所示。表中，NMSE代表神经网络模型的归一化均方差，其计算式见公式(2)； $\mathrm{NNARX}_{ij}$  代表输入延迟为  $i$  输出延迟为  $j$  的神经网络模型，  $i,j$  分别为取值1～3之间的整数。最后，从高压转子转速模型辨识结果中，选择精度最高的 $\mathrm{NNARX}_{23}$  作为最终非线性模型，对发动机11个关键参数进行研究。

表2基于NNARX的高压转子转速模型结构 Table 2 Model structure based on NNARX of high pressure spool speed  

<table><tr><td></td><td>NMSE</td><td>R</td></tr><tr><td>NNARX1</td><td>0.004 2</td><td>0.998 0</td></tr><tr><td>NNARX12</td><td>0.003 8</td><td>0.998 2</td></tr><tr><td>NNARX13</td><td>0.003 7</td><td>0.998 2</td></tr><tr><td>NNARX21</td><td>0.003 6</td><td>0.998 3</td></tr><tr><td>NNARX22</td><td>0.003 5</td><td>0.998 3</td></tr><tr><td>NNARX23</td><td>0.002 8</td><td>0.998 6</td></tr><tr><td>NNARX31</td><td>0.004 7</td><td>0.997 7</td></tr><tr><td>NNARX32</td><td>0.003 6</td><td>0.998 3</td></tr><tr><td>NNARX33</td><td>0.003 7</td><td>0.998 2</td></tr></table>

$$
NMSE = \frac{1}{N}\frac{\sum_{i}^{N}(x_{i} - \hat{y}_{i})^{2}}{\sum_{i}^{N}\sum_{j}\sum_{i}\hat{y}_{i}}\times 100\% \tag{2}
$$

# 4.1 模型辨识结果

对发动机9个关键参数进行辨识，图3示出了发

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/d2fedb27-722d-4df8-a4ca-08788ca26546/a1eee78ee6b899a665bf9633d71a4e7da37a65c327c0ed5d71ae6e2e2fda3a4f.jpg)  
图3涡扇发动机关键参数模型辨识结果 Fig.3 Identified results of key parameter model of turbofan engine

动机高压转子转速、高压压气机出口压力、低压涡轮出口总温以及滑油回油温度的模型辨识结果。图中实线代表辨识模型输出结果，空心圆点代表飞行试验数据样本。训练学习过程中，辨识模型的最大相对误差  $R_{\mathrm{E,max}}$  分别为：高压转子转速  $R_{\mathrm{E,max}} = 2.4\%$  ，高压压气机出口压力  $R_{\mathrm{E,max}} = 4.6\%$  ，低压涡轮出口总温  $R_{\mathrm{E,max}} = 3.4\%$  ，滑油回油温度  $R_{\mathrm{E,max}} = 0.5\%$  。第25个数据样本点处因发动机执行了遭遇加速，所以高压转子转速偏低。

# 4.2 模型推广能力验证

采用额外一个架次全程飞行试验数据对辨识模型的非样本点推广能力进行检验。飞行过程中，气压高度、飞行马赫数、大气总温、油门杆角度的变化范围如图4所示。针对每1s数据，准备神经网络模型输入参数，由辨识模型计算出当前时刻的参数预测值，并与当前时刻该参数的飞行试验数据进行对比。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/d2fedb27-722d-4df8-a4ca-08788ca26546/049559f2f07ee7969413d2c57d332cbc78c048824dd53b4053225e4247800436.jpg)  
图4辨识模型推广能力验证数据样本分布 Fig.4 Sample distribution of validated flight test samples for model generalization

对发动机11个关键参数均进行了推广能力验证。图5给出了高压转子转速、高压压气机出口压力、低压涡轮出口总温以及滑油回油温度的模型推广能力检验结果。该架次飞行中，辨识模型输出结果与飞行试验数据吻合良好，模型最大相对误差分别为：高压转子转速  $R_{\mathrm{E,max}} = 1.0\%$  ，高压压气机出口压力  $R_{\mathrm{E,max}} = 1.7\%$  ，低压涡轮出口总温  $R_{\mathrm{E,max}} = 0.2\%$  ，滑油总回油温度  $R_{\mathrm{E,max}} = 1.2\%$  。最大相对误差对应时刻  $t_{\mathrm{RE}}$  分别为：高压转子转速  $t_{\mathrm{RE}} = 729 \mathrm{~s}$  ，高压压气机出口压力  $t_{\mathrm{RE}} = 2063 \mathrm{~s}$  ，低压涡轮出口总温  $t_{\mathrm{RE}} = 393 \mathrm{~s}$  ，滑油回油温度  $t_{\mathrm{RE}} = 58 \mathrm{~s}$  。

# 5 结论

通过分析整理涡扇发动机实际飞行试验数据，

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-11/d2fedb27-722d-4df8-a4ca-08788ca26546/db1a1885d50f487ba5b4eb498604b275dac72e348e13aa88689778cf8089cd44.jpg)  
图5涡扇发动机辨识模型推广能力检验结果 Fig.5 Validated results of generalization of turbofan engine identified model

基于人工神经网络辨识得到了发动机的NARX模型。在训练学习样本点上对模型精度进行了讨论，同时利用额外一个全架次的飞行试验数据对模型推广泛化能力进行了分析讨论。研究结论如下：

(1) 模型预测包线范围内，涡扇发动机模型在稳态和动态过程中关键参数预测精度可靠，可用于该型发动机的试飞实时监控；(2) 文中采用的涡扇发动机试飞数据模型辨识方法具有通用性，可为航空发动机自适应控制、健康管理系统的开发提供参考。