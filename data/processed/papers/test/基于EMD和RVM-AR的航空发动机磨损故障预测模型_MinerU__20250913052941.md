摘要：针对滑油光谱数据的非线性非平稳特性及现有预测方法的不足，提出了一种基于经验模态分解（EMD）和相关向量机一自回归模型（RVM）的预测方法；首先，利用EMD算法将序列分解为若干固有模态函数（IMF）和残余函数（RF），分离原始数据中的趋势项和随机项；然后，建立各IMF分量的AR模型和RF分量的RVM模型，以留一交叉验证误差作为适应度函数，采用量子粒子群优化算法进化搜索RVM的最优核参数和嵌入维数；最后，将各AR模型和RVM模型的预测值叠加作为最终预测值；实验结果表明：相比AR和SVM方法，该方法具有较高的预测精度，Fe元素的平均相对预测误差分别提高了  $15\%$  和  $6\%$  ，Si元素的平均相对预测误差分别提高了  $49\%$  和  $23\%$  。

关键词：故障预测；滑油光谱分析；经验模态分解；相关向量机；自回归模型；量子粒子群优化；航空发动机

# Aero—Engine Wear Faults Prediction Based on EMD and RVM—AR

Fan Geng，Ma Dengwu (Department of Oedname Science and Technology，Naval Aeronautical and Astronautical University，Yantai 264001，China)

# 0 引言

故障预测与健康管理（PHM）技术是实现航空发动机高可靠性、高安全性、高可用率和低耗费的关键使能技术，对于军用维修保障体制变革具有重大的技术引导作用[1- 2]。航空发动机滑油中的金属元素含量值能较准确地反映出发动机的状态信息，利用油液光谱分析技术对滑油中各种金属含量值及其趋势进行分析是实现发动机磨损故障预测的有效手段[3- 4]。文献[4]运用自回归（AR）模型对采集的航空发动机滑油光谱数据进行时序建模和预测分析。AR模型的特点是在平稳时间序列建模时具有较好的效果，但在处理非平稳时间序列时会产生较大的误差。文献[5- 7]建立了滑油光谱数据的支持向量机（SVM）预测模型。SVM利用核函数将输入空间通过非线性变换映射到高维空间，将非线性问题转化为线性问题并能得到全局最优解，但SVM也存在一些缺陷，如参数设置复杂核函数受Mercer条件限制等。RVM是Tipping提出的一种与

SVM相似的稀疏概率模型，它利用Bayesian方法进行推理，模型结构简单。与SVM相比，RVM不仅得到更高的准确率，而且在模型稀疏性、参数设置、核函数选择等方面还具备了SVM无法达到的优势[1- 2]。

针对油液光谱数据的非线性非平稳特性以及现有单一预测方法的不足，提出了一种基于经验模态分解（EMD）和RVM一AR的预测方法，并将通过预测实例说明该方法的有效性和优越性。

# 1 经验模态分解

# 1.1 传统EMD算法

$\mathrm{EMD}^{[11]}$  是1998年由美国工程院院士Huang等人提出的一种自适应信号处理方法。该方法吸取了小波变换多分辨的优势，同时克服了小波变换中小波基选取与分解尺度确定的难题，更适于非线性、非平稳信号的分析。令  $\mathcal{X}$  为原始时间序列，传统EMD算法的步骤为：

1）确定  $\mathcal{X}$  所有局部极值点，并采用三次样条函数拟合形成上包络线和下包络线。记上下包络线的均值为  $m_{1}$  ，计算  $h_1$ $= x - m_{1}$  ；

2）令  $x = h_{1}$  ，重复步骤1）直到  $h_1$  满足IMF的两个条

件，此时记  $c_{1} = h_{1}$ ，则  $c_{1}$  为  $x$  的第 1 个 IMF 分量；

3）将  $r_1 = x - c_1$  作为原始数据，重复步骤1）和2），得到  $\mathcal{L}$  的第2个IMF分量  $C2$  ，依此继续分解直至  $r_n$  足够小或为单调函数，得到  $\mathcal{X}$  的  $n$  个IMF分量  $c_{1}\sim c_{n}$

通过上述分解，原始序列  $\mathcal{X}$  可表示为

$$
x = \sum_{i = 1}^{n}c_{i} + r_{n} \tag{1}
$$

式中：  $c_{1}\sim c_{n}$  分别代表从信号从高到低不同频段的成分，  $r_n$  代表信号的平均趋势。

# 1.1 EMD端点效应的镜像延拓抑制方法

EMD算法的关键步骤之一是利用三次样条函数拟合形成上、下包络线，它将直接影响到分解得到的所有IMF分量的精度。然而由于无法确定信号两边端点位置的极值点，导致得到的包络线在端点附近出现严重的失真，出现端点效应，最终导致得到一组不可靠的IMF分量和残余分量。为了抑制传统EMD算法的端点效应，国内外学者提出了很多处理方法，工程上常用的有线性外延法、多项式拟合法、镜像延拓法、AR预测法和ANN预测法等。文献[12]利用准周期信号和随机信号对它们的端点效应抑制效果进行了测试，指出镜像延拓法是目前相对最优和应当首选的EMD端点效应抑制方法。因此，本文采用基于镜像延拓的EMD算法对油液光谱数据进行分解。

镜像延拓法[13]的基本思想是：根据信号的分布特性，将镜子放在具有对称性的极值位置，通过镜像法把镜内信号映射成一个周期性的环形信号。由于不存在端点，从根本上避免了EMD的端点效应。

# 2 相关向量机

# 2.1 稀疏Bayesian回归原理

假设给定输入一输出样本对  $\{x_{n},t_{n}\}_{n = 1}^{N}$  作为训练数据集，式中：  $x_{n}\in \{R^{d},t_{n}\in \{R\}$  ，则与SVM类似，RVM的模型输出可以表示为：

$$
y(x,w) = \sum_{i = 1}^{N}w_{i}K(x,w_{i}) + w_{0} \tag{2}
$$

式中：  $K(x,x_{i})$  为核函数；  $\mathfrak{w}_i$  为模型的权值；  $N$  为样本数。

假定目标值是独立的，且来自带噪声的模型：

$$
t_n = y(x_n,w) + w_n \tag{3}
$$

式中：  $\epsilon_{n}$  为噪声，服从均值为0，方差为  $\sigma^2$  的Gaussian分布，即  $\rho (t_{i}\mid x_{i}) = N(t_{i}\mid y(x_{i},w),\sigma^{2})$  。方便起见，引入超参数  $\beta$ $= \frac{1}{\sigma^2}$  ，则相应的训练样本集的似然函数为：

$$
p(t\mid w,\beta) = (\frac{\beta}{2\pi})^{\frac{-N}{2}}\exp \left\{-\frac{\beta}{2}\left\| t - \Phi w\right\| ^2\right\} \tag{4}
$$

式中：  $t = [t_1,t_2,\dots ,t_N]^T;\Phi \in R^{N\times (N + 1)}$  是设计矩阵，定义为  $\Phi = [\pmb {\phi}(x_1),\pmb {\phi}(x_2),\dots ,\pmb {\phi}(x_N)]^T$  ，基函数向量  $\begin{array}{rl}{\pmb {\phi}(x_n)} & = \end{array}$ $\begin{array}{rl}{[1}&{K(x_n,x_1)\quad\cdots\quad K(x_n,x_N)]^T}\end{array}$

采用稀疏Bayesian方法对权值  $\mathfrak{w}$  赋予先验的条件概率分布：

$$
p(\boldsymbol {w}\mid \boldsymbol {\alpha}) = \prod_{i = 0}^{N}N(\boldsymbol {w}_i\mid 0,\boldsymbol {\alpha}_i^{-1}) \tag{5}
$$

根据Bayesian公式，利用样本似然函数式（4）和  $\mathfrak{w}$  先验

分布式（5）可以得到  $\mathfrak{w}$  的后验分布计算公式：

$$
p(\boldsymbol {w}\mid t,\boldsymbol {\alpha},\boldsymbol {\beta}) = \frac{p(t\mid\boldsymbol{w},\boldsymbol{\beta})p(\boldsymbol{w}\mid\boldsymbol{\alpha})}{p(t\mid\boldsymbol{\alpha},\boldsymbol{\beta})} \tag{6}
$$

由于  $p(t\mid w,\beta)$  和  $p(w\mid \alpha)$  均为Gaussian分布，而  $p(t\mid$ $\alpha ,\beta)$  中不含  $\Psi$  ，可看作归一化系数。则  $\Psi$  的后验分布可进一步表示为：

$$
p(t\mid \alpha ,\beta) = N(\tau \omega \mid \mu ,\pmb {\Sigma}) \tag{7}
$$

后验协方差和均值分别为：

$$
\pmb {\Sigma} = (\pmb {\rho}\pmb {\sigma}^T\pmb {\Phi} + \pmb {A})^{-1} \tag{8}
$$

$$
\mu = \beta \Sigma \Phi^{T}t \tag{9}
$$

式中：  $A = diag(a_0,a_1,\dots ,a_N)$  。超参数  $\alpha$  和  $\beta$  直接影响  $\Psi$  的后验分布，需对其优化地得到  $\Psi$  的最大后验分布。通过最大化边缘似然函数  $p(t\mid \alpha ,\beta)$  实现超参数的优化。将  $p(t\mid \alpha ,\beta)$  取负对数得到目标函数，将目标函数对超参数  $\alpha$  和  $\beta$  求偏导并令导数式为0，得到以下迭代公式：

$$
\alpha_{i}^{\mathrm{new}} = \frac{\gamma_{i}}{\mu_{i}^{2}} \tag{10}
$$

$$
(\mu^2)^\mathrm{new} = \frac{\|t - \Phi\mu\|}{N - \sum_i\gamma_i} \tag{11}
$$

式中：  $\mu_{i}$  为第  $i$  个后验平均权；  $\gamma_{i}\equiv 1 - \alpha_{i}\Sigma_{ii}$  ，  $\Sigma_{ii}$  为后验权协方差矩阵的第  $i$  个对角元素；  $\gamma_{i}$  为样本数据的个数。公式（8）～（11）依次进行迭代计算直到所有参数都收敛或达到最大训练次数时为止。

若给定输入值  $\mathcal{X}_*$  ，则相应输出的概率分布为

$$
\begin{array}{r}\rho (t_{*}\mid t,\pmb{\alpha}_{\mathrm{MP}},\sigma_{\mathrm{MP}}^{2}) = \int \rho (t_{*}\mid \pmb {w},\sigma_{\mathrm{MP}}^{2})\rho (\pmb {w}\mid t,\pmb{\alpha}_{\mathrm{MP}},\sigma_{\mathrm{MP}}^{2})\pmb{w} \end{array}
$$

式（12）服从正态分布，即

$$
\begin{array}{r}p(t_{*}\mid t,\pmb{\alpha}_{\mathrm{MP}},\sigma_{\mathrm{MP}}^{2}) = N(t_{*}\mid y_{*},\sigma_{*}^{2}) \end{array} \tag{13}
$$

预测均值和方差分别为：

$$
y_{*} = \mu^{T}\phi (x_{*}) \tag{14}
$$

$$
\sigma_{\ast}^{2} = \sigma_{\ast \mathrm{MP}}^{2} + \phi (x_{\ast})^{T}\Sigma \phi (x_{\ast}) \tag{15}
$$

则RVM新观测值的预测输出为  $y_{*} = (x_{*};\mu)$  。

# 2.2 时间序列RVM预测模型

对于时间序列  $\{x_{1},x_{2},\dots ,x_{N}\}$  ，利用  $t$  时刻以前的值预测  $t$  时刻的值，需要建立  $\{x_{i - 1},x_{i - 2},\dots ,x_{i - l}\}$  与  $x_{i}$  之间一一映射的关系  $f\colon R^t - R$  ，其中  $l$  为嵌入维数。因此，RVM回归模型的训练样本集为：

$$
\begin{array}{r}\mathbf{X} = \left[ \begin{array}{cccc}x_{1} & x_{2} & \dots & x_{N - l}\\ x_{2} & x_{3} & \dots & x_{N - l + 1}\\ \vdots & \vdots & \ddots & \vdots \\ x_{l} & x_{l + 1} & \dots & x_{N - 1} \end{array} \right] = \left[ \begin{array}{cccc}x_{1} & x_{2} & \dots & x_{N - l}\\ x_{1} & x_{2} & \dots & x_{N - 1}\\ \vdots & \vdots & \ddots & \vdots \\ x_{l} & x_{l + 1} & \dots & x_{N - 1} \end{array} \right]\\ \mathbf{Y} = \left[ \begin{array}{cccc}x_{l + 1} & x_{l + 2} & \dots & x_{N} \end{array} \right] = \left[ \begin{array}{cccc}t_{1} & t_{2} & \dots & t_{N - l} \end{array} \right]_{\circ} \end{array}
$$

根据式（2）建立RVM回归预测模型如下：

$$
y(x) = \sum_{i = 1}^{N - l}w_{i}K(x,x_{i}) + w_{0} \tag{16}
$$

$K(\cdot ,\cdot)$  选为Gaussian核函数，则：

$$
K(x_{i},x_{j}) = \exp (-||x_{i} - x_{j}||^{2} / 2\gamma^{2}) \tag{17}
$$

# 2.3 模型参数的自适应优化

RVM模型参数的选择将直接影响RVM模型的预测性能。本文建立的时间序列RVM回归模型有两个参数：嵌入维数  $l$

和Gaussian核参数  $\gamma$  。由于凭借主观经验确定模型参数的人为方法缺乏科学依据且不具备推广性，因此，为了实现模型参数的自适应优化选择，本文引入量子粒子群优化（QPSO）算法对建立模型的参数进行优化。

传统的PSO算法将群体中的每个个体（可行解）看成  $D$  维搜索空间中的一个没有体积的粒子，在搜索空间中以一定的速度飞行，其速度根据目前所找到的最优位置和整个粒子群所找到的最优位置进行动态调整。QPSO算法中粒子只有位置向量，没有速度向量，由于粒子满足聚集态的性质与PSO完全不同，使粒子能在整个可行解空间中搜索全局最优解。算法具体描述如下[14]：

$$
Z(t + 1) = p(t)\pm \eta \cdot \left|m_{\mathrm{best}} - Z(t)\right|\cdot \ln (1 / u) \tag{18}
$$

$$
\pmb {p}(t) = \phi \cdot \pmb {p}_i(t) + (1 - \phi)\cdot \pmb {p}_i(t) \tag{19}
$$

$$
m_{\mathrm{best}} = \Big(\frac{1}{M}\sum_{i = 1}^{M}p_{i,1}(t),\dots ,\frac{1}{M}\sum_{i = 1}^{M}p_{i,D}(t)\Big) \tag{20}
$$

式中：  $M$  为种群中粒子的数目；  $D$  为粒子维数；  $u$  和  $\phi$  是在[0，1]上均匀分布的随机数；  $m_{best}$  是种群中所有粒子的平均最好位置点；  $p_i$  和  $p_{\epsilon}$  分别表示粒子  $i$  所经历的最好位置和种群中所有粒子所经历的最好位置；  $\eta$  称为收缩扩张系数，是QPSO惟一的参数。本文采用通过距离自适应调节的方法来控制  $\eta$  的取值：

$$
\eta = 0.5 + 0.5\times \frac{i_{\mathrm{max}} - i_c}{i_{\mathrm{max}}} \tag{21}
$$

式中：  $i_{\mathrm{max}}$  为算法的最大迭代次数；  $i_{c}$  为当前的迭代次数。

好的推广能力估计方法是实现RVM模型参数选择的基础。鉴于交叉检验法原理简单，实现方便，而且寻优结果比较接近实际最优值，本文以留一交叉验证得到的平均误差估计RVM的推广能力。留一交叉验证法的基本思想是：逐一从训练集中去掉一个样本，利用剩余的样本训练RVM回归模型，并利用训练好的模型对去掉的样本进行预测；最后取所有相对预测误差的平均值作为推广能力的估计。利用QPSO算法实现RVM模型参数  $(l,\gamma)$  自适应进化搜索的步骤如下：

1）置当前迭代次数  $i_{c} = 1$  ，设定种群中粒子数目  $M$  ，算法的最大迭代次数  $i_{\mathrm{max}}$  ，嵌入维数  $\ell$  和Gaussian核参数  $\gamma$  的取值区间，并在取值区间中随机初始化粒子位置  $Z_{n}(i_{c}) =$ $[l_{n}(i_{c}),\gamma_{n}(i_{c})]^{T}$ $n = 1,2,\dots ,M$  。

2）根据2.2节方法建立训练样本集  $X_{n}$  。

3）根据本节中留一交叉验证法计算得到交叉验证误差  $\mathcal{E}$  。

4）将每个粒子的当前位置作为粒子的个体最优值  $p_n$  ，通过比较  $e_{n}$  确定种群的全局最优值  $p_{\epsilon}$  。

5）根据公式（18）～（21）更新粒子的位置。

6）将每个粒子的适应度值  $e_{n}$  与其经历的最好位置  $p_n$  进行比较，若优则将其作为当前最好位置，更新  $p_n$  ，否则保留原值；

7）将更新后每个粒子的  $p_n$  与全局极值  $p_{\epsilon}$  比较，若优则将  $p_{\epsilon}$  设置为最好粒子的当前位置，否则保留原值；

8）判断是否满足终止条件，如果不满足，则设定  $i_c = i_c$ $+1$  转至步骤3）。

# 3基于EMD和RVM一AR的滑油金属含量预测模型

基于EMD和RVM一AR的航空发动机滑油金属含量预测模型的基本思路是：首先，利用EMD算法将序列分解为若干固有模态函数（IMF）和残余函数（RF），分离原始数据中的趋势项和随机项；然后，建立各IMF分量的AR模型和RF分量的RVM模型，AR模型参数采用最终预测误差（FPE）准则确定，以交叉验证误差作为优化准则，采用量子粒子群优化（QPSO）算法进化搜索RVM的最优核参数和嵌入维数；最后，将各AR模型和RVM模型的预测值叠加作为最终预测值。

# 4预测实例

以文献[16]中某型航空发动机的16份油液光谱分析数据（如图2所示）为例进行预测实验。

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/8bc5b223-f5db-4263-a9d8-a5e9948ffba9/fa202d6d73cee536bcdc39e860aa19e2d6bc406b3948d82c69c33378e4f68f64.jpg)  
图1 油液光谱分析数据

利用EMD算法分别对Fe元素和Si元素含量数据进行分解，分解结果如图2和图3所示。由图可以看出，RF分量较为准确地表现出了原始数据的变化趋势。这说明采用镜像延拓法能够有效地抑制EMD存在的端点效应，经其分解得到的分量可以较好地反映原始数据中的真实成分。为将本文方法与已有方法的性能进行对比，分别建立油液光谱的AR模型和SVM模型对后4个数据进行一步预测。各模型参数的设置如下：AR模型参数通过最终预测误差（FPE）准则选取；SVM的核函数选为Gaussian核函数，模型参数包括核参数  $\gamma$  、惩罚系数  $C$  、不敏感损失函数  $\epsilon$  和嵌入维数  $l$  ，参考本文2.3节的方法进行自适应优化选择，  $M$  设为30，  $i_{\mathrm{max}}$  设为100，  $\gamma$  的取值区间为  $[0,1,10]$  ，  $C$  的取值区间为[1，1000]，  $\epsilon$  的取值区间为  $[0,0001,0.5]$  ，  $l$  的取值区间为[1，5]；RVM模型根据本文2.3节的方法进行自适应优化选择，  $M$  设为30，  $i_{\mathrm{max}}$  设为100，  $\gamma$  的取值区间为  $[1,10]$  ，  $l$  的取值区间为  $[1,5]$  。各模型的预测结果如表1和表2所示。

表1Fe元素含量预测结果  

<table><tr><td rowspan="2">序号</td><td rowspan="2">真实值 /ppm</td><td colspan="2">AR</td><td colspan="2">SVM</td><td colspan="2">EMD+RVM-AR</td></tr><tr><td>预测值 /ppm</td><td>相对误 差/%</td><td>预测值 /ppm</td><td>相对误 差/%</td><td>预测值 /ppm</td><td>相对误 差/%</td></tr><tr><td>13</td><td>0.64</td><td>0.71</td><td>10.94</td><td>0.63</td><td>1.56</td><td>0.62</td><td>3.13</td></tr><tr><td>14</td><td>0.68</td><td>0.65</td><td>4.41</td><td>0.63</td><td>7.35</td><td>0.88</td><td>29.41</td></tr><tr><td>15</td><td>1.35</td><td>0.70</td><td>48.15</td><td>0.81</td><td>40.00</td><td>1.18</td><td>12.59</td></tr><tr><td>16</td><td>1.91</td><td>0.91</td><td>52.36</td><td>1.36</td><td>28.80</td><td>1.73</td><td>9.42</td></tr><tr><td colspan="2">最大相对误差/%</td><td colspan="2">52.36</td><td colspan="2">40.00</td><td colspan="2">29.41</td></tr><tr><td colspan="2">平均相对误差/%</td><td colspan="2">28.96</td><td colspan="2">19.43</td><td colspan="2">13.64</td></tr></table>

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/8bc5b223-f5db-4263-a9d8-a5e9948ffba9/b6d3dc35c10dce0355395dc81442fd65e281adb4069a3957211b4691c8b2a749.jpg)  
图2 Fe元素数据EMD分解结果

![](https://cdn-mineru.openxlab.org.cn/result/2025-09-13/8bc5b223-f5db-4263-a9d8-a5e9948ffba9/0fabf34c49b77720e0c66a83b3073d947f6c1f7df398ad9566c6c74247ee0e6e.jpg)  
图3 Si元素数据EMD分解结果

表2Si元素含量预测结果  

<table><tr><td>序号</td><td>真实值 /ppm</td><td>AR 预测值 /ppm</td><td>SVM 相对误 差/%</td><td>预测值 /ppm</td><td>相对误 差/%</td><td>EMD+RVM-AR 预测值 /ppm</td><td>相对误 差/%</td></tr><tr><td>13</td><td>1.64</td><td>1.15</td><td>29.88</td><td>1.46</td><td>10.98</td><td>1.60</td><td>2.44</td></tr><tr><td>14</td><td>2.42</td><td>1.00</td><td>58.68</td><td>1.60</td><td>33.88</td><td>2.35</td><td>2.89</td></tr><tr><td>15</td><td>3.51</td><td>1.22</td><td>65.24</td><td>2.45</td><td>30.20</td><td>3.59</td><td>2.28</td></tr><tr><td>16</td><td>3.19</td><td>1.26</td><td>60.50</td><td>4.37</td><td>36.99</td><td>3.56</td><td>11.60</td></tr><tr><td>最大相对误差/%</td><td></td><td>65.24</td><td></td><td>36.99</td><td></td><td>11.60</td><td></td></tr><tr><td>平均相对误差/%</td><td></td><td>53.57</td><td></td><td>28.01</td><td></td><td>4.80</td><td></td></tr></table>

根据预测结果可知，AR模型作为一种传统的时间序列分析方法，在用于非线性非平稳时间序列预测时具有较大的预测误差，本例中Fe元素和Si元素含量预测最大相对误差分别高达  $52.36\%$  和  $65.24\%$  ，平均相对误差分别高达  $28.96\%$  和  $53.57\%$  。SVM模型的预测精度较AR模型有较大提高，但预测误差仍然较大。相对于AR模型和SVM模型，本文方法的预测性能显著提高，其中Si元素含量预测的平均相对误差仅为  $4.8\%$  ，大大低于AR模型的  $53.57\%$  和SVM模型的  $28.01\%$  。本文方法取得了优异的预测性能，原因主要有两方面：一方面，采用EMD算法分离原始滑油光谱数据的随机项和趋势项，能够有效降低数据的复杂度，并通过子序列单独建模分散了预测风险；另一方面，RVM作为机器学习发展的最新成果，具有强大的非线性处理能力。

# 5 结论

1）本文建立的基于EMD和RVM-AR模型的航空发动

机滑油金属含量预测模型，结合了EMD多分辨的优势和RVM强大地非线性处理能力，具有优异的预测性能，能够实现滑油金属含量变化趋势的准确预测。

2）采用基于QPSO的智能优化算法实现了模型参数的自适应选择，克服了人为设置RVM模型参数缺乏科学依据和推广性不强的缺点。